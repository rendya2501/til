# 正規表現メモ

## 基本

`.` : 任意の1文字  
`*` : 直前の文字の0回以上の繰り返し  
`[]` : []内の文字のいずれかの1文字  
`[-]` : 範囲指定 例：`[0-9],[A-Z]`  
`[^]` : ～以外  
`^` : 行頭  
`$` : 行末  
`\` : エスケープシーケンス  

拡張正規表現  
`+` : 直前の文字の1回以上の繰り返し  
`?` : 直前の文字の0回以上の繰り返し  
`|` : 左右のいずれかの記述にマッチする  
`{n}` : 直前の文字のn回の繰り返し  
`{n,m}` : 直前の文字のnからm回の繰り返し  

---

## ○○を含む、AND（かつ）、△△を含まない

```regexp
^(?=.*○○)(?!.*△△).*$
```

## ○○かつ△△

```regexp
^(?=.*○○)(?=.*△△).*$
```

## ○○または△△

```regexp
○○|△△
```

## 改行コードだけ

```regexp
^([*\n])
```

---

## 開始文字から終了文字まで複数行の検索

[VS Codeで複数行に渡って正規表現を利用する](https://qiita.com/birdwatcher/items/dee34a11619b11e1fe81)  

```regexp
開始文字[\s\S\n]*? 終了文字
```

`\s`: 空白文字を表す。`[ \t\n\r\f]`と同じ  
`\S`: 非空白文字を表す。`[ \t\n\r\f]`以外の一文字。  
`\n`: 改行文字を表す。`\s`で代用できそうだけど、1行ごとに検索するせいで明示的に入れないと駄目みたい。  
`*?`: 最小一致検索。この例だと2つみつかる。  
※ちなみに?を外すと最長一致検索。この例だと1つみつかる  

つまり、開始文字、空白か非空白か改行文字のいずれか、終了文字に一致するまでの最小の区間って感じかな。  

---

## CR・LF・CR+LFをすべて検索する場合

<https://uxmilk.jp/50240>  

```regexp
\r\n|\n|\r
```

---

## 「'status_code_detail' => '1'」と「'料金が存在しません', etc...ではない文字列」が2行以内にある場合を抜き出す

<https://ja.stackoverflow.com/questions/74326/emeditor%E3%81%A7%E8%A4%87%E6%95%B0%E8%A1%8C%E3%81%AB%E3%81%BE%E3%81%9F%E3%81%8C%E3%82%8B%E6%9D%A1%E4%BB%B6%E3%81%AE%E6%AD%A3%E8%A6%8F%E8%A1%A8%E7%8F%BE%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6%E3%81%AE%E6%A9%9F%E8%83%BD%E3%81%AF%E3%81%82%E3%82%8A%E3%81%BE%E3%81%99%E3%81%A7%E3%81%97%E3%82%87%E3%81%86%E3%81%8B>  

``` regexp
// スイスと登山が2行以内にある場合
スイス([^\n]*\n)?.*?登山
```

<https://www-creators.com/archives/5332>  

``` regexp
// ラーメンを含み、かつ、パスタを含まない文字列の表現
^(?=.*ラーメン)(?!.*パスタ).*$
```

``` regexp
^(?=.*'status_code_detail' => '1',\n           'status_msg_detail' => )(?!.'料金が存在しません',).*$

'status_code_detail' => '1',([^\n]*\n)(?!.*?'status_msg_detail' => '料金が存在しません',)

'status_code_detail' => '1',([^\n]*\n)((?!.*?'status_msg_detail' => '料金が存在しません',)|(?!.*?'status_msg_detail' => '利用税マスタが登録されていません',))

'status_code_detail' => '1',([^\n]*\n)(?!.*?'status_msg_detail' => '料金が存在しません',|'status_msg_detail' => '利用税マスタが登録されていません',|'status_msg_detail' => '料金設定済のため、以下の項目は変更できません。セルフ・キャディ種別、ランチ種別、カート種別、2B種別、プランマスタID。',)

●完成形
'status_code_detail' => '1',([^\n]*\n)(?!.*?'status_msg_detail' => '料金が存在しません',|.*?'status_msg_detail' => '利用税マスタが登録されていません',|.*?'status_msg_detail' => '料金設定済のため、以下の項目は変更できません。セルフ・キャディ種別、ランチ種別、カート種別、2B種別、プランマスタID。',|.*?'status_msg_detail' => '予約済みのため削除できません',)

●完成形2
'status_code_detail' => '1',([^\n]*\n)(?!.*?'料金が存在しません',|.*?'プランマスタIDが不正です',|.*?'利用税マスタが登録されていません',|.*?'料金設定済のため、以下の項目は変更できません。セルフ・キャディ種別、ランチ種別、カート種別、2B種別、プランマスタID。',|.*?'予約済みのため削除できません',|.*?'予約受付最低組数を設定する場合は２Ｂ保証しないを設定してください',|.*?'予約期間が不正です'|.*?'プラン備考が不正です',)
```
