# 色々検証

---

## 接続文字列の有無による挙動の違い

コーディングの段階において、接続情報をプログラム内に埋め込んでいる場合、そのまま移行が実行される。  
コーディングの段階において、接続情報をappsettings.jsonから参照するようにしている場合、appsettings.jsonがないとエラーとなる。  
接続情報を一切記述しない状態でバンドルを発行した場合、実行すると接続エラーとなる。  

ダブルクリックによる誤動作防止対策として、接続文字列は記述せず、`--connection`コマンドによる、接続先の指定をするのがよいかと思われる。  

---

## トラブルシューティング

### dotnet ef migrations bundle のエラー

バンドルを作成しようとした時にエラーが発生。  

``` txt
Build started...
Build succeeded.
Specify --help for a list of available options and commands.
Unrecognized command or argument 'bundle'.
```

この時の.Netバージョンは5。  
バンドルはEF Core 6.0からの機能なので、バージョンによるエラーとなる。  

[Unrecognized command or argument 'optimize' on Entity Framework Core .NET Command-line Tools 5.0.7](https://github.com/dotnet/efcore/issues/25135)  

### -oによる出力

`-o`で出力先を指定する場合、ファイル名まで指定しないといけない。  
フォルダも事前に作っておかなければならない。  
フォルダだけ指定して、後はefbundleで発行してもらえればと思ったが、駄目だった。  

`dotnet ef migrations bundle --self-contained -r linux-x64 -o linux-x64/efbundle -f`  

### /pオプションの指定

プロジェクトファイルに対して指定するオプションを入れて発行してみたが、エラーになった。  
使わなくてよい。  

`dotnet ef migrations bundle --self-contained -r linux-x64 -o linux-x64/efbundle -f /p:PublishProtocol=FileSystem`
