# SignalR

## 概要

SignalRは、ASP.NET Coreの一部であり、リアルタイムWebアプリケーションを簡単に構築するためのライブラリとなります。  
SignalRを使用すると、サーバーとクライアント間でリアルタイムでデータをやり取りすることができます。  

---

## 特徴

1. **抽象化**  
   さまざまなリアルタイム通信プロトコル（WebSocket、Server-Sent Events、Long Pollingなど）を抽象化し、開発者はプロトコルの詳細を気にせずリアルタイム機能を実装できます。  
2. **自動接続管理**  
   SignalRは接続の管理を自動化し、クライアントが接続、切断、再接続する際の処理を簡単に実装できます。  
3. **高度なメッセージング**  
   すべてのクライアント、特定のクライアント、またはクライアントグループに対してメッセージを送信する機能を提供します。  
4. **スケーラビリティ**  
   サーバーが負荷分散された環境でも動作するように設計されており、大規模なアプリケーションにも対応できます。  

---

## コンポーネント

1. **ハブ (Hub)**  
   サーバー側のコンポーネントで、クライアントとの通信を管理します。  
   ハブはクライアントがサーバーにメッセージを送信するためのメソッドを定義し、クライアントにメッセージを送信する機能を提供します。  
2. **クライアント**  
   クライアント側のコンポーネントで、JavaScript、C#、またはその他の言語で実装できます。  
   クライアントは、サーバーとの接続を確立し、サーバーからのメッセージを受信するためのコールバック関数を定義します。  

---

## 使用例

- チャットアプリケーション
- ダッシュボード
- ゲーム
- リアルタイムで更新が必要なアプリケーション

---

## 若干の歴史

SignalRは元々ASP.NET Framework用に開発され、初版は2013年頃にリリースされました。  
その後、ASP.NET Coreの登場に伴い、SignalRもASP.NET Core向けに再設計され、2018年にASP.NET Core SignalRとしてリリースされました。  
ASP.NET Core SignalRは、従来のASP.NET SignalRとはいくつかの点で異なり、よりパフォーマンスが向上し、クロスプラットフォーム対応が強化されています。  

---

## デメリットや難しい点

SignalRはリアルタイムWebアプリケーションの開発を容易にするための優れたライブラリですが、いくつかのデメリットや難しい点が存在します。  

1. **リソース消費**  
   SignalRはリアルタイム通信を提供するため、サーバー側とクライアント側のリソース消費が増加します。  
   多くの同時接続がある場合、サーバーのメモリやCPU負荷が高くなることがあります。  

2. **スケーラビリティの課題**  
   SignalRアプリケーションをスケールアウトする際には、特別な対応が必要です。  
   複数のサーバー間でSignalR接続を共有するために、バックプレーン (Redis, Azure SignalR Serviceなど) を設定する必要があります。  
   これは、追加のコストや構成の複雑さをもたらすことがあります。  

3. **学習曲線**  
   SignalR自体は比較的簡単に使い始めることができますが、リアルタイム通信の概念やWebSocketプロトコル、接続管理などについて理解する必要があります。  
   これには、学習曲線が存在します。  

4. **ブラウザの互換性**  
   SignalRは自動的に最適な通信プロトコルを選択しますが、古いブラウザではWebSocketがサポートされていない場合があります。  
   そのため、アプリケーションが古いブラウザでも正常に動作することを保証するために、フォールバックメカニズムについて考慮する必要があります。  

5. **デバッグとトラブルシューティング**  
   リアルタイムのアプリケーションでは、問題が発生した際のデバッグやトラブルシューティングが難しくなることがあります。  
   サーバーとクライアント間での通信がリアルタイムで行われるため、問題の特定や解決に手間がかかることがあります。  

これらのデメリットや難しい点に注意しながら、SignalRを使用してリアルタイムWebアプリケーションを開発することが重要です。  
適切な設計やパフォーマンス最適化を行うことで、これらの課題を克服することが可能です。  

---

## Redisとの連携

現実問題、大規模になれば間にRedis等を挟むことになるはず。  
そうなった時にSignalRは動くのか、また性能を確保できるのかという問題が発生してくる。  
備忘録として残す。  

[RedisをBackplaneとしたSignalRのスケールアウト](https://www.buildinsider.net/web/iis8/07)  
[ASP.NET Core SignalR のスケールアウトのために Redis バックプレーンを設定する](https://docs.microsoft.com/ja-jp/aspnet/core/signalr/redis-backplane?view=aspnetcore-6.0)  

---

## 参考

[SignalR を Windows Mixed Reality で使いたい](https://blog.okazuki.jp/entry/2018/04/26/125929)  

[SignalR でChat アプリを作ってみた](https://qiita.com/TsuyoshiUshio@github/items/65ea4e2669afa19f6a31)  

このサンプルはあまり参考にならなかったが、個別に送信する機能を有しているので、そういうのを実装する時になったらやくに立つのでは。  
[ASP.NET Core SignalR でルーム付きチャットアプリを作ってみた](https://www.tetsis.com/blog/asp-net-core-signalr-group-chat/)  
