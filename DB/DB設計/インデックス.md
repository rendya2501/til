# インデックス

---

## インデックスとは？

>インデックスは、検索のパフォーマンスを向上させる非常に重要な機能です。  
>インデックスを作成することで、データ検索時の不要なテーブルスキャンを防ぐ事が出来ます。  
>インデックスを作成すると、データを昇順に並べ変えるとともに、データの範囲によって枝(ツリー構造)が作られます。  
>この枝を利用してデータをピンポイントに見つけ出すことによって、全データを検索(テーブルスキャン)しなくて済むようになります。  
>[sqlserver2016の教科書]  

---

## 複合インデックス

Q.4列に対してインデックスを貼り、その一部のフィールドだけをwhereの条件とした場合、インデックスは効くのか？  

A.効くらしい。  
[このサイト](https://sgyatto.hatenablog.com/entry/2018/11/24/225938)が一番わかりやすい。  
順番なども関係あるらしいが、順番を考慮しつつ一部の列を条件とした場合は効く模様。  

>複合インデックスについて、「構成列の一部が指定された場合でも効く」というのはなんとなく知っていたのですが、(略  
>
>あくまで「複合インデックスが選択される可能性がある」というだけです。  
>先頭列を抽出条件に含まなかったり、偏った部分集合を抽出条件とした場合などは、別のスキャン方法が選択される可能性が高いです。  
>[複合インデックスは、構成列のどの列を指定すれば選択候補に挙がるのか。](https://sgyatto.hatenablog.com/entry/2018/11/24/225938)  

<!--  -->
>ここで問題になるのは複合インデクスの特徴の１つである、「キーとして構成されているカラムの全てが検索条件に指定されていなくても、キーの先頭から途中までのカラムが指定されていれば、インデクスが使われる」という点です。  
>[データベース／複合インデックスの落とし穴](https://www.gatc.jp/gat/it/it02dbindex.html)  

<!--  -->
>Q1. 複合インデックスを作っている場合、where句で1つだけを指定してもインデックスが効きますか？  
>A1. そのインデックスの先頭の項目が条件であれば、適用されます。  
>
>Q2. 複合インデックスがあるところに対して更に1つだけのインデックスを作る必要はありますか？  
>A2. 複合インデックスの先頭を含まない条件の場合は、その条件項目から始まるインデックスが必要です。  
>
>※where条件の記述順序は関係ありません。  
>[複合インデックスは1つのwhereでも効果がありますか？](https://teratail.com/questions/284051)  

- 検索キーワード  
  - 複合インデックス 一部  

---

[インデックスと実行計画を理解する@SQLServer](https://qiita.com/okuzou1/items/f710bcde64beb22cd50b)  
[SQL Serverのインデックスの理解を深める](https://qiita.com/fuk101/items/2e6a225a97a14f0f2850)  
[インデックスとは？仕組みをわかりやすく解説](https://products.sint.co.jp/siob/blog/index)  

[SQL Serverにおけるインデックスの再構成と再構築の性能比較](https://techblog.zozo.com/entry/sqlserver-index-reorganize-vs-rebuild)  
