# 複合インデックス

テーブルの複数のカラムを組み合わせて1つのインデックスとしたもの。  

---

## 一部のキーを指定した場合、インデックスは効くのか？

Q.あるテーブルのカラム(C1, C2, C3) に対して複合インデックスを貼り、その一部のフィールドだけをwhereの条件とした場合、インデックスは効くのか？  

A.効くらしい。  
ただ、キーの先頭(今回の例でいえばC1)は含める必要がある模様。  
基本はそうだとして、後はデータベースによる模様。  
[このサイト(複合インデックスは、構成列のどの列を指定すれば選択候補に挙がるのか。 - sgyatto's blog)](https://sgyatto.hatenablog.com/entry/2018/11/24/225938)では、データベース毎の仕様を紹介してくれている。  

>ここで問題になるのは複合インデクスの特徴の１つである、「キーとして構成されているカラムの全てが検索条件に指定されていなくても、キーの先頭から途中までのカラムが指定されていれば、インデクスが使われる」という点です。  
>[データベース／複合インデックスの落とし穴](https://www.gatc.jp/gat/it/it02dbindex.html)  

<!--  -->
>Q1. 複合インデックスを作っている場合、where句で1つだけを指定してもインデックスが効きますか？  
>A1. そのインデックスの先頭の項目が条件であれば、適用されます。  
>
>Q2. 複合インデックスがあるところに対して更に1つだけのインデックスを作る必要はありますか？  
>A2. 複合インデックスの先頭を含まない条件の場合は、その条件項目から始まるインデックスが必要です。  
>
>※where条件の記述順序は関係ありません。  
>[複合インデックスは1つのwhereでも効果がありますか？](https://teratail.com/questions/284051)  

<!--  -->
>複合インデックスについて、「構成列の一部が指定された場合でも効く」というのはなんとなく知っていたのですが、(略  
>
>あくまで「複合インデックスが選択される可能性がある」というだけです。  
>先頭列を抽出条件に含まなかったり、偏った部分集合を抽出条件とした場合などは、別のスキャン方法が選択される可能性が高いです。  
>[複合インデックスは、構成列のどの列を指定すれば選択候補に挙がるのか。 - sgyatto's blog](https://sgyatto.hatenablog.com/entry/2018/11/24/225938)  

- 検索キーワード  
  - 複合インデックス 一部  

---

## 参考

複合インデックスについて一番わかりやすいサイトではなかろうか。  
[複合インデックスの落とし穴 | がっとな日々 | ガットコンピューター](https://www.gatc.jp/gat/it/it02dbindex.html)  

複合インデックスの一部を指定した場合の、各データベースの挙動を紹介してくれているサイト。  
[複合インデックスは、構成列のどの列を指定すれば選択候補に挙がるのか。 - sgyatto's blog](https://sgyatto.hatenablog.com/entry/2018/11/24/225938)  
