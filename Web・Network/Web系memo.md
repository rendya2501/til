# Web系メモ

## HTML5の廃止

<https://future-architect.github.io/articles/20210621a/>  
<https://www.tohoho-web.com/html/memo/htmlls.htm>  

全然知らなかった。
HTML5は2021年1月28日に廃止された模様。  
次期HTMLのバージョンはHTML Living Standardと呼ぶらしい。  
ヴァージョンに関して解説してあるページがあるのでそこを参照されたし。  
ざっくりいうと、開発元(W3C)とWeb系(Apple,Mozilla)の強い会社でバチバチにやりあって、Webの会社が勝利したって結末。  
色々あって面白い。  

## グローバルインストールとローカルインストールの違いについて

いつぞや、東さんがサラッと「金谷君グローバルインストールしてないで使ってるのか？」って言っていたのを聞いて、
インストールにも種類があるのか？グローバルとローカルの違いは何？と思い調べることにしました。  

どうにもnpmにおける話みたいですね。  
調べればたくさん出てくるけど、大体npmって文言がついてくる。  

<https://elastictechdays.info/npm-package-local-global-install/>  
npm でのインストールは、「ローカル」と「グローバル」のインストールがあります。  
グローバルインストール : どのパスでもインストールしたパッケージを利用することができます。  
ローカルインストール : インストールしたディレクトリ配下でパッケージを利用することができます。  

ただ別プロジェクトに参画した時に、別バージョンのパッケージが必要だったり、不要ライブラリがインストールされた状態になってしまうので、基本的にはローカルにパッケージをインストールした方がいいです。  

調べて見れば、それだけの話だったか。  
東さんは面倒くさいからグローバルインストールしたと言っていたが、確かに手っ取り早く使うだけならグローバル一択だろうな。  

## node.jsとは？

サーバーサイドのJavaScript実行環境。  
サーバーサイドでもJavaScriptを使えるようにしたもの。  

## npm(Node Package Manager)とは？

Node.jsのパッケージ管理ツール。  
Node.jsに置けるパッケージにはPromiseやasync等がある模様。  
Promiseってあれってパッケージだったのか・・・。  

## パッケージとは？

実行プログラム、設定ファイル、ドキュメント等を1つのファイルにまとめた物。  

## パッケージ管理とは？

パッケージのインストールやアンインストール、アップデート作業において、どのようなパッケージがどこにインストールされているかを管理したり、  
パッケージ間の競合を回避したりする仕組み。  
それを提供する仕組みがパッケージ管理システム。  

## SPA,SSR,SSG

<https://serip39.hatenablog.com/entry/2020/08/23/225000>  

多分、TeelaはSPAだと思うけどなぁ。
Angular自体SPA開発向けだった気がするし。→実際そうだった。
SEOなんて考えなくていいしね。業務アプリケーションだし。

SSRとSSGの違いは、SSRは都度APIでデータをもらってからレンダリングするのに対して、
SSGはもう全部のデータを取得してレンダリングして渡すから細かい要求に対応できないんだろうな。
どっちもサーバー側で頑張る点は変わらない。

### SPA : Single Page Application (Client Side Rendering)

1枚のHTMLに対してJavaScriptで動的に変更を加えながら画面の描画を実現するアーキテクチャのこと。  
従来のWebアプリケーションと異なり、ページ全体をロードするのは初回のみで、2回目以降はサーバからJSONデータを受け取ることで必要箇所のみリロードする。  

登場背景  
・HTML,CSS,ブラウザの進化に伴い、既存のWeb技術だけで実現できることが増えた。  
・RIAに代表されるFlash等の衰退。  
・RIAの代替技術として注目されるようになった。  

[SPA(Single Page Application)ってなに？](https://digitalidentity.co.jp/blog/creative/about-single-page-application.html)

SPAのメリット
SPAのメリットは以下の3点です。

動作性の向上
より高度なWeb表現
ネイティブアプリの代用
単一のWebページでコンテンツ切り替えを行うことで、ページ遷移の必要がなく、ブラウザの挙動に縛られないWeb表現を可能にするのです。
では、順にご説明していきます。

動作の向上が期待できる
まずは動作が向上するという点に関してご説明していきます。
そもそも、従来のWebアプリケーションの仕組みは、以下のようになっていました。

ユーザーが何かしらのアクション（クリックなど）を行う
それを受けてサーバに通信（リクエスト）
サーバ側でHTMLを生成し、ブラウザに返す（レスポンス）
HTMLに反映
この仕組みではページを更新する度に変更していない部分までサーバ側で生成し直していました。
例えば、ページのヘッダーやフッターはユーザーが変更するように作られていないことがほとんどでしょう。
そういった変更のない部分までサーバに送信しているので、処理に時間がかかってしまっていたのです。
これに対して、SPAを導入した際のWebアプリケーションの仕組みは、以下のように変更されました。

ユーザーが何かしらのアクション（クリックなど）を行う
そのアクションに必要な部分のデータだけをサーバに要求
返ってきたデータをJavaScriptで処理
処理HTMLに反映
つまり、ブラウザ側でできる処理はJavaScriptで終わらせることで、サーバとの通信量を最低限に抑えることが可能です。
これによって、Webアプリケーションの動作の向上が期待できます。

SPAを採用すべき場面
ここまでで、SPAについてある程度のことは理解できたと思います。
では、実際にSPAを使う際にどのようなサービスが適しているのでしょうか？

滞在時間の長いサービスに適している
SPAはページ遷移を高速化するという特徴から、滞在時間の長いサービスに適しています。
例えば、デジタルマーケティングで使用するツールや、口コミや評判などを分析するサイトでは、ユーザーが繰り返しアクションを行い、その度にページ遷移することもしばしばです。
こういったサービスではSPAに適していると言えるでしょう。
ページ遷移が早くなることでユーザーのストレスが減少し、サイトに対する満足度の向上も期待できるでしょう。

SPAに適していないケースは？
滞在時間の長くないサービス、言いかえると直帰率の高いサービスは、SPAに適していないと考えられます。
主な例としては、ブログなどが挙げられます。
直帰率の高いサービスでは、アクセス時にかかる時間が増加してしまうSPAを導入すると、ユーザーは不快感を感じてしまい、直帰率が上昇する危険性があります。
SPAの導入を検討する際は、サイトにおけるユーザーの行動を分析することが重要です。

SPAはSEO上不利になる？
SPAで制作されたWebサイトはJavaScriptでコンテンツを描画しているため、Googlebotに正しく認識されずSEOの観点で問題が生じるのではないかという懸念の声がしばしば聞かれます。
しかし、現在のGooglebotには、Chrome 74相当のレンダリングが搭載されており、最新のJavaScript技術に対応しています。
ですので、SPAで制作されたWebサイトが何らかSEO上で不利になるということは考えられないでしょう。

このアップデートはGoogle I/O 2019にて発表され、アメリカ版Googleウェブマスター向け公式ブログでも告知されています。

最小限のHTMLとJSだけ渡して、相手のPCで画面を組み立てる。  
最小のデータしか渡さないので、都度APIをたたいてデータを取得して各端末で組み立てるという順序になる。  
最小のデータなのでSEOは絶望的。  
Teelaなど、基幹システム的なものにはよいのかな？中身を解析される恐れもないのでセキュリティ面でも有利化もしれない。  

### SSR Server Side Rendering

サーバー側で都度ページを作って渡す。
消去法的に大体これになる。
SEOにもある程度対応できるしね。
サーバー側で作ったページを渡して、細かいものは都度もらってねって方式。  

### SSG : Static Site Generator

あんまり画面の変更がないページはこれの方式が適してるよ。  
ビルド時にデータを含めてページを作成しておき、あとはそれを渡すだけ。
渡すだけだから処理も軽い。
ヘルプページとか、変化が少ない、人によって変化しない静的なサイトに向いている。
もちろん、都度画面がガチャガチャやるものに使ってはいけない。

SSGとSSRの違いは、都度か最初だけかの違いだよなぁ。

## OGP : OpenGraphProtocol

FacebookやTwitterなどのSNSでシェアした際に、設定したWEBページのタイトルやイメージ画像、
詳細などを正しく伝えるためのHTML要素です。

OGP設定をしていなかった場合、Facebook側が自動的に説明文や画像を表示してしまい、ページ内容がユーザーに正しく伝わらなくなります。
適切に設定することで、どのようなページで何を伝えたいのかが明確になります。そうすることで、
共有されたユーザーの訴求率が高まり、より多くの人に記事を見てもらうことが可能になります。

SNSに関係したWEBの開発をしたことがないから馴染みがないけど、そういうのをバンバンやってるところなら当たり前の技術なんだろうなぁ。

## RIA(Rich Internet Application)

優れた表現力や柔軟な操作性を提供するウェブアプリケーションの総称。
単純なHTMLで記述された静的なウェブページに対し、動画やアニメーションを再生したり、対話的な操作性をもたせたりするフラッシュやシルバーライトなどを指す。

## PWA : Progressive Web Apps

WEBページをネイティブアプリのように使うことを可能にする技術。
ブラウザからダウンロードして使うことができるので、IOSでも使用可能。
IOSのアプリはアップルストアからしか入れることができないが、前述のようにブラウザから入手できるので、ストアを経由しないで利用することが可能。
electronがブラウザの機能を含めたexeを作成するなら、こちらはブラウザのエンジン上でプログラムを走らせる形になる。

## GraphQL

[GraphQL 入門ガイド](https://circleci.com/ja/blog/introduction-to-graphql/)  

``` txt
GraphQL は API のために作られたクエリ言語であり、既存のデータに対するクエリを実行するランタイムです。
理解できる完全な形で API 内のデータについて記述します。
GraphQL を利用すれば、クライアント側から必要な内容だけを問い合わせられると共に、漸次的に API を進化させることが容易になり、強力な開発者ツールを実現できます。
```

``` txt
GraphQL とは、API 用のクエリ言語およびランタイムのこと。 by RedHat
Facebookが開発しているWeb APIのための規格。
```

うーん。つまり、API記述用の言語って事でok?  
やってみればわかるんだろうけど、どこも抽象的な事しか書いてない。  
絶対にAPIという言葉はついて来るので、Web関係の技術でRESTと関係があるのだろう。  
APIを記述するための言語と実行環境があってもおかしくないか。  
うちには縁がない話だからぽかーんて感じではある。  
2015年ごろからの技術見たいね。最近になって注目され始めた感じなのかな。  

[GraphQL を使うと何が嬉しいのか？いろいろ触って検証してみた](https://sitest.jp/blog/?p=11001)  

そうそう、こういうのでいいんだよ。  
概要だけじゃなく、登場背景もわかると、その技術がよくわかるよね。  
しかし、2021/09/16現在の認識では、APIが不便だから出てきたんだなぁ位しか認識できない。  
実際に使ってみたら全然違うんだろうけど、今はその程度の事しかわからないな。  

## RESTFul

[RESTful APIとは何なのか](https://qiita.com/NagaokaKenichi/items/0647c30ef596cedf4bf2)  
「RESTの原則」に従って実装されているWebシステムのHTTPでの呼び出しインターフェースのことを指します。  

### RESTとは

REpresentational State Transferの略で、分散型システムにおける複数のソフトウェアを連携させるのに適した設計原則の集合、考え方のこと。Roy Fieldingが2000年に提唱した。
また、RESTを語るうえで避けては通れない「リソース(リソース指向アーキテクチャ(ROA))」という概念があるが、これは「リソース指向アーキテクチャとは何なのか」に投稿したのでそちらを参照していただきたい。

### RESTの原則

主に以下の4つの原則から成る。  

**アドレス可能性(Addressability)**  
提供する情報がURIを通して表現できること。全ての情報はURIで表現される一意なアドレスを持っていること。  
**ステートレス性(Stateless)**  
HTTPをベースにしたステートレスなクライアント/サーバプロトコルであること。セッション等の状態管理はせず、やり取りされる情報はそれ自体で完結して解釈できること。  
**接続性(Connectability)**  
情報の内部に、別の情報や(その情報の別の)状態へのリンクを含めることができること。  
**統一インターフェース(Uniform Interface)**  
情報の操作(取得、作成、更新、削除)は全てHTTPメソッド(GET、POST、PUT、DELETE)を利用すること。  
詳細はリソース指向アーキテクチャとは何なのかを参照。  

### RESTful APIを使うメリット

URIに規律が生まれることで、APIを利用するサービス開発者が楽になる  
URIに規律が生まれることで、API開発者もURIからソースのどの部分なのかが容易にわかる  
ブラウザのアドレスバーにURIを入力すればリソースが参照できる  
サーバ、クライアント間で何も共有しないことにより、負荷に応じたスケーラビリティが向上する。ステートレス性に値するもので、一番のメリットされている。  
GET、POST、PUT、DELETE等のHTTP標準のメソッドを使うことで、シンプルで一貫性のあるリクエスト標準化が円滑に行える。統一インターフェースに値する。  

### RESTful APIとREST APIの違い

RESTful API、REST APIと呼び方があるが、広義ではほぼ同じと考えて問題ない。  

### 感想

参照元を全てコピペしただけ。だって完成度高すぎるんだもん。  
2021/09/16時点でRESTと言われた時の自分の認識はHTTPで呼び出すアレってくらいしかない。  
大体RESTって言えば、APIって通じるけど、じゃあRESTって何？ってのは説明できなかった。  

どうもインターフェースであるのは確かなのだが、RESTの原則というものを満たしたものに関してはREST APIと呼ぶことが出来るらしい。  
原則を守るということは使いやすくあるべき事柄を満たしているということなので、そういうのを総称してRESTって読んでいるのかもしれないな。  

### Infrastructure as code

これは読んで字の如くインフラ構成をコードとして書き残しておく事を指します。
従来、OSやソフトウェアのインストール・バージョン管理・システム構成などは人間が手動で行っていました。
IaCではこうしたインフラ環境をコードとして書き記しておき、必要に応じて他のマシンへ書き込み・実行します。こうする事で他のサーバーマシンへの環境設定やアプリ展開を迅速に行う事が可能となり、設定を一から行う際に生じるヒューマンエラーの可能性を未然に防げるのです。IaCによる環境設定の自動化はSREにとっても大きな恩恵があります。

DockerFileの事ね、知ってる。

---

## gulpとは？

松田さんからgulpファイルをいじる必要があるのか質問されて、わからなかったのでまとめ。  
存在と名前は聞いたことあるけど、よく知らなかったし、Teela開発においては一度もお世話にならなかったのでこの際にまとめることにした。  
この手の技術って完成された後だと中々手をつけないので、触れる機会がないんですよねー。  

gulpはビルドに関する技術らしいですね。  
探せばたくさん出てくるけど、微妙に表現が違ったりと、明確な定義は難しいみたいです。  
とりあえず、ビルド自動化に関する技術って認識で今のところは十分じゃないですかね。  

[【たった５分で完了】「gulp」の導入方法と使用例を紹介します](https://digitalidentity.co.jp/blog/creative/gulp.html)  

### gulpってなに？

gulpはNode.jsをベースとしたタスクランナーの一つです。
タスクランナーとはWebサイト構築に必要な処理をタスクとして自動化してくれるプログラムで、作業の効率化に使われています。

gulpを使うことで以下のような手間や時間がかかる作業を自動化できます。

・cssにベンダープレフィックスをつける
・cssのプロパティをアルファベット順に並べ替える
・ソースマップの作成
・SassやLESSのコンパイル
・画像(jpeg, png, gif)、css、javascriptの圧縮
・PC・スマホ・タブレットの実機確認
・javascriptの構文チェック
・ブラウザのリロード
例えば、「画像、css、javascriptの圧縮」が行われると、ページの読み込み速度が速くなり、ユーザビリティの向上につながります。

### gulp導入のメリット3選

①煩雑な処理を自動で行うことができるため、作業を効率的に進められる。
②自動化により、人的ミスが減ることで、作業時間を短縮できる。
③複数人での作業環境を統一することができ、一定の品質を保った開発が可能になる。

このようにgulpを導入することで、WEB制作者にとっては様々なメリットがあるのです。

[gulpとは何か](https://www.codegrid.net/articles/2014-gulp-1/)  

gulpとは
gulpはNode.jsをベースとしたビルドシステムヘルパーです。以前CodeGridでも紹介したGruntと似た目的を持って作られたツールで、gulpを使えばさまざまな作業を自動化することができます。gulpの一番の特徴はサイトのトップページで「ストリーミングビルドシステム」と自ら名乗っているように、ファイルの処理をストリームで行うというところです。
この特徴によって複雑なタスクも細かくカスタマイズして書くことができます。ストリームがどのようなものかは、後述します。

### 実装例

``` js : .scss形式のファイルに対して処理を行うものです
gulp.task('sass', function() {
  var stream = gulp.src('sass/*.scss')
    .pipe(sass())
    .pipe(autoprefixer())
    .pipe(minify())
    .pipe(gulp.dest('css'));
  return stream;
});
```

sassフォルダにある.scss形式のファイルに対してコンパイル＞プレフィックス付与＞圧縮と、流れるように処理を行い、最後にgulp.dest()というメソッドによってファイルを書き出します。
各処理を実行した結果を.pipe()によって次の処理に渡すことで、複数の処理を簡潔にまとめることが可能です。
それぞれの処理の間に新たに処理を追加したい、といった場合には、.pipe()を増やすだけです。タスクが何をするのか、わかりやすく直感的に書くことができます。
また、.pipe()はそれぞれの処理の間でファイルの読み書きを行わないので、I/Oによる不要な待ち時間が発生しないのも強みです。
