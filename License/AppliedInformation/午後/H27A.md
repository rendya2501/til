# 平成27年秋期

---

## セキュリティ ソーシャルネットワーキングサービスのセキュリティ

オアシス  
組み込みで落ち込んだ時はセキュリティに帰ってくるのだ。  

少し時間はかかったけど、おおむね満足できる結果である。  
残りの1問も正解したかったが、解いている最中に思いつかなかったので、今後の参考にちゃんとまとめる。  
全体的な難易度は低いので、見れば普通にわかる。  

``` txt : 24分 6/7
エ
ウ

アカウント名

エ
登録した会員がどうか × Webブラウザ
ログイン用Cookieがその会員のものではないから
他)ログイン用Cookieの値を知らないから
電子メールアドレス

---

[3][2]
CookieはWebサーバに対するアクセスがどのPCからのものであるかを識別するためなどに、WebサーバやWebページの指示によってユーザ情報などをWebブラウザに保存する仕組みです。Cookieはコンピュータ単位ではなくブラウザごとに保存されるため、ログイン時のCookie検査では認証情報を送ってきたWebブラウザが登録時のものと同一であるかの確認が行われています。

∴Webブラウザ


[3][3]
対策3ではログイン用のCookieが無ければP-SNSにログインできません。攻撃者が不正ログインを成功させるためには、攻撃を実施するWebブラウザに偽装などの方法でCookieを組み入れる必要がありますが、Cookieの値は公開されておらず、非公開の登録メールアドレスに送られてくる一時的なCookie発行機能のページからのみ取得が可能なので正規のユーザ以外は知る術がありません。
このため攻撃者による不正ログインを拒否することが可能です。

∴ログイン用のCookieの値を知らないから


[3][4]
会員登録時に入力する情報は次の5つです。
アカウント名
パスワード
電子メールアドレス
ニックネーム
プロフィール
このうち図3のやり取りで扱われていない「ニックネーム」と「プロフィール」については早々に選択肢から除外できます。図3の手順では、アカウントの登録が入力された電子メールアドレスを介して行われているため「アカウントの登録が成功＝電子メールアドレスが正しい」と判断できます。つまりこの手順では入力された電子メールアドレスに間違いがなく、登録希望者がその電子メールアドレスで受信できる状態であることの確認が行われています。

Cookieの再設定時には登録された電子メールアドレスに認証用URLが届けられるため、電子メールアドレスが当該ユーザの所有するものであるかを登録時に確認することは重要なポイントです。

∴電子メールアドレス

→
最初はアカウント名とパスワードかと思ったけど、よくよく考えたら登録した時の情報として電子メールアドレスが有効じゃないとそのURLの受け取りようがないわけで、メールが届かないってことは電子メールアドレスが死んでるってことなので、有効性を確認するのは電子メールアドレスしかないと思いました。

```

---

## プログラミング 2分探索木

簡単なほうだった。  
計算量の問題は相変わらずだが、それ以外はめちゃくちゃ簡単。  
プログラミングは難易度の落差が激しすぎる。  
計算量の考え方だけしっかりして次へ行く。  
それ以外にまとめるものは特にない。  

``` txt 29分 8/10 実質9問正解
11

kがp.keyより小さい
new Node(k)
return p
p.left
p.right
p ← r

log2木の高さ × n
log2n × log n
→まぁ、あってるようなものだろう
※O記法では通常、底を省略して記述しますので、
じゃあだめだ・・・。知らなかった・・・。

     4
   ┌┴┐
   2    8
┌┴┐  └┐
1    3    12

---

〔クについて〕
問題文の〔2分探索木の計算量〕には、「2分探索木における計算量は、木の高さに依存する。」とあります。想定される最大の計算量を求めるには、比較回数が最大になる場合を考えます。

探索において比較回数が最大になるのは、全てのノードが一つの子ノードを持つ構造になっていて、探索するキー値が木の葉部分に位置している場合です。このときのノードの数をnとすると、木の高さはn-1です（木の高さは根から一番遠い葉までの枝の数です）。最大比較回数は「木の高さ＋1」で求めることができるため、「n-1+1＝n回」になります。以上より、計算量はO(n)となるので、[ク]には「n」が入ります。

∴ク＝n

→
そうか。木の高さに依存するってことは、極端なこと言えば右だけにノードを足していけば高さ=nの数ってすることができるわけだ。  
だから計算量は最大となるnってことになるのね。納得。


〔ケについて〕
完全2分木とは、全てのノードが2つの子ノードを持ち、根から葉までの距離がどこでも等しい下図のような木構造です。
pm03_10.gif/image-size:418×240
完全2分木の場合は、探索範囲を1／2ずつに狭めながら探索していきます。すなわち、n個のノードを1／2することをk回繰り返して、1つの値を見つけます。このことから、「n×1／2k＝1」の式を導くことができます。

　n×1／2k＝1
　n＝1／(1／2k)
　n＝1×2k
　n＝2k

より「k=log2n」となります。O記法では通常、底を省略して記述しますので、[ク]には「log n」が入ります。

※完全2分木を探索する計算量は、2分探索の計算量と同じです。

∴ク＝log n

```

---

## ネットワーク ネットワークの設計

うーん。もう一つ正解したかった。  
アドレスの数は間違っていなかったと思うのだが・・・  
いや、間違えてたわ。ﾌｧｰｰｗｗｗ  
でも、まぁ考え方は合ってたか。ビットの計算を間違えてた。  

まぁ、余裕を持って考えられるようになってきたので、進歩は感じている。  
しっかり復習して次に生かす。  

``` txt : 29分 6/10
507 × 508

ファイルサーバ
PC

192.168.1.11 × 192.168.1.0
255.255.254.0
192.168.4.3

インターネットVPN × 広域イーサネット
グループウェアサーバーへのIP接続が必要なため × 遅延が少なくテレビ会議機能に適しているから
事業所とデータセンターで別々の業者で回線を契約する 100%
他)事業所とデータセンタでは異なる回線事業者と契約する
イ

---

[1][1]
本文中に「事務所2のPCには 192.168.12.0/23 からIPアドレスを割り当てる」とあります。
アドレスプレフィックスが23なのでネットワーク部は先頭から23ビット、ホストアドレス部は残り9ビットになります。
9ビットで表現できるビット列の組合せ数は 2^9＝512 ですが、以下の4つは割当て済み、またはホストアドレスとして使用できないアドレスためPCに割り当てられません。
ルータCの⑧ポートのアドレス：192.168.12.1
事務所2内のPC側セグメントのL2SWアドレス：192.168.12.2
ネットワークアドレス：192.168.12.0
ブロードキャストアドレス：192.168.13.255
したがってPCに割当て可能なアドレス数は512から上記の4つを除いた508個になります。

∴508

→
255 + 256 = 511 509
ループバック、ブロードキャスト、ルーター、L2SWの4つを抜かして507

0000110|0 0000 0000
1 2 4 8 16 32 64 128

0から数えたら最大値は255だけど、0を含めた総数は256。
で、この場合は総数で数えないといけないので、256であるべき。
そういうことやぞ。


[3][1]
図2「W社の新たなネットワーク構成」より、ネクストホップに設定されている192.168.4.1はルータAの広域イーサネット側のポート(③)とわかります。
つまりデータセンタ内のルータBは、宛先IPアドレスとサブネットマスクの論理積(AND)をとったものがaと一致するパケットを受信すると事務所1に転送するということです。
事務所1内にはルーティングテーブル1行目で設定されている192.168.0.0/24と、サーバ群が配置されている192.168.1.0/24という2つのネットワークセグメントが存在します。
つまりルーティングテーブルの2行目に設定すべき事務所1を宛先とするもう1つのIPアドレスは「192.168.1.0」になります。

∴a＝192.168.1.0

→
あー・・。単純にセグメントが0か1の2つあるからって事だけか。
ファイルサーバーへのアクセスが必要だからって具体的にかいちゃったけど、これは1に属するから1のネットワークを指定するだけでよかったんだ。
てへぺろ。


[3][1]
広域イーサネットとインターネットVPNの特徴は次の通りです。

広域イーサネット
回線事業者が提供する閉域ネットワークに接続する。
イーサネットの名の通りL2レベルで接続するため上位の層のプロトコルがIPに限定されない。
事業者の回線を使用するため帯域保証などのサービスがある。

インターネットVPN
IPsecなどのセキュリティプロトコルを利用して公衆回線上にVPNを構築する。
通信経路にインターネットを利用するため専用線を用いるサービスと比較して安価なことが多い。
通信品質を保証しないベストエフォート型なのでネットワークが混雑していると通信の遅延が生じることがある。

設問では「事業所間で利用するテレビ会議機能に着目して」と指定されています。
本文中の「テレビ会議機能は遅延なく良好なレスポンスを確保する必要がある」という記述、
および2つの方式の特徴から帯域が保証される「広域イーサネット」を主経路にするのが適切と判断できます。
広域イーサネットは30Mビット／秒の契約で、テレビ会議機能では1つの事務所当たり5Mビット／秒の帯域が使用されます。
たとえテレビ会議機能を使用したとしても残り20Mビット／秒の帯域があるため、残りの機能(電子メール、グループウェアの利用、ファイル共有)の利用には十分と考えられます。

∴主経路＝広域イーサネット網
　理由＝遅延が少なくテレビ会議機能に適しているから

→
これは広域イーサネットとインターネットVPNの通信特性を知っていないとわからない問題だ。  
てか、IPによる認証って関係なかったのかよって感じでもある。
```

---

## データベース 人事情報のデータ構造

いやー、久しぶりに敗北した。  
全体的に話は分かったけど、納得の行く答えに絞れなかった。  
再帰の問題は難しい。  
itecの問題にあったからやったけど、やっておいてよかった。  

### 第1正規形

各属性の繰り返し項目を排除し、単一値を属性とする複数の行に分解した状態。

### 第2正規形

第1正規形であり、かつ、主キーの一部だけで一意に決まる属性を別表に分離した状態（主キーに部分関数従属する属性がない状態）。

### 第3正規形

第2正規形であり、かつ、主キー以外の属性によって一意に決まる属性を別表に分離した状態（主キーからの推移的関数従属が存在しない状態）。

``` txt : 30分 3/9
→
部署ID
上位部署ID

第2正規形 × 第1正規形
年月日の情報は所属部署IDに紐づく情報で分離できるから ×
例)・主キーの一部に関数従属している属性があるから
   ・主キーに部分従属している属性があるから
   ・社員IDだけに従属している属性があるから
{社員ID}、{所属部署ID}、(適用開始年月日)、適用終了年月日
→{社員ID}、{適用開始年月日}、適用終了年月日、所属部署ID

= 部署.部署ID × IS NULL
2014-04-01 × 2012-10-01
9999-12-31 × 2014-03-31


[2][1]
まず、社員エンティティが第1正規形かどうかを検討します。明らかにレコード1行の中に複数の繰り返し項目を値とする属性はありません。
よって、少なくとも社員エンティティは第1正規形です。

次に社員エンティティが第2正規形かどうかを検討します。
〔新システムでの履歴管理〕の要件(4)には「所属情報以外の社員の情報は履歴管理する必要はなく，最新の情報だけを管理すればよい。」とあり、
複合主キーの一部である"社員ID"がわかれば、属性"氏名"・"性別"・"電話番号"・"自宅住所"・"自宅電話番号"は一意に特定できます。
複合主キーの一部に関数従属する属性がある（主キーに部分従属する属性がある）ことから、社員エンティティは第2正規形ではありません。

よって、社員エンティティは「第1正規形」、理由は「主キーの一部である関数従属する属性があるから」「主キーに部分従属している属性があるから」「社員IDだけに従属している属性があるから」などです。
厳密には、第1正規形を充足し第2正規形でないことを説明する必要があるので、「すべての属性が単一値であること」「主キーの一部である"社員ID"に関数従属する属性があること」の2つを含める必要があるのですが、文字数制限の関係もあり解答例では後者の理由のみに留めています。

∴主キーの一部に関数従属している属性があるから
　主キーに部分従属している属性があるから
　社員IDだけに従属している属性があるから


主キーが2つって事は
社員ID 時間
1      2012
1      2013
みたいな事ができる。
でも、住所とかってそこまで変わらないでしょ。
そういうのって別のテーブルにまとめればいいじゃんって話。
社員IDだけで決まる要素ってたくさんあるよね。それって複合キーの中で関数従属してる証拠だよね。って事だろ。
これこそ、主キーの一部だけで一意に決まる要素が分離されていない→第2正規形を満たしていないと言っていることか。


[2][2]
本文中に「エンティティ"所属"を新たに追加し，エンティティ"社員"を第3正規形とした。」とあるので、図3の社員エンティティを第3正規形にすることを考えます。

図3の社員エンティティは第1正規形ですので、第3正規形にするためには、まず第2正規形にする必要があります。そのために、複合主キーへの部分関数従属を排除します。
(1)より、属性"氏名"・"性別"・"電話番号"・"自宅住所"・"自宅電話番号"は複合主キーの一部である"社員ID"に関数従属しているため、
"社員ID"を主キーとする新たなエンティティを作り、"社員ID"に関数従属する属性を移動します。図4より、このエンティティを改めて社員エンティティ、元のエンティティを所属エンティティとしていることがわかります。
関係スキーマ：エンティティ名（属性名1，属性名2，...）を記述すると、
社員（社員ID，氏名、性別、電話番号、自宅住所、自宅電話番号）
所属（社員ID，適用開始年月日，適用終了年月日，所属部署ID）
となり、第2正規形です。次に所属エンティティが第3正規形かどうかを検討します。
第3正規形では主キーではない属性への関数従属を排除します。属性"適用終了年月日"と"所属部署ID"の間に関数従属性がないことは明らかですので、推移適関数従属はありません。
よって、第3正規形の条件を満たしています。

したがって、所属エンティティの属性は以下の4つです。

∴社員ID
　適用開始年月日
　適用終了年月日
　所属部署ID

※図4より、第2正規形の段階からエンティティの個数が増えていないので、同時に第3正規形であったことは（裏技的に）一応わかります。


あくまで、社員IDと適用開始年月日が主キーなので、これは別表として抜き出せる。
後は、適用終了年月日はマストとして部署がいつからいつまでって事を表したいので、所属部署IDも属性として抜き出せばおｋ。
そういうこと。



[3][1]
〔dについて〕
図5のSQL文は、図2で例示されているSQL文に日付指定の条件を追加した以外は基本的に違いはありません。ただし、UNION ALL句直前のWHERE句で指定している列が部署ID列から上位部署ID列に変わっています。UNION ALL句直後のSELECT文では、WITH RECURSIVE句で導出した関連部署表のレコードを順番に呼び出します。

図2のSQL文は、指定した部署とその配下の全ての部署を表示するものでしたから、会社全体の部署構造を表示するには木構造の最上位である"会社"を起点として指定することになります。本文中には「最上位である会社の上位部署IDにはNULLを設定する。」とあるので、最初の関連部署表となる1行としては上位部署IDがNULLのレコードが適切です。したがって、[d]には「IS NULL」が当てはまります。

```

---

## 組込みシステム 通信機能を内蔵したディジタル電力量計の設計

最後の問題が正解したのは以外だった。  
多分難しい部類の問題だと思われる。  
ビットの問題は素直にわからなかった。  
2048という数字を出すためには11ビットだからそれ以外ないだろうという短絡的な思考で答えたら死んだ。  

時間がずれる可能性は全く思いつかなかった。  
文中のそれっぽいヒントをもとに書いてみたけど、多分違う。  
補正された時の変化量が1秒以上だった場合という、逆に補正された結果誤差が生じるとは夢にも思わなんだ。  
時間を動かすのなんて、時間を修正するタイミングしかないんだから、愚直にその可能性を考えればそれしかないのかね。  

後は、なんのデータをもってデータがないと判断するかって下りだが、その時間のデータがない、つまりタイムスタンプを調べればあるかないかわかるよねって話なわけだよな。  
組み込みは個人的にとっつきやすくていいと思うんだけど、こういうのがあるから怖い。  
これが不安に感じる要素の1つで絶対的な自信を持てない要因だな。  
スレも乱立しているので多分難しい部類だったのだと思われる。  

``` txt : 30分 2/6 実質4問正解

RTCの1日の誤差が次の日になっても補正されず、誤差が1秒以上となった場合 100%
→時計の補正機能によって、時計の時刻が1秒以上変化したとき

指定した時間帯の電力量データ × タイムスタンプ
→詰まるところ、時間のデータがないんだからタイムスタンプで十分だったよな。

11 × 22

識別コード × 電力量計の識別コード
プログラム番号 × プログラムのバージョン情報
→なんで文中に書いてあるのにそう書かなかったのか疑問だ。言いたいことは間違っていないので正解とする。

17

---

[1]
問題文の〔電力量計の機能〕の(5)には、「電力量計は，毎時0分0秒から29分59秒までのタイムスタンプが付いた1秒データ，又は毎時30分0秒から59分59秒までのタイムスタンプが付いた1秒データ(以下，これらを電力量データという)をサーバに送信する。」とあります。電力量の計測は1秒ごとに行われるので、電力量データは毎時0分0秒から29分59秒までの1,800秒間、または毎時30分0秒から59分59秒までの1,800秒間のデータであることがわかります。つまり、何ら問題なく電力量計測が行われた場合には電力量データの個数は1,800個になります。

しかし、問題文の〔電力量計の機能〕の(3)で説明されている時刻補正機能によって、時計の時刻が1秒以上変化した場合は、電力量データの個数は1,800個になりません。例えば、次のようなケースです。
●分9秒で電力計測(正確な時刻は●分9.3秒)
↓
●分10秒で電力計測(正確な時刻は●分10.3秒)
↓
●分10.1秒にRTCを●分9.8秒に時刻補正(-0.3秒)
↓
0分10秒で電力計測
↓
0分11秒で電力計測
●分9秒で電力計測(正確な時刻は●分8.7秒)
↓
●分10秒で電力計測(正確な時刻は●分9.7秒)
↓
●分10.8秒にRTCを●分11.1秒に時刻補正(+0.3秒)
↓
●分12秒で電力計測
↓
●分13秒で電力計測
①では●分10秒が2回記録されるため1,801個、②では●分11秒が飛ばされてしまうため1,799個のデータとなります。このように、時刻補正機能によってRTCの時刻が秒をまたいで変化したときには、電力量データの個数が1,800個になりません。

∴時計の補正機能によって、時計の時刻が1秒以上変化したとき

→
まさか補正するときにずれるなんて思わなんだ。


[2]
〔サーバの機能〕について、サーバのデータベース上で、電力量データの欠落を検出するのに使用するデータの情報を考えます。

問題文の〔電力量計の機能〕の(4)には、「電力量計は，1秒ごとに1秒分の電力量を計測する。計測によって得られた電力量のデータには，年月日を含む秒単位の時刻情報(以下、タイムスタンプという)が付与される。」とあります。このことから、1秒データには計測時刻を表すタイムスタンプが含まれていることがわかります。タイムスタンプは秒単位の情報であり、電力量の計測は1秒ごとに行わるので、サーバのデータベースには期間内の全ての秒に対応するタイプスタンプが記録されることになります。

特定時刻のタイムスタンプが存在しないということは、電力量データに欠落があるということを意味します。もし、通信障害等の何らかの事由により、電力量データがデータベースに格納されなかった場合には、その期間のタイムスタンプが抜けてしまっているはずです。つまり、データの欠落は「タイムスタンプ」の網羅性を調べることによって検出可能です。

∴タイムスタンプ


[3]
〔aについて〕
A/Dコンバータに必要な最小ビットを求めます。

問題文の〔計測部のA/Dコンバータ〕には、「電圧値を計測するA/Dコンバータは，最下位ビットが1／2,048ボルトの重みであり、負の値を2の補数表現として －1,024ボルト～1,024－(1／2,048)ボルトの範囲の電圧を計測できる。」とあります。
2の補数
2進数で負数を表現する方法の一つです。ある正の数の2の補数を求めるには、すべてのビットを反転して1を加えます。

まず、最小値である-1,024ボルトを2の補数で表します。1,024(=210)は2進数で

　(10000000000)2

ですが、最下位ビットは1／2,048(=1／2^11)ボルトの重みですので、小数点以下11桁も必要となります。

　(10000000000.00000000000)2

負数なので2の補数に変換すると、

　(10000000000.00000000000)2

となります(元のビット列と同じです)。つまり、最小値を表すのに必要なビット数は22ビットです。

次に、最大値である1,024-(1／2,048)ボルトについて考えます。1,024は2進数で、

　(10000000000.00000000000)2

1／2,048は2進数で、

　(00000000000.00000000001)2

なので、1,024 - (1／2,048) は、

　(01111111111.11111111111)2

です。正の数なので2の補数への変換はありません。最大値についても必要なビット数は22ビットです。よって、aには「22」が入ります。

∴a＝22

→
なかなか屈辱的な間違いだった。
2進数の分数表記になると思考停止する。
そりゃそうだよな。小数点以下は分数と同じだよな・・・。


[4][2]
問題文の表1「電力量計のハードウェア構成」の計測部に、「RTCは常に時刻を計時している。RTCは1秒ごとに割り込みを発生し，割り込みごとにソフトウェアで1秒データを計測する。RTCの誤差は1日当たり±0.7秒である。」とあります。RTCの誤差は24時間で±0.7秒ですから、何時間経過すれば誤差が±0.5秒になるのかを考えます。

誤差が±0.5秒になるまでにかかる時間は、

　24×(0.5／0.7)＝17.1428571…(時間)

となります。小数第1位を切り捨てて整数で答えを求めるため「17」が適切です。

∴17

→
文中にある時間を使って解くならこれしかないだろうなと思って解いたら当たった。
アプローチは若干違うけどまぁいいだろう。
0.7/24 = 0.0291666..
0.5/0.029 = 17.2...
```

---

## 情報システム開発 ソフトウェアパッケージの利用

うーん。全問正解いけたのにつまらないミスをしてしまった。  

``` txt : 24分 5/7
見積回答書の内容を基に、見積金額を入力 100%
他)見積金額をシステムに入力
仕入先が、見積回答を直接入力 100%
仕入先が、請求内容を直接入力 100%

明細追加()
1 × 0..1

1     0..*
◆-----
×
→
                 1    1..*
見積もり取得依頼 ◆---- 見積取得依頼明細

パッケージプログラムを使用してパッケージテーブルにアクセスする機能について 100%
他)追加プログラムが使用するパッケージプログラムの変更内容

---

〔fについて〕
見積取得依頼明細クラスから見た仕入先クラスの多重度です。
仕入先クラスは、見積取得依頼明細に紐づけられた仕入れ先情報を表しますが、本文に「希望する仕入先があり希望仕入先名を入力する際は(中略)見積取得依頼画面の明細に，品目名又は希望仕入先名を指定する。」とあります。
この記述より、仕入先の指定は必須ではない（多重度0があり得る）ことがわかります。また仕入先の入力は「出力される品目又は仕入先をラジオボタンで選択し」とあります。
ラジオボタンは「複数の選択肢のなかから、ただ一つを選択する」際に使用されるユーザインタフェースであるため、希望仕入先名に指定される仕入先はただ1つです。
これらを踏まえると[f]は「0..1」となります。

∴f＝0..1

→
問題文をよく読むとその通り。
DBの感覚で(マスターなら多重度は1)答えたから間違った。
似てるけど、問題文をよく読んで気が付く必要がある。
後は、似てるけど概念は違うのだから完全に同じで考えてはダメって事だな。


〔eについて〕
見積取得依頼クラスと見積取得依頼明細クラスの関連を表します。前述した通り、1つの見積取得依頼（クラス）には複数の見積取得依頼明細（クラス）が紐づけられ、「集約」の関係性があることが伺えます。
さらに、見積取得情報が消えれば、それに紐づいている見積取得明細情報は存在意味を失うので、両クラスの生存期間が同じである強い分解－集約関係、すなわち「コンポジション」の関係が適切です。

多重度については、1つの見積取得依頼について複数の明細を追加登録できるため、見積取得依頼クラス側の多重度が1に対し、見積取得依頼明細クラス側の上限はなし（多重度*)です。
見積取得依頼明細クラス側の下限については、本文中に「案件名及び明細行を入力し登録ボタンを押すことによって，見積取得依頼及びその明細が登録される。」とあり、明細のない見積取得依頼は登録できない（存在しない）と考えられるので1となります。
したがって、見積取得依頼明細クラス側の多重度は1以上（1..*）が適切です。

→

全体と部分を表す集約(◇)。
通常よりも強い集約関係。
同時に生成され、同時に消滅する性質を持つ場合はコンポジット(◆)の関係になる。
依頼があるなら明細も絶対に存在するので1対多
依頼が0ってのはあり得ない。データがないなら作られるべきではないから。

後は、反例に従うならお互いのクラス名まで記述するべきだった。
それすらなかったから部分点ももらえないだろうな。

しかし、間違えたおかげでコンポジットの概念は理解出来た。
逆に間違ってよかったかもしれないな。
```
