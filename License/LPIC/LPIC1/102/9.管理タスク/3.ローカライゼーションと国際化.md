# ローカライゼーションと国際化

---

## ローカライゼーション(localization)

言語や通過単位、日付の書式等を地域や国に合わせる事  

---

## 国際化(internationalization : i18n)

ローカライゼーションを国ごとに行うのは大変なので、多くのソフトウェアでは最初から多言語・他地域に対応するように作られている。  

---

## ロケール

利用者の地域情報  

systemdが動作するシステムでのシステム全体のロケール設定ファイルは「/etc/locale.conf」です。  

デフォルトのロケールはC（POSIX）ロケールです。  
Cロケールのエンコーディング（数値と文字の対応・変換の方式）はASCIIで、数値や日付の書式は米国英語です。  
日本とフランスなどロケールが異なる環境でスクリプトを実行しても、英語で共通の出力が得られます。  
またロケールに関する処理が行われない分、処理の高速化が期待できます。  

``` txt : ロケールの主なカテゴリ  
LC_CTYPE     :: 文字の種類やその比較・分類の規定  
LC_NUMERIC   :: 数値の書式に関する規定  
LC_TIME      :: 日付や時刻の書式に関する規定  
LC_MESSAGES  :: メッセージ表示に使用する言語  
LC_MONETARY  :: 通貨に関する規定  
LC_NAME      :: 名前の書式
LC_ADDRESS   :: アドレス、ロケーションの書式
LC_TELEPHONE :: 電話番号の書式
LC_COLLATE   :: 文字の照合や整列に関する規定  
LC_ALL       :: ロケールの環境変数すべて  
                指定した値が全てのカテゴリを上書きし、カテゴリごとの設定が出来ない。
LANG         :: 全てのカテゴリで必ずその値が使われるが、個々のカテゴリ毎に個別の設定が可能。
                (LC_ALL)が設定されていない場合、指定した値がデフォルトとして使用される。

※LC_ALLは全てのカテゴリを上書きするので「/etc/locale.conf」に設定することは推奨されません。
```

---

## localeコマンド

現在のロケールの設定を確認するコマンド  
引数なしで実行した場合、システムに設定されているロケールが表示される。  

``` txt
構文 :: locale [オプション] ユーザー名

オプション
-a :: 設定できるロケールを全て表示
-m :: 利用できる文字コードを全て表示
```

ロケールの環境変数の全てをja_JP.utf8にする例  
`export LC_ALL=ja_JP.utf8`  

---

## ロケール名の言語名_国家もしくは地域名.文字コード  

``` txt : 主なロケール名  
C,POSIX :: 英語  
ja_JP.utf8 :: 日本語/Unicode  
ja_JP.eucJP :: 日本語/EUC-JP  
ja_JP.ShiftJIS :: 日本語/シフトJIS  
en_US.utf8 :: 英語(米)/Unicode  
```

---

## 文字コード

``` txt
ASCII       :: 7ビットで表される基本的な128種類の文字(英数字+α)  
ISO-8859    :: ASCIIを拡張した8ビットの文字コードで256種類の文字を表現  
UTF-8       :: Unicodeを使った文字コードで、1文字を1バイトから6バイトで表す  
EUC-JP      :: 日本語EUC。UNIX環境で標準的に利用されていた日本語の文字コード  
ShiftJIS    :: Windowsで利用される日本語の文字コード  
ISO-2022-JP :: 電子メールなどで利用される日本語の文字コード(JISコード)  
Unicode     :: 多言語を扱うために作成された符号化文字集合(文字コード表)
               Unicodeで定義された文字を表現する符号化方式には、UTF-8,UTF-16,UTF-32等がある。
```

---

## iconvコマンド

文字コードを変換するコマンド  

``` txt
iconv [オプション] [入力ファイル名]

オプション
-f 入力文字コード :: 返還前の文字コードを指定する
-t 出力文字コード :: 変換して出力したい文字コードを指定する 
-l :: 扱える文字コードを表示する  
```

日本語EUC(EUC-JP)で作成されたファイルreport.euc.txtをUTF-8に変換してreport.utf8.txtとして保存する例。  
`iconv -f eucjp -t utf8 report.euc.txt > report./.utf8.txt`  

---

## タイムゾーン

地域ごとに区分された標準時間帯をタイムゾーンと言う。  
主にエポック時間からローカルの時間に変換するときに参照する。  
Linuxの内部では、UTC 1970年1月1日午前0時0分0秒からの経過秒数であるエポック（epoch）時間で時間を管理しており、  
設定されたタイムゾーンにしたがってエポック時間から変換して、日付時刻を扱います。  
なお、エポック時間はUNIX時間（Unix Timestamp）とも呼ばれます。  

一般ユーザーでも変更することが出来る。  

---

## UTC(Coordinated Universal Time) JST(Japan Standard Time)

UTC（Coordinated Universal Time）は協定世界時のことで、各地の時間を決める際の基準となるものです。  
JST（Japan Standard Time）は日本標準時のことで、UTCより9時間進んでいます。  

---

## /usr/share/zoneinfo/ と /etc/localtime

「/usr/share/zoneinfo/」ディレクトリ以下には、国や地域ごとにタイムゾーンの情報がバイナリファイルとして格納されています。  
システムのタイムゾーンは、それらのバイナリファイル群から、  
システムで使用したいタイムゾーンのものを「/etc/localtime」へコピーまたはシンボリックリンクを作成することで設定します。  

タイムゾーンといいつつ、リンクを張る先はlocaltimeなのに注意。  
zoneinfoファイルは`/usr`ディレクトリであることに注意(1敗)  

タイムゾーンを日本に設定するコマンド  
`cp /usr/share/zoneinfo/Asia/Tokyo /etc/localtime`  

シンボリックリンクの場合  
`ln -s /usr/share/zoneinfo/Asia/Tokyo /etc/localtime`  

---

## /etc/localtime

システムクロックの時刻からローカルタイムへ変換するための時差情報が格納されている。  

Linuxのインストール時に指定したタイムゾーンに対応する/usr/share/zoneinfoの下のファイルがコピーされる。  
ディストリビューションやバージョンによってはシンボリックリンクとして作成される場合がある。  

バイナリファイルらしい。  
「/etc/localtime」には「/usr/share/zoneinfo/」ディレクトリに格納されている、国や地域ごとのタイムゾーン情報を持つバイナリファイルをコピーする事でタイムゾーンを設定します。

---

## /etc/timezone

システムで使用するタイムゾーンを指定するテキストファイル。  

例）システムのタイムゾーンを日本（Asia/Tokyo）にする場合  
`cat /etc/timezone`  
Asia/Tokyo  

---

## 環境変数TZ

環境変数`TZ`で設定もできる。  
`export TZ="Asia/Tokyo"`  

環境変数TZを全ユーザーで利用するなら、`/etc/timezone`ファイルに「Asia/Tokyo」と設定する。  

---

## tzselectコマンド

一覧から表示される情報をもとにタイムゾーンを設定できるコマンド。  
対話式でオプション等はなさそう。  
環境変数「TZ」や「/etc/timezone」ファイルで指定する値は「tzselect」コマンドで確認できる。  

tzselectコマンドで得た値は以下のように使用します。  
・export TZ=Asia/Tokyo  
・vi /etc/timezone  
Asia/Tokyo  

---

## tzconfigコマンド

このコマンドでもタイムゾーンを設定できる。  
`/etc/localtime`と`/etc/timezone`の値をまとめて変更する。  

Debian系のコマンド  
最近のディストリビューションでは利用できない。  
利用したいなら`dpkg-reconfigure tzdata`をたたく。  
