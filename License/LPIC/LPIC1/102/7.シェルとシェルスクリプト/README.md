# 7.シェルとシェルスクリプト

- シェル環境のカスタマイズ  
- シェルスクリプト  

``` txt : シェル環境のカスタマイズ
・alias    :: エイリアスを設定するコマンド。
              本来のコマンドを実行したい場合は頭に「\(バックスラッシュ)」を付けて実行するか、パス付きで実行する。
              既に登録されている別名と同じ別名で再定義した場合、上書きされる。
・unalias  :: 設定したエイリアスを削除するコマンド。
・function :: bashシェル上で利用できる独自の関数を定義するためのコマンド。
・unset    :: 設定済みの環境変数やシェル変数を削除するコマンド。
・declare  :: 変数を宣言するコマンド。シェル関数の確認は「-f」。
・set      :: シェルの設定を確認、変更するコマンド。全てのシェル変数、シェル関数、環境変数を表示できる。
              パス名のワイルドカードによる展開（*や?）を無効に設定したい。[set -o noglob]
              リダイレクト「>」によるファイルの上書きを禁止にしたい。[set -o noclobber]
              シェルのオプションの設定状態を確認。[set -o]
・env      :: 設定されている環境変数の値を一時的に変更したり、削除したりしてコマンドを実行するコマンド。全ての環境変数も表示できる。
※一時的に削除するコマンドは「-u」
・printenv :: 指定した環境変数のみを表示するコマンド。未指定で全ての環境変数を表示する。
・/etc/bash.bashrc :: Debian系。bash起動時に実行させたい処理(エイリアス)を記述するファイル。
・/etc/bashrc      :: RedHat系。bash起動時に実行させたい処理(エイリアス)を記述するファイル。
・/etc/profile     :: Linuxの標準シェルであるbashの環境設定ファイル。ログイン後すぐに必要となる基本的な環境変数を設定する。
・~/.bash_profile  :: 各ユーザー個別の環境変数等を記述するファイル。ログイン時に実行される。  
・~/.bash_login    :: ~/.bash_profileがない場合、ログイン時に実行される。内容は~/.bash_profileと同じ。  
・~/.profile       :: ~/.bash_profileも~/.bash_loginもない場合、ログイン時に実行される。内容は~/.bash_profileと同じ。  
・~/.bashrc        :: 各ユーザー個別のbash起動時に実行させたい処理(エイリアス)等を記述するファイル。読み込む設定がない場合は読み込まれない。
・~/.bash_logout   :: bashログアウト時に実行させたい処理を記述するファイル。
・ログインシェル   :: /etc/passwdに設定され、ユーザーのログイン時に最初に起動されるシェル。このシェルが終了するとログアウトされる。  
・非ログインシェル :: ログインシェルから別のプロセスとして起動するシェル。コマンドラインから直接起動したシェル。  
・export           :: シェル変数を環境変数に変更するコマンド。
・bash :: Linuxの標準シェル
・sh :: 1977年にAT&Tベル研究所のスティーブン・ボーンにより開発された（Bourne Shell）
・ksh :: 1980年代初期にベル研究所のデビッド・コーンにより開発された（KornShell）
・csh :: BSD UNIXシステム上でビル・ジョイによってC言語をモデルとして開発された
・tcsh :: cshのバグを修正し、機能を拡張したもの

■ bashをログインシェルとして起動した場合の読み込み順  
1. /etc/profile     ← 絶対
2. /etc/bash.bashrc ← Debian系の場合、読み込む
3. ~/.bash_profile  ← 存在したら読み込む
4. ~/.bash_login    ← ~/.bash_profileが存在しないで、~/.bash_loginが存在したら読み込む
5. ~/.profile       ← ~/.bash_proflieも~/.bash_loginも存在しないで、~/.profileが存在したら読み込む
6. ~/.bashrc        ← ~/.bash_proflieと~/.bash_loginと~/.profileのどれかが存在して、かつ読み込む設定があれば読み込む
7. /etc/bashrc      ← ~/.bashrcを読み込んで、更に/etc/bashrcを読み込む設定があれば読み込む

■ bashを非ログインシェル(対話型シェル)として起動した場合の読み込み順  
1. /etc/bash.bashrc ← Debian系の場合、読み込む
2. ~/.bashrc        ← 絶対
3. /etc/bashrc      ← 読み込む設定があれば読み込む 

■bashにおける環境設定ファイル
・bashで実行できるシェルスクリプトである
・ログインシェル起動時に「/etc/profile」を最初に読み込む
・実行権は必要ない。(soueceコマンド、ファイルの読み取り権、ディレクトリの検索権[-x]があればよい。)
```

``` txt : シェルスクリプト
・コマンド置換 :: コマンドの実行結果をシェル変数に代入する機能。  
・source  :: ファイルに書かれたコマンドを現在のシェルで実行する事を指示するコマンド。「.（ドット）」でも代用されます。
・exec    :: 指定したコマンドを既存のジョブ(シェルのプロセス)に置き換えて実行するコマンド。
             子プロセスを生成するのではなく、現行プロセスを引数で指定したコマンドに入れ替えて実行するコマンド。
・シバン(シェバング) :: スクリプトファイルの1行目「#!」の事。そのシェルスクリプトがどのインタープリタ（シェル）で実行されるかを記述します。

・$0      :: シェルスクリプトファイル名。  
・$1      :: 1番目の引数。※ 2番目の引数の場合は $2 と指定する。10番目以降は${10}のように「{}」で囲う。  
・「$$」  :: 現在のシェルのプロセス番号。文体がおかしくなるので、これだけかっこで囲ってます。
・$#      :: コマンドラインに与えられた引数の数  
・$?      :: シェルが最後に実行したコマンドの終了ステータス ( 0 = 正常終了、1 = 異常終了、それ以外はエラー ）  
・$@      :: 全ての引数 ( 区切りはスペース )  
・$*      :: 全ての引数 ( 区切りは環境変数IFSで指定したもの )

・if文    :: if 条件式 then 実行文1 else 実行文2 fi
・case文  :: case 式 in 値1) 実行文1 ;; 値2) 実行文2 ;; ~~~ esac
・for文   :: for 変数名 in 変数に代入する値のリスト do 実行文 done
・while文 :: while 条件文 do 実行文 done
・read    :: ユーザーからの入力値を受け取り、変数に格納してそれを次の処理で使用したい場合に使用するコマンド。
・test    :: 条件分岐が行われる条件式の真偽を判断して、その結果を返すコマンド。
・seq     :: 連続した数値を自動的に生成するコマンド。
             [開始する数値 終了する数値],[終了する数値(1から開始)],[開始する数値 増加する値 終了する数値]
・&&      :: command1が成功した場合のみcommand2を実行する。  
・||      :: command1が失敗した場合のみcommand2を実行する。  
・;       :: コマンドを続けて実行する。  
```

---

## 小豆本問題

---

### 1 ○

エイリアスを解除することなく、一時的にエイリアスを無効にして、オプションなしのlsコマンドを実行したい場合どうすればいいか。  

→  
E.コマンドの直前に「\」をつけて実行する。  

→  
まぁ、やったばっかしだからね。  

---

### 2 ○

一連のコマンドを実行するlslink()関数を作成したい場合、関数作成には何というコマンドを使うか？

→  
function  

（　＾ω＾）・・・  
`function lslink() { ls -l | grep '^l'; }`  

---

### 3 ○

システムを利用する全てのユーザーが、ログイン後すぐに必要となる基本的な環境変数を設定しておきたい場合、どの設定ファイルに設定を記述するのが適切か？  

→
A. /etc/profile  

よく、問題文を読んでみれば、これしかない。  
基本的な環境変数の設定ファイルはprofileか。  

---

### 4 ×

次のスクリプトを実行した際、変数「$#」に入る値を選択してください。  
`$ ./testscript args1 args2`

→
・変数「$#」に入る値→引数の数。
・$0 には ./testscript
・$1 には args1
・$2 には args2

---

### 5 ×

bashシェルスクリプトで、`test -x file_a`と同じ動作をするものを選択してください。  

→  
B. [-x file_a]  

souece , .はスクリプトの実行  
functionは関数を作成するコマンド。  
scriptコマンドは存在するか知らない。  
消去法でB.

当たった。

→
testコマンドは[~]の形式でも使われる。  
というか大半は[~]形式で使われる模様。  

---

### 6 ×

以下は、端末から名前を入力すると、その名前を使って挨拶を返すシェルスクリプトです。  

``` sh
echo -n "Enter your name:"
______ name
echo "Hello,$name!"
```

→  
read  

全体を一周する前にやった問題だから間違った。  
答えはシェルスクリプト内部でキーボード入力を受け付けるコマンドであるreadです。  
C#に置けるConsole.Readですね。  
