# 11.ネットワークの基礎

- TCP/IPの基礎  
- ネットワークの設定  
- ネットワークのトラブルシューティング  
- DNS  

``` txt : TCP/IPの基礎
・IPv4、IPv6
・ユニキャスト、エニーキャスト、マルチキャスト、ブロードキャスト
・ウェルノウンポート
・サブネット、ネットワークアドレス、ブロードキャストアドレス、プライベートアドレス  
・CIDR(Classless Inter-Domain Rounting) :: IPアドレスのクラスの概念を使わずに、任意の長さのサブネットマスクを利用する事。
・TCP(Transmission Control Protocol)  
・IP(Internet Protocol)  
・UDP(User Datagram Protocol) :: OSI参照モデルの第4層に属するコネクションレス型のプロトコル。
                                 データ転送速度が速いことから、ストリーミング用のアプリケーションに用いられる。
・ICMP(Internet Control Message Protocol) :: パケットが到達出来なかった場合のエラーメッセージや制御メッセージを通知するプロトコル。
・ARP(Address Resolution Protocol) :: IPアドレスからMACアドレスを求めるときに使われるプロトコル。
※ウェルノウンポートの最小値 : 0
※Linuxの一般ユーザ権限で使用できるポートの最小値 : 1024
A   ::   0.0.0.0 - 127.255.255.255 :: 255.0.0.0
B   :: 128.0.0.0 - 191.255.255.255 :: 255.255.0.0
C   :: 192.0.0.0 - 223.255.255.255 :: 255.255.255.0
D   :: 224.0.0.0 - 239.255.255.255
E   :: 240.0.0.0 - 255.255.255.255
```

``` txt : ネットワークの設定
・/etc/services           :: ポート番号とサービスの対応が記述されたファイル。複数形であることに注意。
・/etc/sysconfig/network  :: ホスト名を設定するファイル(RHEL6以前)。ネットワーク機能の有効/無効やデフォルトゲートウェイ等も設定可能。  
・/etc/hosts              :: IPアドレスとホスト名の対応付けファイル。
・/etc/hostname           :: ホスト名のみを設定するファイル(Debian系,RHEL7以降)
・/etc/network/interfaces :: Debian系でネットワークインターフェースの設定を記述するファイル。  
・/etc/sysconfig/network-scriptsディレクトリ  

・NetworkManager :: 動的にネットワークを管理する仕組み。
※特定のインタフェースをNetworkManagerで管理しないように設定できる  
※検出されたネットワークデバイスは自動でNetworkManagerによって管理される  
※設定をしていない全てのI/Fに対して設定を行う。
※特別な設定をしてあるI/F以外はDHCPを設定する。
・nmcli :: NetworkManagerを管理するためのコマンドラインインタフェース（CLI)、及びコマンド。  
・nmtui :: NetworkManagerによるネットワーク管理を行える、cursesベースのインタフェースを起動するコマンド。
・curses :: (カーシス: UNIX向け端末制御ライブラリ)ベースのテキストユーザインタフェース(TUI)。
・systemd-networkd :: systemdの動作するシステムで、ネットワーク設定を管理するデーモンプログラム
※systemd-networkdの設定は「/etc/systemd/network」配下の拡張子.networkのファイルで行います。
```

``` txt : ネットワークのトラブルシューティング
・ping        :: 宛先アドレスに到達可能か確認するコマンド。
・ping6       :: ipv6版。
・traceroute  :: 宛先アドレスまでの経路を確認するコマンド。
・traceroute6 :: ipv6版。
・tracepath   :: 宛先アドレスまでの経路と経路上の最大転送単位(PathMTU)を確認するコマンド。
・tracepath6  :: ipv6版
・hostname    :: 自ホストのホスト名やドメインを参照したり、ホスト名を一時的に変更するコマンド。
・hostnamectl :: systemdが動作するシステムにおける、ホスト名や関連する情報の表示、ホスト名の設定を行うコマンド。
※「nmcli general hostname ホスト名」でも表示可能。
・netstat     :: さまざまな項目を指定して、ローカルホストのネットワーク関連の情報を表示するコマンド。
・ss          :: netstatの後継。ネットワークのソケットの情報を表示するコマンド。
・nc          :: テキストストリームにおけるcatコマンドと同様の働きをネットワーク上で行うコマンド。簡易サーバーにもなる。
・route       :: ルーティングテーブルの表示や操作を行うコマンド。  
※ipアドレス指定する場合は「default gw」指定しない場合は「default」
・ip          :: IPアドレスやルーティングを設定するコマンド。ifconfigの後継。
・ifconfig    :: インターフェースの情報の表示や設定を行うコマンド。
※表示項目 :: IPｱﾄﾞﾚｽ、ｻﾌﾞﾈｯﾄﾏｽｸ、ﾌﾞﾛｰﾄﾞｷｬｽﾄｱﾄﾞﾚｽ、送受信バイト数、MTU
※副作用としてインターフェースのアップ・ダウン状態が変更される事があるのと、何もない時がある。
・ifup        :: 指定したインタフェースを有効にするコマンド。
・ifdown      :: 指定したインタフェースを無効にするコマンド。
・デフォルトルート :: 他に宛先がない場合に参照されるルート。Linuxのルーティングテーブルでは「default」と表示される。
※デフォルトゲートウェイ確認コマンド :: 「ip route show」「netstat -r」「route」
```

``` txt : DNS
・/etc/resolv.conf  :: 名前解決に利用するDNSサーバの指定や、ドメインの指定をするファイル。
・/etc/nsswitch.conf:: GNU Cライブラリが名前解決やサービス名解決の際の問い合わせ順序を指定するファイル。
・systemd-resolved  :: systemdの動作するシステムで名前解決を管理するデーモン。
・/etc/systemd/resolved.conf :: systemd-resolvedの設定ファイル。
・host     :: DNSサーバーを使ってホストやドメインに関する情報を表示する。最も基本となるコマンド。最小出力。
・dig      :: DNSサーバへ直接問い合わせて、指定した名前に関するDNSサーバからの応答を表示します。ドメイン情報も表示される。
※ホスト名の指定はwwwを含んでも含まなくても良い。  
・getent   :: 名前解決の順序を設定する「/etc/nsswitch.conf」に従って検索を行うコマンド。
・whois    :: 調べたいドメイン名を指定して、whoisデータベースに問い合わせるコマンド。
・nslookup :: WindowsにおいてDNSサーバに名前解決を問い合わせるWindowsのコマンド。
```

---

## 小豆本問題

### 1

エラーメッセージや制御メッセージを伝送するコネクションレス型のプロトコルで、pingやtracerouteコマンド等で利用されているものを選択してください。  

pingという地点でネットワーク層。
プロトコルなので、internet protcol management protocol

---

### 2

以下のIPアドレスの中から、プライベートアドレスとして利用できるものを全て選択してください。

10.0.0.0~10.255.255.255
172.16.0.0~172.31.255.255
192.168.0.0~192.168.255.255

A,E

---

### 3

ネットワークサービスの名称とそのサービスが標準的に利用するポート番号の対応が記述されているファイルを絶対パスで記述してください。  

→  
やったはずなんだが。
思いっきりやってたわ。
サービスってあるから、それで回答すればよろしかった。

`/etc/services`  

---

### 4

デフォルトで53番ポートを利用するサービスを選択してください。

80と25と443しか知らない。

FTP?
UDPでした。

---

### 5

example.com ドメインのメールサーバー情報を問い合わせたい場合、下線部に当てはまる適切なパラメータを記述してください。  
`dig___`

× dig -mx example.com
○ dig example.com mx

---

### 6

離れたネットワークにあるホストAとの通信が出来なくなりました。
ホストAまでは複数のルータを経由しており、ローカルネットワーク内では通信に問題はないことから、ホストAとローカルネットワークの間に障害が発生していると考えられます。  
障害の発生している場所を特定するために最も役立つと考えられるコマンドを選択してください。

→
複数のルーターを跨ぐ。どこ地点で死んでいるか調べるためにはルートを検索すべき。
なので、tracerouteでは無かろうか？
合ってた。
ラジオボタンでの選択式で、tracerouteがあったからそれしかないが、他にも`tracepath`もいけるはず。

---

### 7

NetworkManagerでネットワークを管理しています。以下のコマンドを実行してネットワークの接続情報を表示しました。
`$____conn show`

×nclim  
○nmcli  
network manager command line interfaceの略か？

---

### 8

ネットワークインターフェースeth0に、IPアドレス[10.10.0.5]、サブネットマスク[255.255.255.0]を設定したい場合、実行すべきコマンドを選択してください。  

ipコマンドでネットワークの設定はどうやるんだったか。  
正直、ネットワークインターフェースを設定するコマンドだけで2つ以上はあった気がする。  
addr がipアドレスを対象とするって意味だった気がする。
add が追加と思いきや設定で、サブネットはサイダーで決定できるんだっけか。  
となれば、選択肢はCしかなさそうだが？
合ってた。  

`ip addr add 10.10.0.5/24 dev eth`  

他のやつ
ネットワークインターフェースeth0にipアドレス192.168.0.50、サブネットマスク255.255.255.0を設定する。  
`ifconfig eth0 192.168.0.50 netmask 255.255.255.0`

/etc/sysconfig/network-scriptsディレクトリ  
RedHat系でネットワークインターフェースの設定を記述するディレクトリ。  

---

### 9

以下のIPv6アドレスの省略された表記として適切なものを全て選択してください。
`2001:0db8:0000:0000:0023:0000:0000:0045`

→
①先頭の0は省略できる。  
②0が連続しているところは1か所だけ省略することができる。  

2001:db8::23:0:0:45  
2001:db8:0:0:23::45  
