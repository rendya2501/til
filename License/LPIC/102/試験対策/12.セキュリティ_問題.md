# セキュリティ 白本問題

## 1 ○

ログアウトすることなく、別のユーザーIDとグループIDを持つ新たなシェルを起動するコマンドはどれか？1つ。  

→  
A : SU  

選択肢的にこれしかない。  
別のユーザーでログインするだけかと思ったら、別のユーザーでログインしてシェルを立ち上げるってのが正確な表現みたいだ。  
なのでまとめる。  

---

## 2 ○

指定したユーザー権限で特定のコマンドを実行するコマンド。1つ  

→  
SUDO  
言わずもがな。  

---

## 3 ○

あるユーザーがroot権限でアプリを実行できるかどうか判断する時、sudoが読みこむ設定ファイルは何ですか？1つ。  

→  
/etc/sudoers  
問題2をまとめるついでにやったので問題なし。  
まぁ、これは問題ないのだが、中に何を設定するのかは問題だ。  

---

## 4 ○

xinetdの設定ファイル名を絶対パスで記述してください。  

→  
/etc/xinetd.conf  
確かこれしかないだろうなと思ったら当たった。  

その前にxinetdって何だっけ？  
→ネットワークからのリクエストを受け付けるデーモン。  
こいつがリクエストを受け取って、登録されているサービスを起動するんだっけかな。  
いわゆるスーパーサーバープログラムって奴だ。  

---

## 5 ×

xinetdの設定ファイルを編集しました。  
xinetdデーモンの再起動をせずにシグナルをxinetdに送ることで編集を有効にしたい。  
killあるいはpkillコマンドの引数で指定するシグナルの名前を記述してください。  

→  
killコマンドの復習をしないとねぇ。  
忘れたので答え見ますよ。  

HUP or SIGHUP

→  

``` txt
killコマンド
プロセスIDを指定してシグナルを送るコマンド。

kill -[シグナル名またはシグナルID] PID
kill -s [シグナル名またはシグナルID] PID
kill -SIGシグナル名 PID
```

``` txt
pkillコマンド
プロセス名を指定してシグナルを送るコマンド。

pkill [オプション] [シグナル] プロセス名

オプション
-u ユーザ名 : 指定した実行ユーザーによるプロセス対象とする。
-g グループ名 : 指定したプロセスグループのいずれかに属するプロセスを対象とする。
```

``` txt
シグナル名 シグナルID 説明
HUP   1  ハングアップ（端末との接続が切断）
INT   2  キーボードからの割り込み
QUIT  3  キーボードからのプロセスの中止
KILL  9  強制終了
TERM 15  通常終了
CONT 18  一時停止中のプロセスを再開
STOP 19  一時停止
```

実行例  
`pkill -HUP xinetd`  
`kill -HUP xinetdのプロセス名`  

なんでハングアップで有効になるんだ？  
うーん。そういうものと覚えたほうがいいのかねぇ。

---

## 6 ×

xinetd設定ファイルで、サービスを提供するために使われるネットワークアドレスを指定する属性名を記述してください。  

→  
知らん。  
重要度も低い問題だ。答え。  
あー。小豆本の方で面倒だからって飛ばした部分だ。  
まぁ、いい復習の機会になったじゃないか。  

`only_from`  

一回まとめて見たけど、問題文がチンプンカンプンだ。  

---

## 7 ○

TCP Wrepperによって特定のサービスだけを許可したい場合、設定するファイルはどれですか？3つ。  

→  
3つって選択肢の事だよな？  
hosts.allowとdeny何だけど、それぞれ1つとどっちもの3つって事なのか？  
ならB,C,Dだがそれでいいのか？  

うーん。合ってた。  
なんとも腑に落ちないな。  

---

## 8 ○

TCP Wrapperによるアクセス制御でアクセスの拒否を設定るファイルは何ですか？1つ。  

→  
/etc/hosts.deny  
まぁ・・・特にないわ。  

---

## 9 ×

一般的にTCP Wrapperで保護されないものはどれか？1つ。  

→  
auth  

プロトコルでないものを選べばいいのでは？  
あ!プロトコルじゃなくてサービスじゃないものだ。  
ftpってプロトコルであり、起動するサービスなわけだよな。  
httpだけがプロトコルでサービスじゃないからこいつが答えだ。  

どうやら俺の推理は外れたようだ。  

libwrapによるTCP Wrapperで保護されるのは、xinetdから起動されるサービスとlibwrapを利用したサーバが提供するサービス。  
httpはApatchWebサーバーの管轄。  
libwrapを使わない独自のアクセス制御機構を持つ。  

---

## 10 ×

公開鍵暗号と公開鍵認証について正しい説明3つ。  

→  
×A : 秘密鍵と公開鍵は1対多  
○B : 公開鍵は秘密鍵から算出される  
○C : 公開鍵で暗号化し、秘密鍵で復号する  
○F : 認証では秘密鍵で認証データを作成し、公開鍵で検証する  

→  
まさか間違えるとは。  
1対多じゃないの？  
秘密鍵って公開鍵から作られるの？割と知らなかったんだが？  

配布のコストとしては1体多だが、対応としては1体1ということか？

うん。よく答えを見てみると使われる秘密鍵と公開鍵は1体多って書いてあるな。  
配布の対応って文言があれば話は別だが、これは暗号と復号の関係の事だから1対1しかないわな。  

- 公開鍵暗号方式は非対称暗号方式とも呼ばれる。  
- 暗号化と復号の鍵が異なる方式。  
- 秘密鍵を乱数で生成し、秘密鍵から大きな2つの素数の積や離散対数により公開鍵を生成する。  
- 秘密鍵と公開鍵は1対1対応。  
- 秘密鍵から公開鍵が計算されるが、その逆の演算は実質不可能(宇宙が出来上がるまでの時間を書ければ出来なくはないが、計算時間に対して割に合わな過ぎる。)  
- データ送信側は受信側から事前に取得してある公開鍵でデータを暗号化して受信側に送り、受信側は自分の秘密鍵でデータを復号する。  
- 公開鍵認証では、被認証側が自分の秘密鍵で認証データを作成して認証側に送り、認証側では被認証側の公開鍵で認証データを検証する。  

---

## 11 ○

ほすとexamhostにログインするネットワークコマンドの内、通信路を暗号化するものはどれですか？1つ。  

→
ssh examhost  
まさかこれだけか？  
これだけだった・・・。  

---

## 12 ○

sshのknown_hostsファイルには何が格納されているか？1つ。  

→
一度接続したホストの情報。  
のはずなんだが、もっと具体的な内容だった。  
だけど、一度接続したホスト情報に基づけば、Aしかない。

A : サーバーのホスト名、IPアドレス、公開鍵  

イエーイ。正解。  

---

## 13 ○

sshファイルのknown_hostsはどこに作られますか？1ツ  

→  
sshクライアント  

接続した側が知ってるホストなので、クライアントですよね。  

---

## 14 ○

/etc/ssh/ssh_known_hostsファイルのは___ホストキー(公開鍵)が含まれている。  

→  
設定ディレクトリにある。  
ホームディレクトリではない。  
システム設定だから、システムの全てのユーザーが利用可能ではないですかね？  

当たった。  
てか、これ小豆本でもやってないな。  

クライアントがパスフレーズの入力なしにサーバーにログインするホストベース認証の場合には、クライアントの公開鍵を格納し、  
サーバーホスト上に置いてサーバーがクライアントからのアクセスを許可する際にも使用される。  

---

## 15 ×

/etc/ssh_known_hostsのパーミッションはどれが適切か？  

→  
なんか600って見えた気がしたので、rootのみが読み書きできるで。  

マージか。  
Cの「全てのユーザーがreadできる」が正解な模様。  

/etc/ssh_known_hostsファイルはすべてのユーザーが実行したssgコマンドが参照するファイルなので、全てのユーザーがreadできるパーミッションになっていないといけない。  
ファイルシステムなので、書き込みはできない。  

---

## 16 ○

rootがsshでログインできないようにするために、sshサーバーの設定ファイルのディレクティブの記述で正しいものはどれか？1つ。  

→  
しらねー。  
rootユーザーがsshコマンドを使ってサーバーにログインできないようにするってこと？  

Permitの問題なのだろうか。
でもPermitがない選択肢は1つで明らかにRootユーザーのログインを許可しているのでなし。
yes,noで選択するタイプの場合、否定のディレクティブをわざわざyesするなんて面倒な事はしないはずなので、B「PermitRootLogin no」で。  

当たったー。俺の推理も割といい線言ってるんだな。  

→

sshd_configの主なディレクティブ

- Port : 待機ポート番号  
- Protocol : プロトコルバージョン
- PermitRootLogin : rootログインを許可するかどうか
- PubkeyAuthentication : 公開鍵認証(プロトコルバージョン2)  
- AuthorizedKeysFile : ユーザー認証の公開鍵格納ファイル名  
- PasswordAuthentication : パスワード認証  

``` txt : sshd_configの抜粋
Port 22
Protocol 2
PermitRootLogin yes
PubkeyAuthentication yes
AuthorizedKeysFile .ssh/authorized_keys
PasswordAuthentication yes
```

---

## 17 ○

sshで外部サーバーへ接続する際に使用するオプションを編集するユーザーの設定ファイルは何ですか？  
ファイル名のみ。  

→  
`config`  

多分、.ssh/configのこと言ってるんだろうなぁと思って書いたら当たった。  

どうでもいいけど、PortとかHostとかの名前ってディレクティブっていうんですね。  
覚えておこう。  

---

## 18 ○

sshコマンドのオプションの説明で誤っているものはどれか？1つ。  

→  
-Pはポートではなく、プロトコルだったような？
ポートの指定は小文字のpだったような？
なのでB 「-Pでsshサーバーのポート番号を指定する」  

あたったぜー。  
-Pはscpコマンドで使うポート番号指定ディレクティブだって。  
-o Port = ポート番号でもいける見たい。  

---

## 19 ○

SSHが使用する認証用キーを生成するコマンドの名前を記述してください。  

→  
ssh-keygen?

---

## 20 ○

ユーザーyukoがホストexamhost上出ecdsa鍵を作成した。  
作成した鍵はexamhostからexamserverにログインする時に使用する。
examsercerにexamhostの鍵を登録するファイルはどれか？1つ。  

→  
やったようなやらなかったような。  

sshd_configは違う。  
id_ecdsaは作成した鍵そのもの。  
id_ecdsa.pubは公開鍵そのもの。  
消去法でB:authorized_keysしかない。  

---

## 21 ○

sshクライアントがsshサーバーに接続するときに、パスフレーズを入力することなくログインするために秘密鍵の管理を行うプログラムはどれか？1つ。  

→  
多分ssh-agent
scpはsshを使ったファイルコピーコマンド
sshdはsshを動かすデーモン
ssh-keygenは言わずもがな。

---

## 22 ×

/binディレクトリ内で、一般ユーザーが実行してもroot権限で実行されるファイルの一覧を表示したい場合、どのfingコマンドを実行すれば良いか？1つ。  

→  
あー。

find 対象ディレクトリ ユーザー 0はルート 権限 4000
D？

Aでした。
A : find /bin -uid 0 -perm /4000  
D : find /bin -user 0 -perm 4000  

---

## 23 △

現在のディレクトリ以下にあるシンボリックリンクファイルを探すコマンドはどれか？1つ。  

→  
sshの箇所は終わった感じかな。  
うーん。感じ的にD「find -type l」な気がするな。  

当たったけど、確信があったわけではないので要復習。

---

## 24 ×

CDROMを餡マウント使用としましたが、ビジーとなって餡マウント出来ませんでした。  
空欄にCDROMを使用しているプロセスを調べるコマンドを記述してください。  

`# ___ +f -- /dev/cdrom`  

→  
あー。わからん。  
プロセスならpsコマンドだけど、毎回ps auxで済ませるからなぁ。あれ？psって書くだけでいいんじゃないか？  

lsofだそうです。  
あれ？ポート番号調べるためのコマンドって習ったけど違うのか？  
まぁここはあまりやりこんでないから復習だな。  

---

## 25 △

GPG設定ファイルとキー・リングが保存されているユーザーホームの下のディレクトリはどこですか？1つ。  

→  
GnuPGのことだからgnupgかgpgか。  
とりあえず、B「~./gnupg」で。  
あたったー。要復習な。  

---

## 26 ○

GPGを使用して、公開鍵暗号により送信者がデータを暗号化する手順について1つ選択。  
送信者IDはryo@mylpic.com、受信者IDはyuko@mylpic.com、送信データファイルはsecret-document.txt。  

→  
gpg弱いから復習してみたけど、これはやってない。  
でも、よく見るとAしか無くないか？

A : `gpg --encrypt --recipient yuko@mylpic.com secret-document.txt`  
暗号化します。受取人はyukoで送るファイルはsecret-document.txtです。って言ってるわけでしょ？  

当たってた。  
でも、これを手入力しろって言われたらきついだろうな。  

---

## 27 ×

gpgコマンドを実行する際、ユーザーが鍵の管理に関連するタスクを対話的メニューでできるようにするには、どのオプションを指定すれば良いか？  

→  
何もオプションを指定しなければ対話モードになる。  
鍵を管理するプログラムはgpg-agentってのはさっきやったからわかるけど、オプションは知らんな。

`--edit-key`  
うん、知らないな。  
参考書でもやってない。わからんわ。  

---

## 28 ○

すべての一般ユーザーの対話的なログインを一時的に中止するファイルは何ですか？
`/etc/___`

→  
`nologin`だっけ？  
当たった。  

---

## 29 ×

lastコマンドが参照するファイルは何ですか？絶対パスで記述してください。  

→  
しらん。そもそもlastコマンドって何さ。  

`var/log/wtmp`  
うん。全く知らない。  

### lastコマンド  

システムのログイン履歴を一覧表示するコマンド  
ログイン記録`/var/log/wtmp`を参照して、ログイン履歴を表示する。  

last : 過去、最後  
lust : 強い欲望、切望、渇望、色欲、肉欲  

``` txt
last [オプション][ユーザー名][端末番号]

オプションたくさんあるけど、今はいいです。
必要になったらまとめます。
```

---

## 30 ×

一般ユーザーがwhoコマンドを実行したときに現在ログインしているユーザーの情報を表示しないようにしたい。  
ログインしているユーザーを記録しているファイル /var/run/____のパーミッションを一般ユーザーが読めないように変更する。  
ファイル名は？  

→  
知らん。ログインしてるから`login`で。

`utmp`  
うん。知らん。  

### wコマンド  

現在、システムに誰がログインしていて、何を実行しているのかを表示するコマンド。
`/var/log/wtmp`および`/proc`の情報を参照して表示する。  

``` txt
w [オプション][ユーザー名]

-h : ヘッダーを表示しない
-u : 現在のプロセス時間とCPU時間を計算する際に、ログイン名と現在のユーザー名の違いを無視する
-s : 短く表示する
-f : リモートホスト名を表示しない
```

### whoコマンド

システムに誰がログインしているかを表示するコマンド。  
`/var/run/utmp`ファイルを参照して表示する。

``` txt
who [オプション]

たくさんある。
```

---

## 31 ○

プログラムのリソース等を制限するコマンドは何か？  

→  
`change`?
いや違うな。changeはパスワードを変更したり、する奴だった気がする。警告出すやつだっけか？  
`ulimit`では？

当たったー。  
