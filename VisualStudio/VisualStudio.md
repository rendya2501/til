# VisualStudioメモ

---

## リビルドとクリーンの違い

### リビルド

①中間ファイルを削除しない。  
②プロジェクトを都度クリーンしてからビルドする。  

### クリーン

①中間ファイルも削除する  
②プロジェクトを全てクリーンする。  

### 「リビルド」 と 「クリーン+ビルド」

Clean Proj1 Clean Proj1  
Build Proj1 Clean Proj2  
Clean Proj2 Build Proj1  
Build Proj2 Build Proj2  
→  
プロジェクト間の依存関係が強い場合に影響する可能性があるかも。  
その場合、都度消すより全部消してからのほうが依存に煩わされることがないのかも。  

厳密に言うと、クリーン（中間ファイルと出力ファイルが削除されます）とは異なり、  
すべてをビルドして再コンパイルするだけですが、結果は同じです。  
ただし、失敗する場合もあります（Femarefのコメントを参照）。  
→  
まぁ、単純にいじってないやつも全部コンパイルしなおすって認識でいいのかもね。  

---

## 中間ファイル

コンパイラーなどがオブジェクトファイルを生成するために作成するファイルのこと。  
通常、コンパイル（変換）が終了すると自動的に削除される。  
→  
コンパイルが終わると自動的に削除されることを考えれば、あまり意識することはないのだろうけど、  
何かがあって、正常に消えない場合にクリーンする必要があるのかもしれない。  

---

## アタッチとデタッチ

2021/11/03 Wed 課題対応している時に、今まで普通に出来ていたデバッグが出来なくなった。  
fkdさんに相談したらアタッチだのデタッチだの言い始めてわけがわからなかったのでまとめる。  

仕組み的には、TSm_menuにExecuteModeなるものがあって、それで起動方法を切り替えているらしい。  
今までは、Test領域でしかデバッグしてなくて、今回始めてCime領域でやったらこうなった。  
TestとCimeで何が違うのか知らないが、データベースを確認したら0か1か思いっきり違うのは確認した。  
こういう仕組み系の話は結構疎いので、都度まとめないとやっていけない。  

まず前提として、クラスライブラリはエントリーポイントを持たない。  
exeのように自分で起動できない。  
他から起動される事前提なので、メインのプロセスに対してアタッチしないとデバッグ出来ないんだとか。  

### アタッチのやり方  

- メニューバーの「デバッグ」を選択。  
- 「プロセスにアタッチ」を選択。  
- たくさん出てくるので、アタッチしたいプロセスを選んで「アタッチ」ボタンを押す。  

開発中の話でいえば、タイトルが普通に表示されるので、それを選べば迷うことはない。  
PIDも表示されるので、タスクマネージャーと合わせて探してもいいんじゃないかな。  

[プロセスにアタッチ](https://qiita.com/lusf/items/d76a3e718f9b4403142f)  
[クラスライブラリ(DLL)プロジェクトのデバッグ方法](https://c-loft.com/blog/?p=1793)  

---

## VisualStudioでクラス図を出力する

[Microsoft公式](https://docs.microsoft.com/ja-jp/visualstudio/ide/class-designer/how-to-add-class-diagrams-to-projects?view=vs-2022)  
[VisualStudio2019でクラス図を作成する](https://sheepdogjam.cocolog-nifty.com/photos/uncategorized/classdiag20201220_04.png)  

### クラス デザイナー コンポーネントのインストール

1. メニュー バーから [ツール]>[ツールと機能を取得] を選択します。  
2. [個々のコンポーネント] タブを選択し、 [コード ツール] カテゴリまで下にスクロールします。  
3. [クラス デザイナー] 、 [変更] の順に選択します。  

### プロジェクトに空のクラス ダイアグラムを追加する

1. ソリューション エクスプローラーで、プロジェクト ノードを右クリックし、 [追加]>[新しい項目] の順に選択します。  
2. [共通項目]>[全般] の順に展開してから、テンプレートの一覧から [クラス ダイアグラム] を選択します。  
3. 作成したクラスダイアグラムを開いた状態でソリューションエクスプローラーからクラス等をドラッグ&ドロップするとクラス図が作成されます。  

---

## VisualStudioのソリューション

>ソリューションとプロジェクト  
Visual Studio のソリューションは、"解決策" ではありません。  
ソリューションは、1 つ以上の関連するプロジェクトを整理するために Visual Studio で使用される単なるコンテナーにすぎません。  
ソリューションを開くと、Visual Studio により、ソリューションに含まれるすべてのプロジェクトが自動的に読み込まれます。  
[プロジェクトとソリューションの概要](https://learn.microsoft.com/ja-jp/visualstudio/get-started/tutorial-projects-solutions?view=vs-2022)  

プロジェクトをまとめる単位。  
製品としてのまとまりって認識でよさそうだな。  

---

## クラスライブラリの発行

何も考えずに発行したら`.nupkg`が生成された。  
名前からしてNuGetのパッケージだと思われる。  

[C#でクラスライブラリを開発する時に必ずやった方が便利な設定](https://qiita.com/kojimadev/items/9d41e57da628dd74246d)  
