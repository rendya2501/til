# コンポーネントバインド

<!-- @update:modelValue="$emit('update:modelValue',{ ...this.modelValue, gender:$event})"
@update:modelValue="
        $emit('update:searchWord', { ...searchWord, gender: $event })
    "
-->

---

## OK 1 プロパティの直接変更

emitによる通知ではなく、プロパティを直接書き換えることで親の値が変わることを確認した。  
modelValueを実装しているのに直接書き換えるのは前提が違うので、うまく動作はするが到底OKは出せない。  

``` vue : 親 v-model="search"
<template>
    <div class="pointSet">
        <v-card class="cardWrap">
            <CardTitle title="ポイント一括登録" />
            <PointBulkSearchBox
                :admin="admin"
                :btn="btn"
                :search-word="search"
                @event="getMemberList"
            ></PointBulkSearchBox>
        </v-card>
    </div>
</template>
```

``` vue : 子 @update:modelValue="selectedGender = $event"
<template>
    <v-toolbar flat color="white">
        <span class="searchBoxLabel ml-7 mr-2">性別</span>
        <v-radio-group
            :modelValue="searchWord.gender"
            @update:modelValue="searchWord.gender = $event"
            inline
            class="status_radio float-right"
        >
            <v-radio label="男性" value="0" />
            <v-radio label="女性" value="1" />
            <v-radio label="指定なし" value="2" />
        </v-radio-group>
    </v-toolbar>
</template>
```

---

## OK 2 v-model modelValue

`props:modelValue`がなくても動くがF12ではエラーが発生しまくる。  
世間一般的にはこれが正しい実装の用だが、やることが多すぎる。  

``` vue : 親 v-model="search"
<template>
    <div class="pointSet">
        <v-card class="cardWrap">
            <CardTitle title="ポイント一括登録" />
            <PointBulkSearchBox
                v-model="search"
                :admin="admin"
                :btn="btn"
                :search-word="search"
                @event="getMemberList"
            ></PointBulkSearchBox>
        </v-card>
    </div>
</template>
```

``` vue
<template>
    <v-toolbar flat color="white">
        <span class="searchBoxLabel ml-7 mr-2">性別</span>
        <v-radio-group
            :modelValue="searchWord.gender"
            @update:modelValue="$emit('update:modelValue',{ ...modelValue, gender:$event})"
            inline
            class="status_radio float-right"
        >
            <v-radio label="男性" value="0" />
            <v-radio label="女性" value="1" />
            <v-radio label="指定なし" value="2" />
        </v-radio-group>
    </v-toolbar>
</template>

<script>
export default {
    props: {
        searchWord: {
            type: Object,
        },
        admin: {
            type: Object,
            default: () => ({
                user_id: '',
                user_div: '',
                golf_code: '',
            }),
        },
        btn: {
            type: Array,
            default: () => {},
        },
        modelValue: {
            type: Object,
        }
    },
    ...
}
</script>
```

---

## OK 3 @update

最終的にこれに落ち着いた。

``` vue : 親 @update
<template>
    <div class="pointSet">
        <v-card class="cardWrap">
            <CardTitle title="ポイント一括登録" />
            <PointBulkSearchBox
                :admin="admin"
                :btn="btn"
                :search-word="search"
                @event="getMemberList"
                @update:search-word="search = $event"
            ></PointBulkSearchBox>
        </v-card>
    </div>
</template>
```

``` vue : 子 @update:modelValue="$emit('update:selectedGender', $event)"
<template>
    <v-toolbar flat color="white">
        <span class="searchBoxLabel ml-7 mr-2">性別</span>
        <v-radio-group
            :modelValue="searchWord.gender"
            @update:modelValue="$emit('update:searchWord', { ...searchWord, gender: $event })"
            inline
            class="status_radio float-right"
        >
            <v-radio label="男性" value="0" />
            <v-radio label="女性" value="1" />
            <v-radio label="指定なし" value="2" />
        </v-radio-group>
    </v-toolbar>
</template>
```

---

emit update vue 3

[【Vue.js】$emitでObjectの一部だけ変更して更新する | TerryBlog](https://terrblog.com/%E3%80%90vue-js%E3%80%91emit%E3%81%A7object%E3%81%AE%E4%B8%80%E9%83%A8%E3%81%A0%E3%81%91%E5%A4%89%E6%9B%B4%E3%81%97%E3%81%A6%E6%9B%B4%E6%96%B0%E3%81%99%E3%82%8B/)  

[Vue3のv-modelショートハンドにいまいち慣れない](https://zenn.dev/miyanokomiya/articles/76bc7b48fbc614)  
