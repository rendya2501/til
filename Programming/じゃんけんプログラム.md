# じゃんけんプログラム

## 共通域の定義

``` C# : HandEnum
    public enum HandEnum
    {
        STONE = 0,
        SCISSORS = 1,
        PAPER = 2
    }
```

``` C# : HandDictionary
    public static class HandDictionary
    {
        public static readonly Dictionary<HandEnum, string> HandDict = new Dictionary<HandEnum, string>()
        {
            { HandEnum.STONE,  "グー" },
            { HandEnum.SCISSORS, "チョキ" },
            { HandEnum.PAPER,  "パー" }
        };
    }
```

## 構造化プログラミング版

``` C#
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace janken
{
    /// <summary>
    /// 構造化プログラミング版じゃんけん
    /// </summary>
    public class StructuredJanken
    {
        private int Player1WonCount { get; set; }
        private int Player2WonCount { get; set; }

        public void Execute()
        {
            Console.WriteLine("【じゃんけん開始】" + Environment.NewLine);

            for (int i = 0; i < 3; i++)
            {
                Console.WriteLine($"【{i:D}回戦目】");
                // 手を決める
                HandEnum Player1Hand = GetHand();
                HandEnum Player2Hand = GetHand();
                // 判定
                JudgAndCount(Player1Hand, Player2Hand);
            }

            Console.WriteLine("【じゃんけん終了】" + Environment.NewLine);

            // 最終判定
            LastJudg();
        }


        public HandEnum GetHand()
        {
            int randNum = new Random().Next(0, 2);
            switch (randNum)
            {
                case 0:
                    System.Console.WriteLine("グー");
                    return HandEnum.STONE;
                case 1:
                    System.Console.WriteLine("チョキ");
                    return HandEnum.SCISSORS;
                case 2:
                    System.Console.WriteLine("パー");
                    return HandEnum.PAPER;
            }
            return HandEnum.STONE;
        }

        private void JudgAndCount(HandEnum player1, HandEnum player2)
        {
            // P1が勝つ手
            if ((player1 == HandEnum.STONE && player2 == HandEnum.SCISSORS)
                || (player1 == HandEnum.SCISSORS && player2 == HandEnum.PAPER)
                || (player1 == HandEnum.PAPER && player2 == HandEnum.STONE)
                )
            {
                this.Player1WonCount++;
                Console.WriteLine("プレイヤー1が勝ちました。" + Environment.NewLine);
                Console.WriteLine("プレイヤー1が勝ちました。" + Environment.NewLine);
            }
            // P2が勝つ手
            else if ((player2 == HandEnum.STONE && player1 == HandEnum.SCISSORS)
                || (player2 == HandEnum.SCISSORS && player1 == HandEnum.PAPER)
                || (player2 == HandEnum.PAPER && player1 == HandEnum.STONE)
                )
            {
                this.Player2WonCount++;
                Console.WriteLine("プレイヤー2が勝ちました。" + Environment.NewLine);
            }
            // 引き分け
            else
            {
                Console.WriteLine("引き分けです。" + Environment.NewLine);
            }
        }

        private void LastJudg()
        {
            // P1の勝ち
            if (Player1WonCount > Player2WonCount)
            {
                Console.WriteLine($"{Player1WonCount}対{Player2WonCount}でプレイヤー1の勝ちです。");
            }
            // P2の勝ち
            else if (Player1WonCount < Player2WonCount)
            {
                Console.WriteLine($"{Player1WonCount}対{Player2WonCount}でプレイヤー2の勝ちです。");
            }
            // 引き分け
            else
            {
                Console.WriteLine($"{Player1WonCount}対{Player2WonCount}で引き分けです。" + Environment.NewLine);
            }
        }
    }
}
```

---

## オブジェクト指向プログラミング版

``` C#
using System;
using System.Linq;

namespace janken
{

    /// <summary>
    /// オブジェクト指向プログラミング版じゃんけん
    /// </summary>
    public class ObjectiveJanken
    {
        public void Execute()
        {
            // 審判もプレーヤーも知っている事ならさらに上に出さないといけないのでやっぱりEnum参照が正解だ。
            // プレーヤーだけに定義すべきモノではない。
            Judge judge = new Judge();
            Player player1 = new Player("村田さん");
            Player player2 = new Player("山田さん");
            judge.StartJanken(player1, player2);
            Console.ReadLine();
        }

        /// <summary>
        /// じゃんけんの判定を表すクラス
        /// </summary>
        private class Judge
        {
            private static Random random = new Random();

            /// <summary>
            /// じゃんけんを開始する
            /// </summary>
            /// <param name="player1"></param>
            /// <param name="player2"></param>
            public void StartJanken(Player player1, Player player2)
            {
                Console.WriteLine("【じゃんけん開始】" + Environment.NewLine);

                for (int i = 0; i < 3; i++)
                {
                    Console.WriteLine($"【{i + 1:D} 回戦目】");
                    Player winner = JudgeJanken(player1, player2);
                    if (winner != null)
                    {
                        Console.WriteLine($"{winner.Name}が勝ちました。" + Environment.NewLine);
                        winner.NotifyResult(true);
                    }
                    else
                    {
                        Console.WriteLine("引き分けです。" + Environment.NewLine);
                    }
                }

                Console.WriteLine("【じゃんけん終了】" + Environment.NewLine);

                Player finalWinner = JudgeFinalWinner(player1, player2);
                if (finalWinner != null)
                {
                    Console.WriteLine($"{finalWinner.Name}の勝ちです。" + Environment.NewLine);
                }
                else
                {
                    Console.WriteLine("引き分けです。" + Environment.NewLine);
                }
            }

            /// <summary>
            /// 「じゃんけんポン」と声をかけ、プレイヤーの手を見て、どちらが勝ちかを判定する。
            /// </summary>
            /// <param name="player1"></param>
            /// <param name="player2"></param>
            /// <returns></returns>
            private Player JudgeJanken(Player player1, Player player2)
            {
                HandEnum player1hand = player1.ShowHand(new Random(random.Next()));
                HandEnum player2hand = player2.ShowHand(new Random(random.Next()));
                Console.WriteLine($"{HandDictionary.HandDict.FirstOrDefault(f => f.Key == player1hand).Value} vs. {HandDictionary.HandDict.FirstOrDefault(f => f.Key == player2hand).Value}");

                Player winner = null;
                if ((player1hand == HandEnum.STONE && player2hand == HandEnum.SCISSORS)
                    || (player1hand == HandEnum.SCISSORS && player2hand == HandEnum.PAPER)
                    || (player1hand == HandEnum.PAPER && player2hand == HandEnum.STONE))
                {
                    winner = player1;
                }
                else if ((player1hand == HandEnum.STONE && player2hand == HandEnum.PAPER)
                    || (player1hand == HandEnum.SCISSORS && player2hand == HandEnum.STONE)
                    || (player1hand == HandEnum.PAPER && player2hand == HandEnum.SCISSORS))
                {
                    winner = player2;
                }

                return winner;
            }

            /// <summary>
            /// 
            /// </summary>
            /// <param name="player1"></param>
            /// <param name="player2"></param>
            /// <returns></returns>
            private Player JudgeFinalWinner(Player player1, Player player2)
            {
                Player winner = null;
                if (player1.WinCount > player2.WinCount)
                {
                    winner = player1;
                }
                else if (player1.WinCount < player2.WinCount)
                {
                    winner = player2;
                }
                return winner;
            }
        }

        /// <summary>
        /// じゃんけんプレーヤークラス
        /// </summary>
        private class Player
        {
            public string Name { get; private set; }
            public int WinCount { get; private set; } = 0;

            /// <summary>
            /// コンストラクタ
            /// </summary>
            /// <param name="Name"></param>
            public Player(string Name)
            {
                this.Name = Name;
            }

            /// <summary>
            /// じゃんけんの手を出す
            /// </summary>
            /// <returns></returns>
            public HandEnum ShowHand(Random rand)
            {
                HandEnum hand = 0;
                switch (rand.Next(3))
                {
                    case 0:
                        hand = HandEnum.STONE;
                        break;
                    case 1:
                        hand = HandEnum.SCISSORS;
                        break;
                    case 2:
                        hand = HandEnum.PAPER;
                        break;
                }
                return hand;
            }

            /// <summary>
            /// 審判から勝敗を聞く
            /// </summary>
            /// <param name="result"></param>
            public void NotifyResult(bool result)
            {
                if (result)
                {
                    WinCount++;
                }
            }
        }
    }
}
```
