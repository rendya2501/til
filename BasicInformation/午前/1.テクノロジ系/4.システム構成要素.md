# システム構成要素

---

## システムの構成

### クライアントサーバシステム(client-server system:C/S)

サービスを要求する側であるクライアントと、サービスを提供するサーバに分離したコンピュータネットワークの形態です。  
3層クライアントサーバシステムでは、ユーザの入出力を担当する「プレゼンテーション層」、業務処理に依存するデータ加工を行う「ファンクション層」、  
データベース処理を行う「データ層」の3層に分離したモデルです。  

![!](https://www.ap-siken.com/kakomon/28_haru/img/12.gif)  

・プレゼンテーション層 : Webブラウザ  
・ファンクション層 : Webサーバ  
・データ層 : DBMSとデータベース  

一般にWeb3層クライアントシステムは、上記3つの組合せで構成され、それぞれの層に伝達しながら処理が行われます。  
ブラウザは利用者の入力をサーバに送信する(HTTP要求)。  
WebサーバではHTTP要求を処理し、データの読み書きをデータベース(DBMS)に要求する。  
DBMSはデータベースにアクセスし、結果をWebサーバに返す。  
WebサーバではDBMSから得られた結果に応じてHTMLページを構成し、付加情報とともにクライアントに返信する(HTTP応答)。  
ブラウザはWebサーバからのHTTP応答を解釈し、結果を画面に出力する。  

### Webサーバ

ブラウザとDBサーバの間にたち、ブラウザから受け取ったリクエストを基に組み立てたSQL文でDBサーバに問合せを行い、DBから返された結果をHTML文書に加工してブラウザに返す役割をもっています。  
HTTPリクエストを解釈し、Webブラウザに結果を返す。動的な処理の場合、APサーバに処理を依頼する。  

![!](https://www.ap-siken.com/kakomon/28_aki/img/12.gif)  

### APサーバ

Webサーバから受け付けたリクエストをプログラムで処理し、結果をWebサーバに返す。

### WebサーバーとAPサーバーで処理を分担する目的

負荷軽減が目的。
負荷が軽い静的コンテンツへのリクエストはWebサーバで処理し，負荷が重い動的コンテンツへのリクエストはAPサーバで処理するように，
クライアントからのリクエストの種類に応じて処理を分担できるため。
静的コンテンツ(静的HTMLや画像など)はWebサーバ、動的コンテンツ(CGIプログラムなど)はAPサーバ、
というように別々の物理サーバで処理されることになるので、同一の物理サーバに配置するよりも処理負荷の低減を期待できます。

### 2層クライアントサーバシステム

クライアント側がユーザへの入出力とデータ加工(ビジネスロジック)を担当し、クライアントからデータベースに直接接続する形態。

### 3層クライアントサーバシステム

2層ではクライアントが担当していたデータ加工の機能を独立させ、プレゼンテーション層・アプリケーション層・データ層の3層に分離した形態。

### サーバの処理能力

![!](https://www.ap-siken.com/kakomon/03_aki/img/12.gif)  

#### スケールアップ

サーバを構成する各処理装置をより性能の高いものに交換したり、プロセッサの数などを増やすことでサーバ当たりの処理能力を向上させる。  
追加・削除・更新処理が頻繁に発生するなど、並列実行による負荷分散が困難なシステムに適している。  

#### スケールアウト

接続されるサーバの台数を増やすことでサーバシステム全体としての処理能力や可用性を向上させる。  
同等の性能アップであればスケールアップよりも低コストであることが多い。  

更新処理(追加と削除も含む)を伴う機能を複数のサーバに負荷分散すると、整合性維持のための処理や排他制御による遅延が生じ、効果的な性能向上に繋がりません。  
このため更新処理がメインのシステムにはスケールアウトは不向きです。  
スケールアウトが適するのは、更新処理の整合性要件が緩い、かつ、個々に独立し並列実行が可能な処理を扱うシステムです。  

#### スケールイン

システムを構成する物理サーバの台数を減らすことによって，システムとしてのリソースを最適化し，無駄なコストを削減する。  

#### スケールダウン

低い処理能力のCPUへの交換やメモリの削減などによって，システムとしてのリソースを最適化し，無駄なコストを削減する。  

### フールプルーフ(fool proof)

利用者が誤った操作をしても，システムに異常が起こらないようにする。  
不特定多数の人が操作するシステムに、入力データのチェックやエラーメッセージの表示などの機能を加えることで、人為的ミスによるシステムの誤動作を防ぐように設計する考え方です。  

#### インタロック

特定の条件を満たさない限り、機械が作動しないようにする機構です。  
機械が動作しているときにガードを開くと機械が停止したり、ガードの中に人間がいるときには機械の運転ができないようにしたりすることで未然に危険を回避します。  

例)
・動作中の機械から一定の範囲内に人間が立ち入ったことをセンサが感知したとき，機械の動作を停止させる仕組み  

### フェールソフト

縮退運転。  
装置が故障したときは，利用できる機能を制限したり，処理能力を低下させたりしても，システムは稼働させる。  

障害が発生した時に、多少のシステム性能低下を許容し、システム全体の運転継続に必要な機能を維持させようとする考え方です。  
フェールソフトを実践する対応としてフォールバック(縮退運転)やフェールオーバがあります。  

![!](https://www.ap-siken.com/kakomon/30_haru/img/15.gif)  

### フェールセーフ

装置が故障したときは，システムが安全に停止するようにして，被害を最小限に抑える。
システムの不具合や故障が発生したときに、障害の影響範囲を最小限にとどめ、常に安全を最優先にして制御を行う考え方です。

例)
・工業用機械で進入禁止区域をセンサーで監視し、人や物の侵入を感知したときには機械を緊急停止する。  
・信号機が故障したときは交差点内の全ての信号機を赤にする  
・ある条件下では，特定の人間だけが，システムを利用することを可能にする仕組み  

### フェールオーバ

障害発生時に主系から予備系への引き継ぎを**自動的、かつ継ぎ目なし**に行う機能で、HAクラスタなどの高信頼性が要求されるシステムに実装されています。  
このようなシステムでは主系と予備系の間で「ハートビート」と呼ばれる主系の状態を監視するためのパケットが定期的にやり取りされます。  
予備系はハートビートの受信が途絶えると主系に障害が発生したと判断し、**自律的に**主系の処理や設定を引き継ぎ、新たな主系として稼働を始めます。  
このように障害が発生した場合にも利用者に気付かれることなく処理の継続ができることで信頼性が向上します。  

### フォールトトレラント

装置が故障しても，システム全体の機能に影響がないように，二重化などの冗長な構成とする。
システムの一部に障害が発生しても全体としては停止することなく稼働を続け、その間に復旧を図るような設計となっているシステムです。
これを実現するには各機器を最低でも二重構成にし、障害発生時には機器の切替えを即座に行えるように設計されていることが必須条件となります。
フォルト（英: fault）：短所や欠陥のこと。
トレラント：「寛容（耐性のある）」という意味です。

例)  
・ある機械が故障したとき，それを停止させて代替の機械に自動的に切り替える仕組み  

### フォールトアボイダンス

品質の高い製品を使うようにして、そもそも故障が起こらないようにする。  

システムを構成する機器に信頼性(稼働率)の高いものを使用することで、故障そのものを排除しようとする設計手法です。  
これに対してフォールトトレラントは、障害が発生した時に必要な機能を提供し続けること(耐故障)を目指す設計手法です。  

### フォールトマスキング

故障が発生したときに，その影響が誤りとなって外部に出ないように訂正すること。  

### RAID(Redundant Arrays of Independent Disks)

複数台の磁気ディスクを組み合わせ、仮想的な1台の記憶装置として運用することで、全体として高い性能を得る技術です。
RAIDには0～5のレベルがありますが、その区別は本来のデータとエラー訂正用のデータ（ハミング符号・パリティビット）を、どのように書き込むかによって定義されています。

#### RAID0(ストライピング)

複数のディスクに分散してデータを書き込むことで、アクセス性能を向上させる。

#### RAID1(ミラーリング)

同じデータを2台のディスクに書き込むことで、信頼性を向上させる。実質記憶容量は50%となるので記憶効率は悪い。

#### RAID2

複数の磁気ディスクに分散してビット単位でデータを書き込み，さらに，複数の磁気ディスクにエラー訂正符号(ECC)を書き込む。
データにエラー訂正用のハミング符号を付加したものをストライピングで書き込む。

#### RAID3

複数の磁気ディスクに分散してバイト単位でデータを書き込み，さらに，1台の磁気ディスクにパリティを書き込む。
データのエラー訂正用にパリティビットを使用し、一つのディスクをエラー訂正符号の書き込み専用とする。

#### RAID4

RAID3とほぼ同じ。RAID3でビット/バイト単位だったストライピングをブロック単位で行う。

#### RAID5

情報データとともにパリティビットも各ディスクに分散して書き込む方式。信頼性、アクセス性能が共に高まる。

ストライピング単位
      読書単位  誤り訂正方式   誤り訂正符号格納場所
RAID2 ビット    ハミング符号   1台のディスク
RAID3 ﾋﾞｯﾄ/ﾊﾞｲﾄ パリティビット 1台のディスク
RAID4 ブロック  パリティビット 1台のディスク
RAID5 ブロック  パリティビット 複数台に分散

ストライピングという言葉に意味はなく、単純にRAID0の別名みたいだ。
RAID0がストライピングであり、ストライピングといったらRAID0の関係らしい。
因みに、分散してデータを書き込むと速度が早くなるらしいが、
これは両手にペンを持って10までの数字を右のノートは偶数、左のノートには奇数を書くイメージをいいかも？
両方に同時に書き込むので、1から順番に1冊のノートに書きこむよりも早く書き込める。
正し、どちらか一方が死んだ途端、意味をなさなくなるので信頼性は低いというわけだ。

### ストライピング

データを細分化して複数台の磁気ディスクに格納すること。  
性能向上を目的とした「RAID0」に相当し、各データディスクに並列にアクセスを行うことで読み書き速度の向上が望めます。  

### ミラーリング

ミラーリングは、RAID1に相当し、2台のディスクに同じデータを書き込む方式です。片方のディスクに障害が起きても復旧が可能なのでディスクの信頼性が向上します。  

### ブロック化

ブロック化は、複数のレコードを一定数ごとにまとめることです。1レコードごと読み書きするよりも、ブロック単位でアクセスすることで処理効率を向上させます。  

### スワッピング

なんらかの理由で主記憶上にあるプログラムが長時間待ち状態になっている場合に、そのプログラムを実行中のまま補助記憶上のスワップと呼ばれる場所に退避し、  
他のプログラムを主記憶にロードすることで中記憶の効率的な利用を行う手法です。  

### デュアルシステム

一つの処理を2系統のシステムで独立に行い，結果を照合する方式である。
信頼化設計の1つで、同じ処理を2組のコンピュータシステムで行い、その結果を照合機でチェックしながら処理を進行していくシステム構成です。
一方の系統に障害が発生した場合には、問題のある側のシステムをメイン処理から切り離し、残された側のシステムのみで処理を続行しつつ、障害からの回復を図ります。
「結果の照合」という語句がデュアルシステムのキーワードになります。

### 負荷分散システム

2系統のシステムの負荷が均等になるように，処理を分散する方式である。

### 並列処理システム

2系統のシステムで並列処理をすることによって性能を上げる方式である。

### デュプレックスシステム

現用系と待機系の2系統のシステムで構成され，現用系に障害が生じたときに，待機系が処理を受け継ぐ方式である。
現用（本番）系と待機（予備）系の2系統で構成されるデュプレックスシステムは、待機系の待機状態と、障害発生時のシステム切替えに要する時間を基準にして3つに分類できます。

### ホットスタンバイ

現用（本番）系と同様のシステムを最初から起動しておく方式。障害発生時には自動的に処理を引き継ぎ、業務を継続する。3つの中では切替えに要する時間が最も短い。
「即座」「あらかじめ起動して待機」という文言があれば、ホットスタンバイが当てはまる。

### ウォームスタンバイ

コンピュータの電源を入れ OS を立ち上げておくが、業務システムは起動させない状態で待機させておく方式。
待機時には主系のデータベースとの同期だけを行い、障害が発生してから待機系のデータベースシステムに切り替えて処理を引き継ぐ。

### コールドスタンバイ

待機時には予備系で別の処理を行わせておく方式、または予備系の電源を切った状態で待機させておく方式。
障害発生時はシステムを再起動し、業務システムを立ち上げて処理の引継ぎを行う。3つの中では切替えに要する時間が最も長い。

非常事態の発生時に備えるバックアップサイトの設置形態には、ホットサイト、ウォームサイト、コールドサイトがあります。

### ホットサイト

障害発生時にできるだけ短時間にサービスが再開できるように日常から本システムと同じものを稼働させておき、非常事態が起きたときにすばやく業務を引き継ぐ方式。
常に本システムのデータとの同期が行われており、障害発生時に直ぐにその施設でシステムを運用できる体制になっている。

### ウォームサイト

施設内に本システムと同じものを全部(あるいは部分的に)設置しておくが、業務システムを起動させない状態で待機させておく方式。
障害発生後に追加の機器やデータおよびプログラム媒体を搬入してから予備系システムを立ち上げて処理を引き継ぐ。

### コールドサイト

コンピュータシステムを設置できる施設だけを確保しておき、障害発生時にはそこに機材などを搬入してバックアップセンタとして機能させる方式。
障害発生後にシステムの導入とデータの復旧を行って業務を引き継ぐ。

### クラウドサービス

提供されるサービスによってSaaS、PaaS、IaaSに大別されます。

### SaaS (Software as a Service)

サービス提供事業者はアプリケーション以下を提供する。利用者は機能を使い、アプリケーションにおける設定可能範囲内でカスタマイズが可能。

### PaaS (Platform as a Service)

サービス提供事業者は開発環境などのミドルウェア以下を提供する。利用者は用意したアプリケーションをミドルウェア上で稼働させる。
ミドルウェアにおける設定(カスタマイズ)が可能。
アプリケーション開発／動作のための基盤がサービスの形で提供されます。OSおよび提供されるプラットフォームの保守はサービス提供者側で行われます。

### IaaS (Infrastructure as a Service)

1.サービス提供事業者はOS以下を提供する。利用者はミドルウェア以上を自前で用意し、OSにおける設定(カスタマイズ)が可能。
2.サービス提供事業者はハードウェアおよびネットワークを提供する。利用者はOS以上を用意する。

### クラスタシステム

クラスタシステムのうち、高可用性を実現するものを「HA(High Availability)クラスタ」といいます。  
通常、HAクラスタは正常時に稼働を行う**主系**と障害発生時に処理を引き継ぐ**予備系**の二重構成をとることで耐障害性を高めています。  

#### 平成27年秋期 午前問12  

クラスタリングシステムで，ノード障害が発生したときに信頼性を向上させる機能のうち，適切なものはどれか。  
→  
障害ノードを排除して代替ノードでアプリケーションを実行させるフェールオーバ機能が働く。  

※アプリケーションを代替ノードに転送して実行するためのホットプラグ機能が働く。  
→  
ホットプラグ(ホットスワップ)は、コンピュータの電源が入っている状態で周辺機器の脱着を行える仕組みです。  
手動でシステムの切り替えを行う場合には停止時間の短縮に寄与します。  

### クラスタリング方式

OS，アプリケーション及びハードウェアの障害に対応し，障害時に障害が発生していないサーバに自動的に処理を引き継ぐので，切替え時間の短い安定した運用が求められる場合に有効である。  
仮想サーバの冗長化設計における可用性評価。  

#### 負荷分散クラスタ

処理を複数のサーバに分散することで、各サーバに掛かる負荷を低減させることを目的としたクラスタ構成。高い処理能力が求められるシステムでよく利用される。  

#### HAクラスタ構成

障害発生時も正常時と同様の処理を継続することを目的としたシステム。  
信頼性が要求されるシステムでよく利用される。  

**ホットスタンバイ形式**
待機系サーバとして同一仕様のサーバが必要になるが，障害発生時には待機系サーバに処理を引き継ぐので，障害が発生してもスループットを維持することができる。  

**負荷分散構成**
稼働している複数のサーバ間で処理の整合性を取らなければならないので，データベースを共有する必要がある。  
ホットスタンバイ方式では両方のシステムが同時稼働しないため、処理の整合性をとる必要はありません。  

処理を均等にサーバに分散できるので，サーバマシンが有効に活用でき，将来の処理量の増大に対して拡張性が確保できる。  
ホットスタンバイ方式では予備系に処理を分散しません。  

障害が発生すると稼働中の他のサーバに処理を分散させるので，稼働中のサーバの負荷が高くなり，スループットが低下する。  
ホットスタンバイ方式では同等の性能をもつ予備系が処理を引き継ぐため処理性能は低下しません。  

例)  
仮想化マシン環境を物理マシン20台で運用しているシステムがある。次の運用条件のとき，物理マシンが最低何台停止すると縮退運転になるか。

〔運用条件〕
物理マシンが停止すると，そこで稼働していた仮想マシンは他の全ての物理マシンで均等に稼働させ，使用していた資源も同様に配分する。
物理マシンが20台のときに使用する資源は，全ての物理マシンにおいて70%である。
1台の物理マシンで使用している資源が90%を超えた場合，システム全体が縮退運転となる。
(1)～(3)以外の条件は考慮しなくてよい。

→

20台の物理マシン上でそれぞれ70%の資源が使用されているので、システムが稼働するために必要となる総資源量は、

　20台×70%＝1,400(%)

物理マシン1台の資源量を基準とすると1,400%(物理マシン14台分の資源)になります。x台の物理マシンが停止したとき、この資源量は残りの物理マシン数「20－x台」に均等に割り振られることになるので、各マシンの資源使用率を90%以下にするには、

　1,400÷(20－x)≦90
　1,400≦90(20－x)
　1,400≦1,800－90x
　90x≦400
　x≦4.444…(台)

最大で4台までの停止が許容できることになります。したがって物理マシンの資源使用率が90%を超え、縮退運転に移行するのは停止台数が5台になった時点です。

→

朝はわからなかったのに、夜になって見返して見たらすんなりわかった。
20台で70%なら全部で1400%の仕事をしている。それをx台で割ったとき0.9になればいいんだから～ってのが発想だ。
若干違ってはいるが、それっぽい回答になったのでまぁ、いいだろう。

### 分散システムにおけるアクセス透過性

地理的に離れた場所にあるシステムにアクセスするときに、そのシステムが遠隔地にあることを意識することなく同一の方法でアクセスできる性質です。  

アクセス透過性
遠隔地の資源にアクセスする際に、同一の方法でアクセスできること
移動透過性
使用中の資源の位置を移動できること
位置透過性
遠隔地の資源にアクセスする際に、データの位置を意識せずにアクセスできること
規模透過性
OSやアプリケーションの構成に影響を与えずにシステムの規模を変更できること
障害透過性
システムや資源の一部の障害によりシステム全体の機能が停止し，処理が中断されることがないこと
複製透過性
資源が複数の位置に複製され配置される場合でも、利用者にはそれらが1つの資源として見えること
並行透過性
複数のプロセスを並行処理できること

### 仮想化アーキテクチャ

![!](https://www.ap-siken.com/kakomon/03_aki/img/14.gif)  

#### ハイパバイザ型

サーバで仮想化ソフトウェアを動かし，その上で複数のゲストOSを稼働させるので，サーバのOSとは異なるOSも稼働できる。  

ハードウェア上で直接稼働し仮想マシンの土台となるミドルウェアです。  
仮想マシン環境を実現する方式には、ハイパバイザ型、ホストOS型及びコンテナ型があります。  
ホストOS型とコンテナ型はハードウェアの上層にホストOSが稼働し、その上に仮想化レイヤが位置しますが、ハイパバイザ型はホストOSを必要とせずハードウェアの上層に仮想化レイヤが位置するという違いがあります。  
ハイパバイザでは仮想化機能の実現に特化したカーネルが稼働しています。  

vSphere  

#### ホストOS型

ホストOSで仮想化ソフトウェアを動かし，その上で複数のゲストOSを稼働させるので，物理サーバヘアクセスするにはホストOSを経由する必要がある。  

VMWare  

#### コンテナ型

コンテナ型は、ホストOS上にコンテナという互いに独立した空間を用意し、その空間上でライブラリやアプリケーションを動かす仕組みです。  
ゲストOSを起動する必要がないため低リソースで仮想化環境を構築することができます。  
しかし、ホストOSとは別のOSの仮想環境を構築することができないという制約もあります。  

※アプリケーションの起動に必要なプログラムやライブラリなどをまとめ，ホストOSで動作させるので，独立性を保ちながら複数のアプリケーションを稼働できる。  

Docker  

### モノリシックカーネル

モノリシックカーネルは、カーネル自体に多機能を持たせるアーキテクチャです。  
(カーネルとはOSプログラムの中核を担う部分のことです)  

### シストリックアレイ

シストリックアレイは、多数のプロセッサとバッファの組をマトリクス上に結合して構築される並列計算機のアーキテクチャです。  
個々のプロセッサの演算結果をレジスタに書き戻さず、次の演算の入力として隣のプロセッサへそのまま渡すことで、シンプルな回路設計、高い電力効率、高い演算性能を実現します。  

### グリッドコンピューティング

インターネットなどのネットワーク上にある計算資源（CPUなどの計算能力や、ハードディスクなどの情報格納領域）を結びつけ、ひとつの複合したコンピュータシステムとしてサービスを提供する仕組みです。  
統合されるコンピュータ数によっては、スーパーコンピュータ並まで処理性能を高めることも可能となります。  

### 密結合マルチプロセッサシステム

複数のCPUが1つの主記憶を共有し、単一のOSで制御されるマルチプロセッサシステムです。  

このシステムでは複数のCPUで主記憶を共有するため、並列処理の過程で複数のCPUが同一のメモリ領域にアクセスすると、競合によりアクセス遅延が生じます。  
プロセッサ数が増えるとメモリアクセスの競合が発生する数も増加するので、プロセッサ数を増やしていっても処理性能の向上は頭打ちになります。  
またメモリと各CPUの間の転送能力もシステム全体のボトルネックとなり得ます。  

したがって、密結合マルチプロセッサシステムにおいて性能向上を阻む要因となるのは「主記憶へのアクセスの競合」になります。  

### サーバコンソリデーション

仮想化技術を用いることで、複数の専用サーバに分散・非効率化していたアプリケーションや機能を1台(または少数)の物理サーバに整理統合することです。  
物理サーバの台数が減るので、保守費用、消費電力、設置スペースなどの維持管理コストの削減を図ることができます。  

コンソリデーション(consolidation)は、統合、統一、合併、整理などの意味を持つ言葉です。  

### シンプロビジョニング(Thin Provisioning)

ハードディスク装置などの外部記憶装置(ストレージ)群を仮想化することで、物理的な記憶容量より多くの容量を利用者に割り当てることを可能にする仕組みです。  

利用者の要求する記憶容量を最初から物理ディスク容量として割り当てると、未使用の物理ディスク領域が多くなり無駄が生じます。  
シンプロビジョニング機能が導入されたストレージでは、利用者の要求に応じて今後使用する予定の最大容量を割り当てておいて、実際の内部では使った分だけの物理容量を割り当てるということを行います。  

例えば利用者の要求容量が10TBで実使用量が2TBの場合、10TBの物理ディスク容量を割り当てた場合では8TBの無駄が生じますが、仮想ボリュームとして10TBを割り当てた場合では使用する物理ディスク容量は2TBで済み、  
さらに同様の利用者4名分のデータ(8TB)を保存することができるため物理ディスクの効率的な利用ができるというわけです。  

![!](https://www.ap-siken.com/kakomon/30_aki/img/11.gif)  

### リソースオンデマンド

利用者の要求に応じてリソースを動的に割り当てたり，不要になったリソースを回収して別の利用者のために移し替えたりする技術である。  

### ライブマイグレーション(Live Migration)

ある物理サーバ上で稼働している仮想マシンを、OSやソフトウェアを停止させることなく別の物理サーバに移し替え、処理を継続させる技術です。  
切り替えによるダウンタイムはほとんどゼロで、移動前の処理やセッションが全て引き継がれるため可用性を損なうことがありません。  

"Migration"には「移動」や「移住」などの意味があり、"live"は「生で」「生の」と訳されるので、  
2つを繋げた"Live Migration"は、アプリケーションを実行状態のまま移動させる技術ということを表しています。  

![!](https://www.ap-siken.com/kakomon/30_aki/img/12.gif)  

### シンクライアント

ユーザが使用する端末にデータやアプリケーションを持たせず、サーバに接続するための必要最小限のネットワーク機能や入出力用のGUIだけを装備させ、  
サーバ側で必要なデータ処理をするものを指します。シン（Thin）とは「薄い、少ない」の意味です。  

シンクライアントシステムには、リモートアクセス型、ネットワーク型、画面転送型など様々な方式がありますが、  
いずれも端末にデータやアプリケーションを持たせないため、情報漏えいに対するセキュリティ対策になるほか、  
ファイルのバックアップ、OSやアプリケーションプログラムのアップデート（セキュリティホール対策版への更新）、ウィルススキャン、暗号化など、  
日常の運用をサーバ側で集中管理できる利点があります。  

シンクライアント端末はデータとアプリケーションを持ちません。  

### CDN(Contents Delivery Network)

主にWebシステムにおけるコンテンツ配信の高速化・効率化を目指して最適化された配信インフラのことです。  
CDNは、キャッシュサーバの活用やトラフィック分散、ルーティングの工夫でネットワーク負荷を低減し、ユーザにより速くコンテンツを届けられるように構築されています。  
ノードとなるサーバは、様々な地域に設置されており、ユーザからのリクエストに応じて、迅速かつ効率的な配信が行われるよう機能しています。  
CDNは、Webサイトだけでなく、音楽や動画(ストリーミングを含む)などのマルチメディアコンテンツ、大容量データの配信を安定的に配信する手段として用いられています。  

### モニタリング

監視・計測用のプログラムを用いてシステムの稼働状態や資源の状況を測定し、システム構成や応答性能のデータを得る手法です。  
得られたデータをもとに性能評価やボトルネックの発見などを行い改善に繋げます。  
モニタリングツールは、ソフトウェアモニタとハードウェアモニタに大別されます。  

---

## システムの評価指標

### スループット(Throughput)

システムが単位時間当たりに処理できる仕事量を表す指標で、利用者側から見た、システム性能の評価基準となります。  
データ処理におけるスループットには、コンピュータに搭載されるCPUのクロック周波数やハードディスクの回転速度、OSなど、様々な要因が影響し、システムのパフォーマンスの評価基準となります。  

処理が遅いプリンタの出力に合わせてCPUがデータ転送処理を行うと、CPUに遊休時間が生じてしまいます。  
そこで一度出力データを補助記憶装置へ転送し、補助記憶装置からプリンタにデータを転送することで、CPUは即座に次の処理にうつることができます。(スプーリング処理)これによってCPUの空き時間が減少し、有効に使うことができるのでスループットは向上が見込めます。  

「スプーリングはスループットを向上させる。」は、情報処理技術者試験の各区分で繰り返し出題されている定番中の定番問題です。  
覚えておきましょう。  

### 応答時間

利用者がシステムへの処理要求を全て完了した時点から、システムが最初の反応を返すまでの時間のことです。  
レスポンスタイムとも言います。  

### ターンアラウンドタイム

利用者がシステムへの処理要求を開始した時点から、すべての応答出力を受け取るまでの時間のことです。

``` txt
ターンアラウンド|--------------|
  レスポンス        |-----|
```

### キャパシティプランニング

情報システムの設計段階において、現状の最大負荷だけでなく将来予測される最大負荷時にもサービスの水準を維持できるような設計を検討することです。  
検討は、CPUの性能や回線の速度などに加えて経済性や拡張性も対象になります。キャパシティプランニングを行うことで適切なハードウェアを選定し、最適な投資ができます。  

キャパシティプランニングの実施は一般に次の手順で行います。  

1. 現状処理能力の把握 : 現行システムをモニタリングし現状の処理能力を把握する  
2. 将来予測 : 将来的に予測される端末の増加、利用者数の増加などを分析する  
3. 増設の検討 : 2.の分析結果からシステム能力の限界時期を予測する  
4. 作成した案の評価・見直し : 新たなシステム構成で実現すべき性能要件から必要なハードウェア増設を検討する  

### MTBF(Mean Time Between Failure)

平均故障間隔。故障が回復してから次に故障するまでの平均時間のこと。
システムの予防保守は，MTBFを長くするために行う。
予防保守では、その時点での正常稼働に影響なくても、経年劣化などにより信頼性の低下した部品を前もって交換します。
これにより将来の障害発生リスクが低くなるのでMTBFが向上します。「予防保守によって，システムのMTBFは長くなる。」は定番の出題ですので覚えておきましょう。

### MTTR(Mean Time To Repair)

平均修復時間。故障が発生したときに復旧に要する平均時間のこと。  
もちろん短いほどいい。  
MTTRを短くする施策には、エラーログの取得、命令トレース機能、遠隔保守、保守部門の分散配置などがあります。  

### 稼働率の公式

$稼働率 = MTBF / (MTBF + MTTR)$  

→  
故障していない時間 + 故障している時間 = 全ての稼働時間  
全ての稼働時間で故障していない時間を割れば、稼働率になる。って理屈だと思うよ。  

**稼働率の計算**
稼働率を R とすると「少なくともいずれか一方が正常に動作すればよいときの稼働率」 = 並列接続
$1-(1-R)^2$

「2台とも正常に動作しなければならないときの稼働率」 = 直接接続
$R^2$

稼働率が0.5倍になったらMTTRとMTBFは等しくなる。  
MTTRとMTBFが1.5倍になっても稼働率は変わらない。  

### M/M/1の待ち行列モデル

利用率(CPU利用率)※がρ(ロー)の時の平均応答時間は次の式で計算することができます。
※利用率…単位時間当たりに処理の窓口を利用している割合。この設問ではCPU使用率を利用率に置き換えて説明してます。

$ρ/1-ρ * 平均サービス時間 + 平均サービス時間$

仮に平均サービス時間を1として利用率(ρ)の値を変化させていくと、
0.2 のとき　1.25
0.4 のとき　1.66…
0.5 のとき　2.00
0.7 のとき　3.33…
0.9 のとき　10.00
と、利用率が上がるにつれて加速度的に平均応答時間が増加していくことがわかります。

### ヒット率と平均実効アクセス時間

キャッシュメモリにヒットした場合のアクセス時間と、しなかった場合のアクセス時間、及びヒット率と平均実効アクセス時間には以下の関係があります。  
$平均実効アクセス時間＝キャッシュメモリのアクセス時間×ヒット率＋主記憶のアクセス時間×(1－ヒット率)$  

### フラグメンテーション

主記憶やハードディスクのような記憶装置において不連続な未使用領域が生じる現象、またはその生じた領域のことです。
ディスク式の記憶装置でファイルの生成と削除を繰り返していると、記憶領域内に連続した未使用領域が少なくなっていき、ひとつのデータが飛び飛びの領域に記録されていきます。
断片化されたファイルを読書きするには、ディスクヘッドを通常より多く動かす必要があるため、非効率的なI/O操作が増加してレスポンスが低下してしまいます。
フラグメンテーションが発生しているか否かを判断するには、ツールなどを用いてディスクの格納状況を調査し、断片化率の確認を行います。

### ベンチマークテスト

使用目的に合わせて選定した標準的なプログラムを実行させ，その処理性能を測定する。  
システムの使用目的に合わせたプログラム、あるいは評価対象の業務の典型的な処理プログラムを用いて、入出力や制御プログラムを含めたシステムの総合的な処理性能を測定する性能評価手法です。  

代表的なベンチマークにSPEC，TPCなどがあります。

#### SPEC

プロセッサの性能を評価するベントマークテストで、整数演算の性能を評価するSPECint、浮動小数点演算能力を評価するSPECfpがある。

#### TPC

オンライントランザクション処理システムの性能を評価するベンチマークテスト

#### シミュレーション

将来の予測を含めて評価する場合などに，モデルを作成して模擬的に実験するプログラムでシステムの性能を評価する。

#### 静的積算

プログラムを実際には実行せずに，机上でシステムの処理を解析して，個々の命令の出現回数や実行回数の予測値から処理時間を推定し，性能を評価する。

#### モニタリング

監視・計測用のプログラムによってシステムの稼働状態や資源の状況を測定し，システム構成や応答性能のデータを得る。



システムやハードウェアの故障頻度と経過年数の関係は、以下のように3つの期間に分けられます。
バスタブ曲線。

**初期故障期間**
設計や製造の不備や使用環境との相性によって故障率が高くなる期間
**偶発故障期間**
初期の不具合が落ち着いて安定した稼働が長く続き、偶発的な故障だけが発生する期間
**摩耗故障期間**
材料や部品の劣化による故障回数が多くなる期間

---

## システムの評価指標 計算系

### 平成30年秋期　問15

東京と福岡を結ぶ実線の回線がある。東京と福岡の間の信頼性を向上させるために，大阪を経由する破線の迂回回線を追加した。迂回回線追加後における，東京と福岡の間の稼働率は幾らか。ここで，回線の稼働率は，東京と福岡，東京と大阪，大阪と福岡の全てが0.9とする。
→
まず通常の回線と迂回回線それぞれの稼働率を求めます。
東京－福岡の回線稼働率は、0.9
東京－大阪－福岡の回線稼働率は、0.9×0.9＝0.81
迂回回線追加後は、上記のどちらかが稼働していればよいので並列構成と考えて計算します。

　1－(1－0.9)(1－0.81)
＝1－0.1×0.19
＝1－0.019＝0.981

### 平成28年秋期　問16

ある時間帯でのジョブの処理状況を計測したところ，次のとおりであった。どのような状況になっているか。

〔ジョブの処理状況〕
多重度3でジョブを実行する。
ジョブは5分間隔で発生し，実行時間は多重度に依存せず20分である。
各ジョブは実行終了後にスプーリング機能を利用して印刷し，印刷時間は15分である。
プリンタは2台使用する。

→
まず実行について考えます。
ジョブの多重度とは、同時にいくつのジョブを並列実行できるのかという数です。
各ジョブの実行時間は20分なので、多重度3だと20分間に3つのジョブの処理を完了できます。
つまり、本システムのジョブ実行能力は「20分÷3件≒6.6分／件」です。
一方、ジョブは5分間隔で到着するので「時間当たりの処理件数＜時間当たりの到着件数」となります。
処理件数よりも到着件数の方が多いので、実行待ちジョブが次第に増えていくことになります。

次に印刷について考えます。
1件当たりの印刷時間が15分、プリンタは2台なので15分で2件の印刷を完了できます。つ
まり、本システムの印刷能力は「15分÷2件＝7.5分／件」となります。
一方、印刷要求はジョブの実行終了と同時に行われるので、印刷要求の到着間隔はジョブの処理能力と同じ約6.6分／件です。
「時間当たりの印刷件数＜時間当たりの印刷要求件数」となるので、印刷待ちジョブが次第に増えていくことになります。

### 平成26年秋期　問14

東京～大阪 及び 東京～名古屋 がそれぞれ独立した通信回線で接続されている。東京～大阪 の稼働率は 0.9，東京～名古屋 の稼働率は 0.8 である。東京～大阪 の稼働率を 0.95 以上に改善するために，大阪～名古屋 にバックアップ回線を新設することを計画している。新設される回線の稼働率は最低限幾ら必要か。

→
大阪 ← 0.9 ← 東京
↑　　　　　　　↓
?? ← 名古屋 ← 0.8

「東京～大阪」の稼働率は"0.9"、「東京～名古屋～大阪」の稼働率は、新設される「名古屋～大阪」の稼働率を"R"とすると"0.8R"と表せます。
これを並列接続の場合の稼働率の式「1－(1－R1)(1－R2)」に当てはめると、バックアップ回線新設後の「東京～大阪」の稼働率は以下の式で表せます。

　1－(1－0.9)(1－0.8R)

この式の値が目標稼働率である"0.95"以上になればよいので、方程式を立てて解きます。

　1－(1－0.9)(1－0.8R)≧0.95
　1－0.1(1－0.8R)≧0.95
　1－0.1＋0.08R≧0.95
　0.9＋0.08R≧0.95
　0.08R≧0.05
　R≧0.625

したがって新設されるバックアップ回線には0.625以上の稼働率が必要と算出できます。

この問題、方向が書いてないから辛い。

### 令和3年秋期　問15

1件のデータを処理する際に，読取りには40ミリ秒，CPU処理には30ミリ秒，書込みには50ミリ秒掛かるプログラムがある。  
このプログラムで，n件目の書込みと並行してn＋1件目のCPU処理とn＋2件目の読取りを実行すると，1分当たりの最大データ処理件数は幾つか。  
ここで，OSのオーバヘッドは考慮しないものとする。  

→  

並列処理の流れを整理して図で表すと次のようになります。  
![!](https://www.ap-siken.com/kakomon/03_aki/img/15.gif)  

上図の赤枠部分を見るとわかるように、50ミリ秒を要する書込み処理が並列処理のボトルネックとなり、  
1分間に処理できる書込み件数がそのまま最大データ処理件数に相当することがわかります。  

1分は「60秒×1,000ミリ秒＝60,000ミリ秒」なので、1分当たりの最大データ処理件数は、  
$60,000ミリ秒÷50ミリ秒＝1,200件$  

→  
並列処理が開始された地点をnと認識するところが肝。  

### 令和3年春期　問14

稼働率がxである装置を四つ組み合わせて，図のようなシステムを作ったときの稼働率をf(x)とする。  
区間 0≦x≦1 におけるy＝f(x)の傾向を表すグラフはどれか。ここで，破線はy＝xのグラフである。  
![!](https://www.ap-siken.com/kakomon/03_haru/img/14.gif)  

→  
稼働率xの機器が2台直列で接続されているときの全体の稼働率は「x2」、並列で接続されているときの稼働率は「1－(1－x)2」ですので、本システムの稼働率は以下の式で表すことができます。  

　1－(1－x2)2

各グラフの形状を見てみると、xが1に近いときと0に近いときの2つのケースでシステム全体の稼働率を計算すればどのグラフが適切であるか判断できるとわかります。  

仮に、xに0.9と0.1を使用して計算すると、  

　f(0.9)  
＝1－(1－0.9^2)^2  
＝1－(1－0.81)^2  
＝1－0.19^2  
＝1－0.0361  
＝0.9639 ＞0.9  

　f(0.1)  
＝1－(1－0.12)2  
＝1－(1－0.01)2  
＝1－0.992  
＝1－0.9801  
＝0.0199 ＜0.1  

となるので、0に近い付近ではxよりも低い稼働率となり、1に近い付近ではxよりも高い稼働率となる「エ」のグラフが適切です。  

### 令和2年秋期　問15

次のシステムにおいて，ピーク時間帯のCPU使用率は何%か。  
ここで，トランザクションはレコードアクセス処理と計算処理から成り，レコードアクセスはCPU処理だけで入出力は発生せず，OSのオーバヘッドは考慮しないものとする。  
また，1日のうち発生するトランザクション数が最大になる1時間をピーク時間帯と定義する。  

〔システムの概要〕
CPU数：1個
1日に発生する平均トランザクション数：54,000件
1日のピーク時間帯におけるトランザクション数の割合：20%
1トランザクション当たりの平均レコードアクセス数：100レコード
1レコードアクセスに必要な平均CPU時間：1ミリ秒
1トランザクション当たりの計算処理に必要な平均CPU時間：100ミリ秒

→  
前回、この問題は何で割るべきかわからなかったので、答えを導き出すことが出来なかった。  
1時間で使えるCPUの時間と実際に使われるCPUの時間の対比で見れば簡単な事なのにね。  

→  
1日に発生する平均トランザクション数のうち、ピーク時間帯におけるトランザクション数は、  

　54,000件×20％＝10,800件  

また、1トランザクション当たりの平均CPU時間は、レコードアクセス時間と計算処理時間の合計なので、  
レコードアクセス：100件×1ミリ秒＝100ミリ秒  
計算処理：100ミリ秒  
より、1トランザクション当たり200ミリ秒とわかります。  

ピーク時間帯における総CPU使用時間は、  

　10,800件×200ミリ秒＝2,160,000ミリ秒＝2,160秒  

CPU数は1なので、ピーク時間帯の1時間(=3,600秒)におけるCPU使用率は、  

　2,160秒÷3,600秒＝0.6→60%  

### 平成30年秋期　問14

3台の装置X～Zを接続したシステムA，Bの稼働率に関する記述のうち，適切なものはどれか。  
ここで，3台の装置の稼働率は，いずれも0より大きく1より小さいものとし，並列に接続されている部分は，どちらか一方が稼働していればよいものとする。  
![!](https://www.ap-siken.com/kakomon/30_aki/img/14.gif)  

→  
安直に0.9で考えて正解したけど、文字に置き換えて計算する必要があったか。  

→  
稼働率がそれぞれRa，Rbの機器があるとして、2つが直列接続されている場合の全体としての稼働率は「Ra×Rb」、並列で接続されている場合では「1－(1－Ra)(1－Rb)」で表せます。  
3つの装置X～Zの稼働率をそれぞれx～zとすると、システムA，Bの稼働率は次の式で表せます。  

[システムA]  
　(1－(1－x)(1－y))・z  
＝(1－(1－x－y＋xy))・z  
＝(x＋y－xy)・z  
＝xz＋yz－xyz  

[システムB]  
　1－(1－x・z)(1－y)  
＝1－(1－y－xz＋xyz)  
＝xz＋y－xyz  

2つの式を比較すると「xz－xyz」の部分は同じで、異なるのは「yz」と「y」の項だけです。  
問題文に「3台の装置の稼働率は，いずれも0より大きく1より小さいものとする」という条件があるので、  

　yz＜y  

の関係となり、結果として、  

　xz＋yz－xyz＜xz＋y－xyz  
　(Aの稼働率＜Bの稼働率)  

が常に成り立ります。よって「常にBの稼働率が高い」という記述が適切です。  

### 平成28年秋期　問15

オンライントランザクション処理システムにおいて，1分当たりの平均トランザクション数が1,200件であり，  
1件のトランザクション処理で100万命令を実行する場合，CPU性能が100MIPSのコンピュータを使用したときのCPUの平均利用率は何%か。  

→  
システムで処理されるトランザクション数は1,200件／分なので、1秒あたり20件です。  

1件当たりの100万が命令が実行されるため、1秒当たりの命令実行数は、  

　20×100万＝2,000(万回)  

MIPSは、CPUが1秒間に実行可能な命令回数を百万単位で表した指標であるため、100MIPSのコンピュータが1秒あたりに実行可能な命令数は10,000万回です。  
したがってCPUの使用率は次のように求められます。  

　2,000万÷10,000万＝0.2＝20(%)  

---

## 1回目に間違えた問題

平成29年春期　問13
ベンチマークテストの説明として，適切なものはどれか。

→
いきなり間違えました。
そうですよね。使用目的に合わせたプログラムで計測するものですよね。
でも、監視・計測用のプログラムって文言も紛らわしくて仕方がないのだが。
あー、でもシステムの稼働状態や資源の状況ってあるので、テストする主体が違いますね。



平成31年春期　問13
冗長構成におけるデュアルシステムの説明として，適切なものはどれか。

→
2つシステムがあることは前提として、どのように動くシステムなのか。
メインとサブがあって、メインに障害が発生したらサブが処理を引き継ぐって見えたので速攻で選んだら終わった。
正解は2つのシステムが同時に動いて、整合性を取りながら動くシステムらしい。
文章おかしいけど勘弁して。



平成28年秋期　問14
ロードバランサを使用した負荷分散クラスタ構成と比較した場合の，ホットスタンバイ形式によるHA(High Availability)クラスタ構成の特徴はどれか。

→
待機系を用意。処理を引き継ぐ。
よく見たら、比較した場合ってあるね。



平成31年春期　問15
アプリケーションの変更をしていないにもかかわらず，サーバのデータベース応答性能が悪化してきたので，表のような想定原因と，特定するための調査項目を検討した。調査項目cとして，適切なものはどれか。

→
データベースバッファの容量不足、フラグメンテーションによるディスクI/Oの増加。
キャッシュメモリのヒット率の調査、データの格納状況の確認。
どちらがどっち？
パッと見どちらにも言えそうな気がしたので間違った。
あ、バッファーって書いてある。ってことはキャッシュメモリとメインメモリとの緩衝材って事なので、それしかないですね。
データベースの容量不足って見間違えたかな!!!



