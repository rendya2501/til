# ネットワーク

---

## データ通信と制御

### OSI基本参照モデル

異機種間のデータ通信を実現するために，通信サービスを7つの階層に分割し，各層ごとに標準的なプロトコルや通信サービスの仕様を定めるという考え方をモデル化したものです。

#### アプリケーション層(第7層)

各層のうち，最も利用者に近い部分であり，ファイル転送や電子メールなどの機能が実現されている。

#### プレゼンテーション層(第6層)

データの表示形式を管理したり、文字コードやエンコードの種類などを規定する役割をもつ。

#### セション層(第5層)

アプリケーションプロセス間での会話を構成し，同期をとり，データ交換を管理するために必要な手段を提供する役割をもつ。

#### トランスポート層(第4層)

エラー検出/再送などの伝送制御を担い通信の品質を保証する役割をもつ。

#### ネットワーク層(第3層)

エンドシステム間のデータ伝送を実現するために，ルーティング(通信経路選択)や中継などを行う役割をもつ。

#### データリンク層(第2層)

隣接ノード間の伝送制御手順(誤り検出，再送制御など)を提供する役割をもつ。

#### 物理層(第1層)

物理的な通信媒体の特性の差を吸収し，上位の層に透過的な伝送路を提供する役割をもつ。

### TCP/IP階層モデル

OSI基本参照モデルと異なり全部で4つの階層から成っています。
また両モデルの対応関係は次のようになっています。(TCP/IP階層モデルは一般的には4層ですが、設問に合わせてネットワークインタフェース層をリンク層とハードウェア層に分割しています)

アプリケーション層
トランスポート層
インターネット層
ネットワークインターフェース層(リンク層、ハードウェア層)

### リピータ(Repeater)

データ伝送中に弱くなった電気信号を増幅し、データの伝送可能距離を延長するLAN間接続装置です。  
OSI基本参照モデルの物理層での接続を行います。  
リピータは，同種のセグメント間で信号を増幅することによって伝送距離を延長する。  

### ルータ(Router)

[1]  
異なる2つのネットワークをOSI基本参照モデルのネットワーク層で接続し、通過するパケットのIPアドレスを見てパケットを最適な経路に中継する通信装置です。  
ルータは、パケットを受信すると、そのヘッダ情報に含まれる`宛先IPアドレス`を確認します。  
そして自身が持つルーティングテーブルと照合して、適切なインタフェースからパケットを送出します。  

[2]  
OSI基本参照モデルのネットワーク層でネットワーク同士を接続し、通過するパケットのIPアドレスを見てパケットを最適な経路に転送する通信装置です。  
ネットワーク層は、OSI基本参照モデル第3層に位置するため下層の伝送媒体(物理層)やアクセス制御方式(データリンク層)の方式に影響されることなく接続することが可能です。  

### スイッチングハブ(レイヤ2スイッチ)

OSI基本参照モデルのデータリンク層で接続し、通過するパケットの**MACアドレス**を見てパケットを送信ポートを判断する装置です。  
スイッチングハブと同様にデータリンク層で動作する機器にブリッジがありますが、ブリッジがソフトウェアで宛先制御を行うのに対して、  
スイッチングハブはハードウェア機構によって宛先制御を行うためより高速に動作するという違いがあります。  

スイッチングハブは、LANポートとMACアドレスの関係が登録されたMACアドレステーブルを内部に持っています。  
データを受信した際には、このMACアドレステーブルを見ることで適切なLANポートから送出できる仕組みになっています。  
受信したデータの宛先MACアドレスがMACアドレステーブルに登録されていない場合や、ブロードキャストフレームを受信したときには、  
機器内部でデータをコピーして受信ポート以外の全LANポートから送出（フラッティング）します。  

### ブリッジ(Bridge)

OSI基本参照モデルのデータリンク層で接続し、通過するパケットのMACアドレスを見てパケットを中継するかどうかを判断する通信装置です。  
MACフレームを受け取ったブリッジは、ヘッダ情報内のMACアドレスと自身がもつMACアドレステーブルに基づき、宛先が存在するポートのみにMACフレームを送出します。  

### ゲートウェイ

OSI基本参照モデルの全階層(主に4層より上)を解釈し、ネットワークの接続を行う機器です。  

### デフォルトゲートウェイ

同一リンク内（ルータやL3SWを超えない範囲＝ブロードキャストドメイン）に存在しない機器と通信を行うときに、外部ネットワークとの接続点となる機器のことです。  
ある端末が外部セグメントの端末と通信を行う場合には、一旦デフォルトゲートウェイにデータを送信することで経路選択と中継を依頼します。  
なぜそうなっているかというと、通信相手のMACアドレスを得るためのARPリクエストはブロードキャスト通信で行われるため、ブロードキャストドメイン外に届かないからです。  

※ルーターやL3SWを設定可能。  

>ぴよぴよ  
>通信において「こいつ、どこに届ければ良いんだ？分からん」なときに取りあえず送る送り先  
>「よく分かんないから取りあえず送ります。後は、そっちで何とかしてください」な送り先が「デフォルトゲートウェイ」です。  

デフォルトゲートウェイに送られたデータは別のネットワークに流れていくからです。  

データの送り先が同じネットワークであれば、直接お届けできます。  
わざわざデフォルトゲートウェイさんに送ってよこす必要は、ありません。  
デフォルトゲートウェイさんに送ってきたということは、送り先は同じネットワーク内にない（他のネットワークにある）ことを意味します。  

見方を変えれば[ネットワークから出ていくデータはデフォルトゲートウェイを通る]と言えます。  
よって「デフォルトゲートウェイはネットワークの出入口である」という言い方がされるのです……多分。  

なお、一般的な構成のネットワークにおいて、他のネットワークとの中継役をやってくれる機器はルータさんです。  
デフォルトゲートウェイを設定する際には、ルータのIPアドレスを指定する場合が多いと思います。  

ルータはデフォルトゲートウェイの役目をします。  
そのせいで、ルータとデフォルトゲートウェイがごっちゃになっちゃう人もいるようです。  
ですが本来、ルータとデフォルトゲートウェイは別の用語です。  
区別できるようにしておいてください。  

ルータは「ネットワーク中のデータ（の中にあるIPアドレス）を見て、行き先を振り分けてくれる機器」です。  
デフォルトゲートウェイは「ネットワークの出入口に相当する機器」です。  
あまり見かけませんが、ルータ以外をデフォルトゲートウェイとして使うことも可能は可能です。  

ルータ：機器の名称  
デフォルトゲートウェイ：機器の役割  

#### 令和2年秋期 午後問5

図1「現在のL社のネットワーク構成」にはIPアドレスの記載がありませんが、注記2の「本社のルータ1，DMZ，サーバ室，オフィスエリア，営業所のルータ及び事務室は，異なるセグメントである」を参考にして、L社ネットワークをセグメントに分けると以下のようになります。

![!](https://www.ap-siken.com/kakomon/02_aki/img/pm05_5.gif)  

本社のNPCは本社オフィスエリアのセグメントに属しているので、他のセグメントとの境界に位置するL3SW1がデフォルトゲートウェイになります。  
営業所1のNPCは営業所1事務室のセグメントに属しているので、他のセグメントとの境界に位置するL3SW2がデフォルトゲートウェイになります。  

∴本社のNPC＝L3SW1  
営業所1のNPC＝L3SW2  

### レイヤ3スイッチ

[1]  
レイヤ2スイッチにルーティング機能を追加したものです。ルータの高速版と覚えておけばよいと思います。  
同じくOSI基本参照モデル第3層（ネットワーク層）で動作するルータがソフトウェアでパケットを処理するのに対して、  
スイッチはASICと呼ばれる専用のハードウェアチップを用いるため、はるかに速く処理を行うことができます。  

ルーティング専用に開発されたASIC（特定用途向けICチップ）  

[2]  
L3スイッチとは、ネットワークの中継機器の一つで、プロトコル階層でいうネットワーク層（第3層）とリンク層（第2層）の両方の制御情報に基づいてデータの転送先の決定を行うもの。  

通常のネットワークスイッチはL2スイッチ（レイヤ2スイッチ）であり、送信元や宛先のMACアドレスなどリンク層の制御情報に基づいて転送を行うが、  
L3スイッチではこれに加えIPアドレスなどのネットワーク層の制御情報を解析して転送を行う。  

#### ルータとの違い

ズバリ！言います。  
仕組みが違います。  
役割が違います。  

ルーティングプロトコルによる経路情報の交換や複数のIPネットワーク間の中継・転送など、ネットワーク層の転送機能のほとんどはルータと重複しているが、  
経路制御はL2スイッチともルータとも異なり、IP層の経路情報とARPテーブルを統合したFDB（Forwarding Database）による制御を行う製品が多い。  

ルータの多くはWAN（広域ネットワーク）用のインターフェースを持ち、主に広域回線とLAN、あるいは広域回線間の接続を担うことが多いのに対し、  
一般的なL3スイッチは多数のEthernetポートなどLAN側インターフェースのみを備え、L2スイッチと同じくLAN内の通信制御に特化したものが多い。  

また、ルータには機能がソフトウェアで実装され修正や機能追加などが容易な製品も多いが、  
L3スイッチはASICやFPGAなど専用の半導体チップを用いてハードウェアにすべての機能を実装した製品が多く、ルータよりもはるかに高速に転送処理を行うことができる。  

[「ルータ」「L3スイッチ」どっちが便利?!](https://www.enecom.co.jp/business/enewings/itdictionary/routerorl3/index.html)  

### ソケット(socket)

アプリケーションがTCP/IPを使用して通信を行うための仮想的なプログラミングインタフェースです。  
通信相手に繋がる電話回線のようなもので、ソケットにデータを書き込んで相手にデータを送ったり、逆に相手から届いたデータをソケットから読み込んだりできる仕組みになっています。  

通常、コンピュータでは同時に使用可能なソケット数に制限があります。  
TCPコネクションが1つ確立されるとソケットが1つ消費されるので、同時接続数がソケットの上限に達してしまうと、  
いずれかのTCPコネクションが切断されるまで新たなTCPコネクションを確立できなくなってしまいます。  

### FW

IPアドレスやポート番号を用いたパケットフィルタリング(通過の可否判定)を行う。  
これらの値が特定できないアクセスは通過させてしまう。  
極端な事を言えば、FWで全ての宛先IPアドレスについて拒否してしまえば、全ての攻撃を防ぐことが出来る。  
外部から受け付ける必要があるアクセスと同じ宛先IPアドレスと宛先ポート番号をもったものは通過させる必要がある。  
なので、これを偽装した攻撃をFWは防ぐ事が出来ない。  

### OSPF(Open Shortest Path First)

主に中規模から大規模のAS内部ネットワーク向けのリンクステート型のルーティングプロトコルです。  
OSPFでは、最初に他のルータとやり取りすることでネットワーク構成図が作成され、それをもとに動的に経路制御表(ルーティングテーブル)が作成されます。  
リンクステート型では、各リンクに対して回線の帯域幅から算出されたコスト(重み)が付けられ、このコストの合計値が最も小さくなるものが最適経路として選択されます。  
また、障害発生時には自動で経路情報の再構築が行われます。  

コストを経路選択の要素に取り入れる。  

### RIP(Routing Information Protocol)

主に小規模ネットワークで使用されるルーティングプロトコルです。  
RIPではホップ数(経由するルータ数)を基準に最適ルートを選択する距離ベクトル型のアルゴリズムを採用しています。  

### CSMA/CD方式(Carrier Sense Multiple Access with Collision Detection)(搬送波感知多重アクセス／衝突検出方式)

各ノードは伝送媒体が使用中かどうかを調べ，使用中でなければ送信を行う。衝突を検出したらランダムな時間の経過後に再度送信を行う。  

CSMA/CD方式は一本の同軸ケーブルに複数のコンピュータが接続されているバス型のトポロジを前提としており、次のような手順で送信が行われます。  

1. 伝送路上に他のノードからフレームが送出されていないかを確認する  
2. 複数のクライアントは同じ回線を共用し、他者が通信をしていなければ自分の通信を開始する。  
3. 複数の通信が同時に行われた場合は衝突を検出し、送信を中止してランダム時間待ってから再び送信をする。  

伝送路上での衝突を許容する仕組みとなっていて、制御が簡単な割に伝送効率が良いという特徴があります。  
→  
それぞれのステーションがキャリア検知を行うとともに，送信データの衝突が起きた場合は再送する。  

CSMA/CDは、伝送路上の通信量が増加するにつれて衝突の発生も増加し、さらに再送が増え通信量が増えてしまうという欠点があります。  
一般にCSMA/CD方式では、伝送路の使用率が30%を超えると急激に送信遅延時間が長くなってしまい実用的ではなくなると言われています。  
→  
衝突発生時の再送動作によって，衝突の頻度が増すとスループットが下がる。  

※令和元年秋期　問32  
それぞれのステーションがキャリア検知を行うとともに，送信データの衝突が起きた場合は再送する。  

### CSMA/CA方式(Carrier Sense Multiple Access with Collision Avoidance)(搬送波感知多重アクセス／衝突回避方式)

無線LANの通信規格のIEEE802.11a、802.11b、802.11g の通信手順として採用されているものです。  
無線LANではフレーム衝突を検出できないため、この手法で衝突を回避（Collision Avoidance）します。  

データ送受信の開始時にデータ送受信のネゴシエーションとしてRTS/CTS方式を用い，受信の確認はACKを使用する。  
→  
無線LANの通信手順であるCSMA/CAの説明です。  
RTS/CTS方式は、無線LANのアクセス制御方式の一つでRTS(Request To Send，送信要求)フレームとCTS(Clear To Send，受信準備完了)フレームを用いてフレームの衝突を防ぐことができるものです。  

### トークンパッシング方式

各ノードを環状に接続して，送信権を制御するための特殊なフレームを巡回させ，これを受け取ったノードだけが送信を行う。  

### 優先度制御方式

各ノードに論理的な順位付けを行い，送信権を順次受け渡し，これを受け取ったノードだけが送信を行う。  

### TDMA(Time Division Multiple Access，時分割多元接続)

タイムスロットを割り当てられたノードだけが送信を行う。  
タイムスロットと呼ばれる単位で分割して，同一周波数において複数の通信を可能にする。  

### IPパケット

IPアドレスによってネットワーク層の通信を行うIPヘッダを付加したパケット

### イーサネットフレーム(MACフレーム)

MACアドレスによってデータリンク層の通信を行うために、IPパケットにMACヘッダを付加したパケット

### 最長一致(ロンゲストマッチ)

ルータは、ルーティングテーブル内に宛先アドレスに合致するエントリが複数ある場合には、プレフィックス長が最も長いエントリを選択します。  

#### 平成27年秋期　問32

ルータがルーティングテーブルに①～④のエントリをもつとき，10.1.1.250 宛てのパケットをルーテイングする場合に選択するエントリはどれか。ここで，ルータは最長一致検索及び可変長サブネットマスクをサポートしているものとする。

![!](https://www.ap-siken.com/kakomon/27_aki/img/32.gif)  

宛先アドレス「10.1.1.250」と各エントリを比較すると以下のように、①、②、③に合致することがわかります。  

![!](https://www.ap-siken.com/kakomon/27_aki/img/32a.gif)  

その後、最長一致検索により合致した3つのエントリの中でプレフィックス長が最も長いエントリが選択されることになります。したがって正解は「③」です。

因みに宛先が「0.0.0.0/0」であるエントリ④はルーティングテーブル内に合致するものがない場合に選択されるデフォルトゲートウェイの指定です。

※ビット単位で一致する箇所が最長なモノを選ぶのがロンゲストマッチ  

---

## 通信プロトコル

### HTTP/2

HTTP/1.1の後継となる規格で2015年に策定されました。中身はGoogleが開発したSPDYというプロトコルほぼそのままです。  
HTTP/2ではストリームの採用（後述）、ヘッダの圧縮、HTTPS接続の必須化、サーバプッシュなど、HTTP/1.1から様々な変更が行われています。  

ストリームとは、1つのTCPコネクションの中にハンドシェイク不要の仮想的なTCPソケットを複数作成し、それを用いて並列ダウンロードを実現する仕組みです。  
ストリームを使用すると、複数のリクエストを同時に送り、複数のファイルを並行してダウンロードすることが可能となります。  

![!](https://www.ap-siken.com/kakomon/01_aki/img/pm05_5.gif)  

上図を見るとわかるように、ブラウザ側では前の画像の受信完了を待つことなく次のリクエストを送信でき、サーバ側では複数のリクエストを次々に処理して応答を返せます。

※補足しておくと、HTTP/1.1にも前のリクエストの結果を待つことなく次のリクエストを発行できる仕組みが用意されていました。  
本文中で登場する「HTTPパイプライン機能」が正にそうです（パイプライニングとも呼ばれます）。  
しかし、HTTPパイプライン機能には幾つかの問題があり、期待するほど通信の効率化に寄与できなかったため、一部のブラウザにしか実装されていませんでした。  

### DHCP(Dynamic Host Configuration Protocol)

TCP/IPネットワークで、ネットワークに接続するノードへのIPアドレスの割り当てをアドレスプールから自動的に行うプロトコルです。  
各クライアントにIPアドレスを設定するネットワーク管理の負担が軽減され、使い終わったIPアドレスを回収し、  
他のノードに再割当てを行うことでIPアドレス資源の有効活用が期待できます。  

DHCPクライアントとDHCPサーバは、DHCPDISCOVER、DHCPOFFER、DHCPREQUEST、DHCPACKの4つのメッセージのやり取りによって、ネットワークアドレス等の割当てを行います。  
ざっくりと流れを確認しておきましょう。  

1. IPアドレス割り当てを要求するDHCPクライアント(以下、クライアント)は、ネットワーク内のDHCPサーバ(以下、サーバ)を見つけるためDHCP発見パケットをブロードキャストで送信する（DHCPDISCOVER）。  
2. DHCP発見パケットを受け取ったサーバは、使用可能なIPアドレスとサブネットマスクなどのネットワーク設定をクライアントに通知する（DHCPOFFER）。  
3. クライアントは通知されたネットワーク設定を使用することをサーバにブロードキャストで通知する（DHCPREQUEST）。  
4. サーバは、配布するIPアドレスが未使用であることを確認し、クライアントに確認応答パケットを送信する（DHCP ACK）。  
この際IPアドレスが割当て不能だった場合はその旨をクライアントの通知する（DHCPNACK）。  

![!](https://www.ap-siken.com/kakomon/02_aki/img/35_1.gif)  

DHCPクライアントは、DHCPDISCOVERメッセージの送信時点では自身の属するネットワークが明らかになっていなので、宛先IPアドレスを「255.255.255.255」にしてブロードキャストします。  
これは同一セグメントに属する全てのコンピュータに対して同じメッセージを送信することを意味します。  
また送信元IPアドレスは未割当てなので「0.0.0.0」に設定します。  

DHCPは、クライアント→サーバの通信には67/UDP、サーバ→クライアントの通信には68/UDPを使用します。  
「なぜUDPが使用されるのか」というと、DHCPのシーケンス中でブロードキャストが使用されるためです。  
TCPはコネクション型で相手との接続を確立してから通信を行う特性があり、不特定多数の相手を宛先とするブロードキャストやマルチキャストができません。  
このためDHCPではUDPが使用されているという訳です。  

DHCPサーバによって自動設定されるのは以下の構成情報です。  
・DHCPクライアントのIPアドレス  
・サブネットマスク  
・デフォルトゲートウェイのIPアドレス  
・DNSサーバのIPアドレス  

同じネットワークにDHCPサーバが複数存在する場合はクライアントが送信したDHCP DISCOVERに対して複数のDHCP OFFERが返されます。  
クライアントはこのうち先に受信したものを優先し、受け入れを表明するために、  
そのDHCP OFFERに含まれる「送信元DHCPサーバのIPアドレス」と「提案されたIPアドレス」を格納した[DHCP REQUEST]をブロードキャストします。  
[DHCP REQUEST]を受信したDHCPサーバはパケット内容を確認し、自身の提案が受けれられたならばDHCP ACKで構成情報をクライアントに通知します。  
そうでなければ自身の提案が破棄されたと判断し[DHCP REQUEST]を無視します。  
要するにDHCPサーバがDHCP REQUESTの内容から判断できることは、自身のDHCP OFFERがクライアントで受理されたかどうかという点です。  

### DHCPリレーエージェント

DHCPによるIPアドレスその他ネットワーク情報の割当ては、DHCPクライアントとDHCPサーバとの間で、  
DHCPDISCOVER、DHCPOFFER、DHCPREQUEST、DHCPACKの4つのメッセージをやり取りして行います。  

この手順におけるDHCPDISCOVERとDHCPREQUESTメッセージがブロードキャストで行われる関係で、  
DHCPクライアントとDHCPサーバが異なるセグメントに設置されているときにはDHCPによるネットワーク情報の割当てが正しく動作しません。  

この問題を解決するためにルータやL3SWで稼働させるのが、DHCPリレーエージェントです。  
DHCPリレーエージェントは、異なるネットワークセグメントに存在する（ブロードキャストが届かない）DHCPクライアントとDHCPサーバとの間の通信を取り持つことでDHCPを機能させるものです。  
本問のようにTCとDHCPサーバが別のセグメントに設置されている場合には、DHCPリレーエージェントを利用する必要があります。  

![!](https://www.ap-siken.com/kakomon/02_aki/img/pm05_7.gif)  

### DNS(Domain Name System)

ドメイン名とIPアドレスを結びつけて変換する(名前解決する)仕組みです。

独自のネームサーバを使用する際にはレジストラ（ドメイン名取得業者）を通じて、ネームサーバのFQDNとIPアドレスの組みを登録しておく必要があります。  
これは一般的にホスト登録と呼ばれる作業です。  
これをせずにDNSレコードを設定してもエラーとなってしまい名前解決できません。  

**NSレコード**  
そのドメインのゾーン情報を保持するネームサーバのホスト名を指示するレコードです。  

**Aレコード**  
ドメイン名・ホスト名に対応するIPアドレスを指定するためのレコードです。  

**CNAMEレコード**  
あるホスト名に対して別名(エイリアス)を指定するレコードです。  
DNSの設定上、CNAMEを設定したホスト名は、他のいかなるレコード（AレコードやNSレコードなど）とも重複して設定してはならないというルールがあります。  
例えば以下のような設定は違反となります。  

``` txt
www IN A 200.x.y.1
www IN CNAME hogehoge.com
```

例)
「w3.example.co.jp」にアクセスしてきた利用者を、自動的にWAFサービスのFQDNである「waf-asha.example1.ne.jp」に転送できます。  
このようにWAFサービスを利用する場合でも、CNAMEの設定により、利用者はアクセスするWebサイトのURLを変更する必要がなくなります。  

### PPP(Point-to-Point Protocol)

電話回線を通じてコンピュータをネットワークに接続するダイヤルアップ接続でよく使われる、2点間を接続してデータ通信を行うための通信プロトコルです。  
PPP通信には、リンク制御プロトコル(LCP)とネットワーク制御プロトコル(NCP)という2つの通信プロトコルが使用されています。  

・リンク制御やエラー処理機能をもつ  

### PPPoE(Point-to-Point Protocol over Ethernet)

PPPプロトコルをEthernet上で利用するためのプロトコルです。  
ブロードバンドルータからプロバイダの認証と接続を行うときに使用されています。  
通信経路の暗号化機能は持っていません。  

### FTP(File Transfer Protocol)

ネットワーク上でファイルの転送を行うための通信プロトコルです。

### TCP(Transmission Control Protocol)

TCP/IPネットワークにおいて通信を行う2つのノード間にコネクションと呼ばれる論理的な通信路を確立し、送達管理や、伝送管理などの機能を提供するプロトコルです。  
OSI基本参照モデルでTCPが属するトランスポート層は、通信の信頼性を確保する機能のほかに、アプリケーション間の通信を実現するという機能があります。  
IPアドレスは、パケットを送信元ホストから宛先ホストに届けるための情報で、パケットを送り届けるアプリケーションの情報は含まれていません。  
このパケットの宛先となるアプリケーションを指定する情報がポート番号です。  
宛先IPアドレス・ポート番号は、パケットを届けるのに必要で、送信元IPアドレス・ポート番号はパケットを受け取ったホストがパケットを返信する際に返信パケットに宛先としてセットするために必要となる。  

### UDP(User Datagram Protocol)

TCP/IPの通信処理で使われる伝送制御プロトコルのひとつでTCPと同じトランスポート層に位置します。  
TCPでは信頼性を担保するために、コネクション確立、再送処理、輻輳処理などの様々な仕組みが取り入れられていますが、その分だけ通信のオーバヘッドは増加してしまいます。  
UDPは、TCPから信頼性確保を取り除いたコネクションレス型の通信を実現するプロトコルです。  
ヘッダ構成もTCPと比べて簡素化されデータ比率が高められるようになっています。  
UDPは、リアルタイム性が重視される音声や画像のストリーム配信、および、DNS、DHCP、NTPなどのアプリケーション層プロトコルで用いられています。  

### TCPとUDP

TCP…信頼性重視  
UDP…通信効率、リアルタイム性重視  

#### 令和3年秋期　問34

UDPのヘッダフィールドにはないが，TCPのヘッダフィールドには含まれる情報はどれか。

TCPは信頼性の高い通信を提供するためのプロトコルのため様々なフィールドがありますが、UDPは軽量かつリアルタイム性を重視した通信を提供するプロトコルのため非常に単純な構造です。  

![TCPヘッダーとUDPヘッダー](https://www.ap-siken.com/kakomon/03_aki/img/34.gif)  

シーケンス番号は送信したデータの位置を示す情報で、確認応答番号とともに送信データの順序を管理するために使われます。  
TCPにはシーケンス番号のフィールドがありますが、UDPにはありません。  

### NTP(Network Time Protocol)

ネットワークに接続されている環境において、サーバ及びクライアントコンピュータが持つシステム時計を正しい時刻(協定世界時:UTC)へ同期するためのプロトコルです。  

### ARP(Address Resolution Protocol)

IPアドレスから対応する機器のMACアドレスを取得するプロトコルです。  

1.要求パケットに、MACアドレスを得たいIPアドレスと、送信元のIPアドレス・MACアドレスを格納して、同一セグメント内にブロードキャストする。  
2.要求パケットを受け取った各ノードは、解決目的のIPアドレスを確認し、自分のIPアドレスであれば、自分のMACアドレスを送信元に伝える。  

![!](https://www.ap-siken.com/kakomon/03_aki/img/32.gif)  

### RARP(Reverse Address Resolution Protocol)

ARPがIPアドレスから機器のMACアドレスを得るのとは逆に、機器固有のMACアドレスから対応するIPアドレスを取得するためのプロトコルです。  

### ICMP(Internet Control Message Protocol)

インターネットプロトコル(IP)の通信制御を補完するプロトコルで、データ配送中のエラー通知や送達エラーを通知する機能を持ちます。  
TCP/IPで接続しているノード（サーバ、PC等）間の通信状態を確認します。また、誤った通知や通信関連の情報の通知などのためのプロトコルです。  

ping(ピン又はピング)は、ICMPの「echo request」パケットを対象ノードに送信し、  
「echo reply」パケットが返ってくるか否かで、対象ノードおよび到達するまでのネットワーク間が正常であるかを診断する機能です。  

### RIP(Routing Information Protoco)

ゲートウェイ間のホップ数によって経路を制御するルーティングプロトコルです。  
経路数か重み付けかのアレ。  

### SMTP(Simple Mail Transfer Protocol)

インターネット環境において、クライアントからサーバにメールを送信したり、サーバ間でメールを転送するのに用いられるプロトコルです。

### NAT(Network Address Translation)

社内のプライベートIPアドレスをグローバルIPアドレスに変換し，インターネットへのアクセスを可能にする。
IPマスカレードともいう。

### NAPT(Network Address Port Translation,IPマスカレード)

[1]  
プライベートIPアドレスとグローバルIPアドレスを相互変換するNATの考え方にポート番号を組み合わせた技術です。  
NAPTでは、インターネットに接続するノードに対して固有のポート番号を割り当て、IPアドレスだけでなくポート番号も一緒に変換します。  
これにより、1つのグローバルIPアドレスを使ってプライベートネットワーク内の複数のノードが同時にインターネットに接続することが可能となります。  

[2]  
プライベートIPアドレスとグローバルIPアドレスの相互変換するNATの考え方にポート番号を組み合わせた技術です。IPマスカレードとも呼ばれます。  
TCP/IPの原則に則れば、複数の端末がインターネットに接続する場合には、それに対応する数のグローバルIPアドレスが必要です。  
しかし、NAPTを利用すると内部LAN上の複数の端末を、1つのグローバルIPアドレスで同時にインターネットに接続させることが可能です。  
NAPTでは、プライベートIPアドレスとインターネット通信に使用するポート番号を対応させることで端末の識別を行っています。  

![!](https://www.ap-siken.com/kakomon/02_aki/img/34.gif)  

### VRRP(Virtual Router Redundancy Protocol)

ネットワークのデフォルトゲートウェイとなるルータやL3スイッチの冗長構成を実現するプロトコルです。  

VRRPでは複数台のルータに共通して使える仮想IPアドレス・仮想MACアドレスを用意し、障害発生時には2つのアドレスをフェールオーバで待機系に移すことで継ぎ目なく処理を続行します。  
この仕組みによってホストのデフォルトゲートウェイの設定値などを変更することなしに、送信先の装置を正常稼働するものに置き換えることが可能になっています。  

### SOAP(ソープ，Simple Object Access Protocol)

ソフトウェア同士がメッセージを交換する遠隔手続き呼び出し(RPC)のためのプロトコルです。  
汎用なデータ形式であるXMLに基づいて記述されており、Webサービスにとって有効な手段の一つとなっています。  

AmazonのWebサービスを例にすると、ソフトウェアが商品データを要求するときにXML形式であるSOAPリクエストを発行し、  
それに対してWebサービス側からも要求に基づいて商品データがSOAPメッセージとして戻るという仕組みです。  

### REST(Representational State Transfer)

簡単に言うとHTTPのGETメソッドをリクエストを送信するとXML形式のデータが返ってるものです。  
例えばAmazonで指定されたURLに対して要求したいサービスを示すパラメータを指定したリクエストを送ると、商品情報などが含まれるXMLデータを取得することができます。  

### RPC(Remote Procedure Call)

サーバにあるプログラムを，サーバのIPアドレスを意識することなく，プログラム名の指定だけで呼び出すようにする。

### WebSocket

Webアプリケーションにおいてクライアント(Webブラウザ)とWebサーバの間で効率的な双方向通信を実現するプロトコルです。  

Webにおける標準プロトコルであるHTTPは「クライアントのリクエストに対してサーバがレスポンスする」という1組の通信が基本手順になっていて、サーバが自発的にクライアントに対してデータを送れるようにはなっていません。  
これまで、このような仕組み(例えば自動的に最新情報に更新されるシステム)を実現するためにはAjaxのようにクライアントから定期的にリクエストを送らせ、サーバ側で適宜返答を行う仕組みが必要でした。しかし短い間隔で定期的に行われる情報取得の度にTCPコネクションが確立され、HTTPでのやり取りが発生するためパフォーマンス的には決して良い方法ではありませんでした。  

WebSocketを使用したデータ通信では、まずHTTPの手順に則り、クライアントとサーバで1組のHTTP通信を交してWebSocket用の通信路を確立します。  
その後はHTTPの手順に縛られず、1つのTCPコネクション上でデータのやり取りが行えるようになっています。  
この仕組みによりオーバヘッドが少なくなり、リアルタイム性が必要とされるシステムを効率的に実現できるようになります。  

※WebSocketはHTTP通信を拡張したものなので、使用するポートがHTTPと同じです。(80番)  
※WebSocketはTCPコネクションを確率したままにする。  

※令和3年春期 午後問5  
指摘1.  
WebSocketはTCPコネクションを確立したままにするので，負荷分散装置を経由してチャット機能へアクセスすると，旅行販売システムの既存機能へのアクセスに影響がある。  
→  
WebSocketではTCPコネクションを確立したままにするので、チャット機能の利用が多くなると負荷分散装置の同時接続数が一杯になり、旅行販売システムの既存機能へのアクセスができなくなってしまうという問題です。  

指摘2.  
チャット機能をWebSocket Over TLSに対応させないと，販売代理会社からプロキシサーバを経由してチャット機能にアクセスできない。  
→
WebSocketは比較的新しいプロトコルなので、対応していないプロキシサーバにおいてupgradeヘッダを含むパケットが破棄されてしまい、プロキシサーバ越えができないという問題です。  

### ポート番号

コンピュータがデータ通信を行う際に通信先のプログラムを特定するための番号のことです。
TCP/IP通信において、コンピュータが通信に使用するプログラムを識別するための16ビットの数値で 0～65535 が指定可能です。

ネットワーク上で相手コンピュータにデータを送信する場合、通信相手のコンピュータはIPアドレスで指定しますが、
そのコンピュータで動いているどのプログラムにデータを送るかを指定する情報がポート番号です。
IPアドレスを建物の住所に例えるなら、ポート番号は部屋番号に相当します。

TCPやUDPのヘッダには、宛先ポート番号と送信元ポート番号というフィールドがあります。
宛先ポート番号は、原則としてクライアントがサービスを要求する場合には「当該サービスを受け付けている番号」、
サーバがクライアントに応答する場合には「サービスを要求してきたクライアントのポート番号」が設定されることになります。
この問題ではパケットのポート番号に注目しながら通信の様子を確認します。

プロキシサーバは8080番でサービスを待ち受けているので、クライアントは宛先ポート番号に8080、送信元ポート番号に任意の番号(p1)を設定してプロキシサーバに送信する。
クライアントからHTTP代理要求を受けたプロキシサーバは、宛先ポート番号に80、送信元ポート番号に任意の番号(p2)を設定してWebサーバに送信する。
プロキシサーバからHTTP要求を受けたWebサーバは、宛先ポート番号にp2、送信元ポート番号に80を設定してWebサーバに送信する。
WebサーバからHTTP応答を受け取ったプロキシサーバは、宛先ポート番号にp1、送信元ポート番号に8080を設定してクライアントに送信する。

### ウェルノウンポート番号(Well-known port numbers)

ポート番号のうち、よく利用される特定のアプリケーション用に予約されている 0～1023 までのことです。

下記のプロトコルとポート番号の組みについては情報処理技術者試験での出題頻度が高いため覚えておいて損はありません。

``` txt
FTP   :: 20/TCP，21/TCP
SMTP  :: 25/TCP
DNS   :: 53/TCP，53/UDP
HTTP  :: 80/TCP
POP3  :: 110/TCP
NTP   :: 123/UDP
HTTPS :: 443/TCP
SNMP  :: 161/UDP,162/UDP
```

・FTPには、データの転送用に「20/TCP」、制御用に「21/TCP」が割り当てられています。  
・SNMPでマネージャ側からエージェントに通知するときに使用される宛先ポートが「161/UDP」、逆にエージェント側からマネージャに通知するときに使用される宛先ポートが「162/UDP」です。  
・SMTPで通常のメール転送に使用されるのが「25/TCP」、メールソフトからメールサーバに届けるときに使用する送信専用の宛先ポート(サブミッションポート)が「587/TCP」です。  
・ポート8080番は代替HTTPポートと呼ばれ、大抵のプロキシサーバは8080番でサービスを待ち受けています。  
・1024～49151もRegisteredポートとして予約されているため、クライアント端末のポート番号には、上記以外の49152～65535の範囲を使用することになっています。  

### IPv4(Internet Protocol Version 4)

・アドレス長は32ビット
・192.168.0.0～192.168.255.255 は、クラスCのプライベートアドレス
・IPv4におけるループバックアドレスは「127.0.0.1」です。自分自身を指す。
**「127.0.0.1」＝ループバックアドレス＝「自分」を意味するIPアドレス**  

127.158.32.134のように先頭の1バイトが"127"であるIPアドレスは「ローカル・ループバック・アドレス」といい、
自分自身のマシンを指す特別なアドレスとして規定されているため、グローバルIPアドレスには使用できません。

### IPv6(Internet Protocol Version 6)

現在インターネットで主流であるIPv4の次期バージョンです。
IPv4のアドレス空間は32ビットですが、インターネットの世界的な普及で枯渇することが確実になっています。
この問題への対策として、策定されたのがIPv6であり、IPv4からIPv6への主な変更点は次の通りです。

・アドレス空間を32ビットから128ビットに拡大(340澗（かん）は、340兆の1兆倍の1兆倍。)
・ヘッダのサイズを可変長から固定に変更
・IPアドレスの自動設定
・IPSecによるIP層でのセキュリティー強化

・IPv4の$2^96$倍のアドレス空間を持つ
・複数のアドレス表記法があり，その一つは，アドレスの16進数表記を4文字(16ビット)ずつコロン":"で区切る方法である。
  16ビットずつの纏まりを16進数4桁で表記したものを":(コロン)"で区切る表記法になっています。
例題的な表記法を乗せておきたい。

・グローバルアドレスの他に、所属するネットワーク内(ルータを超えない範囲)でのみ有効な「リンクローカルアドレス」や、IPv4のプライベートアドレスに相当する「ユニークローカルユニキャストアドレス」があります。  

![拡張ヘッダ](https://www.ap-siken.com/kakomon/03_aki/img/36_2.gif)  

### IPsec(Security Architecture for IP)

IP(Internet Protocol)を拡張してセキュリティを高め、改ざんの検知、通信データの暗号化、送信元の認証などの機能をOSI基本参照モデルのネットワーク層レベル(TCP/IPモデルではインターネット層)で提供するプロトコルです。  

AHとESPはIPsecの仕様に含まれるプロトコルです。  
IPv6環境ではネットワーク層(インターネット層)で暗号化を行うIPsecの実装が必須になっています。  

### IPアドレスクラス

IPv4におけるA～Dの各アドレスクラスは、以下のようにIPアドレスの先頭4ビットによって区別されています。
対象となるIPアドレスの上位8ビットに注目します。

クラスA  
先頭ビットが0 (先頭8ビットの10進表記が0～127)  
0000 0000 ~ 0111 1111  
10.0.0.0～10.255.255.255(10.0.0.0/8) は、クラスAのプライベートアドレス

クラスB  
先頭ビットが10 (先頭8ビットの10進表記が128～191)  
1000 0000 ~ 1011 1111  
172.16.0.0～172.31.255.255(172.16.0.0/12) は、クラスBのプライベートアドレス

クラスC  
先頭ビットが110 (先頭8ビットの10進表記が192～223)  
1100 0000 ~ 1101 1111  
192.168.0.0～192.168.255.255(192.168.0.0/16) は、クラスCのプライベートアドレス  

クラスD  
先頭ビットが1110 (先頭8ビットの10進表記が224～239)  
1110 0000 ~ 1110 1111  

例えば10進数128を2進数表記に変換すると10000000です。  
この定義に当てはめると、128はクラスBの範囲内であるため、128.0.0.0 はクラスBのIPアドレスということになります。  

``` txt
A 0    0000 0000(000) ~ 0111 1111(127)
B 10   1000 0000(128) ~ 1011 1111(191)
C 110  1100 0000(192) ~ 1101 1111(223)
D 1110 1110 0000(224) ~ 1110 1111(239)

16~31 : 0001 0000 ~ 0001 1111

10.0.0.0 – 10.255.255.255
0000 1010 . 0000 0000 . 0000 0000 . 0000 0000
0000 1010 . 1111 1111 . 1111 1111 . 1111 1111

172.16.0.0 - 172.31.255.255
1010 1100 . 0001 0000 . 0000 0000 . 0000 0000
1010 1100 . 0001 1111 . 1111 1111 . 1111 1111

192.168.0.0 – 192.168.255.255
1100 0000 . 1010 1000 . 0000 0000 . 0000 0000
1100 0000 . 1010 1000 . 1111 1111 . 1111 1111
```

IPアドレス208.77.188.166は，どのアドレスに該当するか。  
![グルーバルIPアドレス](https://www.ap-siken.com/kakomon/28_aki/img/33.gif)  

<http://atnetwork.info/tcpip/tcpip44.html>

◆IPアドレス（クラスの概念）

　IPアドレスには、アドレスクラス（address class）という分類方法があります。サブネットやCIDRなどにより、アドレスクラスの概念が薄れてきていますが、ネットワークの設計するときには、必ず考慮しなければならない重要な概念です。
IPアドレスの最上位部分のビットパターンで、クラスA ～ クラスE までの5つに分類されています。

#### クラスA ( 0.0.0.0 ～ 127.255.255.255 )

最初の8ビットがネットワークアドレス、残りの24ビットがホストアドレスになります。

ただし、ネットワークアドレスの最初の1ビットは、識別のため、「0」とすることが決められています。

つまり、第1オクテットは、2進数で「00000000」～「01111111」までを意味します。

　10進法に置き換えると「0.X.X.X」～「127.X.X.X」になり、ネットワークアドレスは128個、ホストアドレスは、各ネットワークアドレスごとに1,677万7,216個あります。

※「x」は、ホストアドレスを示しています。

クラスAは、最も大規模なネットワーク向けのクラスクラスになります。
クラスAアドレスは、IPアドレス全体の空間（≒43億個）のうち、半分を占めています。
※ここで、説明しているIPアドレス数は、予約されているIPアドレスも含まれています。

#### クラスB ( 128.0.0.0 ～ 191.255.255.255 )

最初の16ビットがネットワークアドレス、残りの16ビットがホストアドレスになります。

ただし、ネットワークアドレスの最初の2ビットは、識別のため、「10」とすることが決められています。

　つまり、第1、第2オクテットは、2進数で「10000000.00000000」～「10111111.11111111」までを意味します。

　10進法に置き換えると「128.0.X.X」～「191.255.X.X」になり、ネットワークアドレスは16,384個、ホストアドレスは、各ネットワークアドレスごとに6万5,536個確保されます。

※「x」は、ホストアドレスを示しています。

クラスBは、クラスAに次ぐ規模のネットワーク向けのアドレスクラスになります。

※ネットワークアドレスは最初の2ビットが固定されているので

　214 = 16,384 個になります。

クラスBアドレスは、IPアドレス全体の空間（≒43億個）のうち、1/4を占めています。

※ここで、説明しているIPアドレス数は、予約されているIPアドレスも含まれています。

#### クラスC ( 192.0.0.0 ～ 223.255.255.255 )

最初の24ビットがネットワークアドレス、残りの8ビットがホストアドレスになります。

ただし、ネットワークアドレスの最初の3ビットは、識別のために、「110」とすることが決められています。

　つまり、、第1、第2、第3オクテットは、2進数で「11000000.00000000.00000000」～「11011111.11111111. 11111111」までを意味しています。

　10進法に置き換えると「192.0.0.X」～「223.255.255.X」になり、ネットワークアドレスは209万7,152個、ホストアドレスは、各ネットワークアドレスごとに256個確保されます。

※「x」は、ホストアドレスを示しています。

クラスCは、小規模なネットワーク向けのアドレスクラスになります。
クラスAアドレスは、IPアドレス全体の空間（≒43億個）のうち、1/8を占めています。
※ここで、説明しているIPアドレス数は、予約されているIPアドレスも含まれています。

#### クラスD ( 224.0.0.0 ～ 239.255.255.255 )

クラスDは、クラスAからクラスCまでのいずれのアドレスクラスにも該当しない特殊なクラスです。
クラスDでは、最初の4ビットが識別のために、「1110」とすることが決められています。
クラスDの使用目的は、IPマルチキャスト用です。ホストアドレス部分はありません。

10進数で範囲を表すと、「224.0.0.0」～「239.255.255.255」になります。
マルチキャスト通信は、音声や映像データの一斉放送するために、マルチメディアアプリケーションなどが使用します。
また、ルーティングプロトコルがお互いに経路情報を交換する際にも使用されます。

#### クラスE ( 240.0.0.0～255.255.255.255 )

クラスEでは、最初の4ビットが識別のために、「1111」とすることが決められています。
　クラスEのIPアドレスの範囲は、「240.0.0.0～255.255.255.255」で、このクラスは、実験用としてTCP/IP（IPv4）の開発当初から予約されています。実際に使われることはありません。

### ブロードキャストアドレス

あるネットワーク内のすべての端末に同じ内容を送信する(ブロードキャストする)ときに使われる特別な宛先アドレスで、ホストアドレス部のビットを全て"1"にしたアドレスです。  
IPアドレスからブロードキャストアドレスを得るには、サブネットマスクでビットが"1"になっている部分（ネットワーク部）にはホストのIPアドレスをそのまま使い、  
サブネットマスクのビットが"0"になっている部分（ホストアドレス部）のビットは全て"1"にします。  

ブロードキャストは、あるネットワークに属するすべてのノードに対してデータを同時伝送することです。

#### 令和3年秋期　問35

IPv4ネットワークにおいて，あるホストが属するサブネットのブロードキャストアドレスを，そのホストのIPアドレスとサブネットマスクから計算する方法として，適切なものはどれか。ここで，論理和，論理積はビットごとの演算とする。

![!](https://www.ap-siken.com/kakomon/03_aki/img/35.gif)  

サブネットマスクをビット反転すると、ネットワーク部のビットが"0"、ホストアドレス部のビットが"1"になったビット列となります。  
これと対象IPアドレスを論理和(OR)演算すると、ネットワーク部は元のIPアドレスのビットそのまま、ホストアドレス部は全て"1"になったビット列（ブロードキャストアドレス）を得ることができます。  

### ブロードキャストストーム

ループ状に接続されているネットワークにおいて、同一のブロードキャストフレームが増幅しながら永遠にネットワーク内を回り続ける現象です。  

ネットワークスイッチはブロードキャストフレームを受け取ると、そのフレームをコピーし、受信ポート以外の全てのポートから送出します。  
このときネットワーク内にループ状の構成が含まれていると、いずれはスイッチ自身が送信したフレームを自分で受信し、再び全てのポートに送信してしまうことになります。  
このように増幅したブロードキャストフレームは、やがてネットワークの帯域を圧迫しネットワーク障害をもたらします。  
これが「ブロードキャストストーム」です。  

### ネットワークアドレス

ホストアドレス部がすべて0となるアドレス。
どちらのアドレスもPCに割り振ることができない。

![ユニキャスト、マルチキャスト、ブロードキャスト](https://www.ap-siken.com/kakomon/03_aki/img/31.gif)  

### イーサネット(Ethernet)

> wiki
>イーサネット (Ethernet) は、家庭・企業・データセンターなどで使用されるコンピューターネットワークにおいて、LANやWANを構成する有線ローカルエリアネットワークの主流な通信規格である。 その技術仕様はIEEE 802.3で規定されている。  
>
>イーサネットとは、主に室内や建物内でコンピュータや電子機器をケーブルで繋いで通信する有線LAN（構内ネットワーク）の標準の一つで、最も普及している規格。  

単純に優先LANの規格の事をいうらしい。  
規格としては1000BASE-T等のアレ。  

### 広域イーサネット

>[大塚商会](https://www.otsuka-shokai.co.jp/words/wide-area-ethernet.html#:~:text=%E5%BA%83%E5%9F%9F%E3%82%A4%E3%83%BC%E3%82%B5%E3%83%8D%E3%83%83%E3%83%88%E3%81%A8%E3%81%AF,%E3%81%AE1%E3%81%A4%E3%81%A7%E3%81%82%E3%82%8B%E3%80%82)  
地理的に離れたLANとLANの間などをEthernetで接続するネットワークのこと。  
その範囲は100km単位の大きさにわたり、「広域LAN」とも呼ばれる。IP-VPNやインターネットVPNと同じように、WAN（広域網）サービスの1つである。  

メリット
IP-VPNやインターネットVPNに比べ、次のようなメリットがある。  
・通信速度が速く、遅延の幅が小さい。  
・安価なVLAN対応のスイッチングハブが利用でき、初期コストを低減できる。  
・IP以外の通信プロトコルを利用する場合でもEthernetへの変換のみで済む。  
・ネットワーク構成の自由度が高く、拠点の追加やプロトコルの変更などに柔軟に対応できる。  

デメリット
・提供地域が狭い
・アクセス回線の選択肢が少ない
・回線の費用が高くなる
最近では、このようなデメリットも改善されつつある模様。  

ネットワーク間はルーターで区切るが、広域イーサネットでは全拠点を同一ネットワークとして扱うため、拠点ごとのルーターが不要になる。  
さらに、IP、AppleTalk、IPXなど、マルチプロトコルにも対応する。  

><https://www.gate02.ne.jp/media/it/column_78/>  
>「広域イーサネット」とは、通信事業者が独自に用意した閉域網を利用するL2（レイヤ2）のVPN接続サービスのことです。  
>L2で通信を行うので、地理的に離れたLAN同士を1つの大きなLANとして構築できます。  
>IP-VPNやインターネットVPNのようにインターネットプロトコルでの通信に限定されず、多様なルーティングプロトコルに対応できる為、 柔軟性のあるネットワーク設計が可能となりま>す。  
>また、公衆網（インターネット）を使わない事で、高いセキュリティレベルを保持する事が出来るほか、安定して高速な通信が実現します。  
>
>一般企業へ最も浸透している拠点間接続方法はインターネットVPNですが、公衆網を利用しL3（レイヤ3）の階層で通信をする事で、VPNルータの用意と設定さえ出来れば容易に、また比較的安>価に導入が実現するVPNとなります。  
>しかし、トラフィックの混雑状況によって通信速度が遅くなる可能性があったり、公衆網が故セキュリティリスクを孕んでいる点ではL2のVPN接続サービスに若干劣るかもしれません。  

→
地理的に離れていても同一拠点同士の通信とみなせるので、ルーターを設置してIPの変換等を行う必要がない模様。  
第2層までで通信が事足りるということか。  

[2]  
回線事業者が提供する閉域ネットワークに接続する。
イーサネットの名の通りL2レベルで接続するため上位の層のプロトコルがIPに限定されない。
事業者の回線を使用するため帯域保証などのサービスがある。

### インターネットVPN

IPsecなどのセキュリティプロトコルを利用して公衆回線上にVPNを構築する。  
通信経路にインターネットを利用するため専用線を用いるサービスと比較して安価なことが多い。  
通信品質を保証しないベストエフォート型なのでネットワークが混雑していると通信の遅延が生じることがある。  

### ベストエフォート

ベストエフォート（best effort）とは、日本語でいうと「最大限の努力」といった意味になります。  
インターネットの世界においては、回線業者が提示した最大通信速度を上限とし、最大限に努力した速度でインターネットに接続することを意味します。  

光回線をはじめとするインターネット回線の通信速度は、回線事業者によって「最大1Gbps」というような表示がされています。  
これは、技術規格上の最大通信速度のことで、実際の通信速度は回線の混み具合によって変化します。  
ほかにも、使用している機器の性能やケーブルの種類、基本ソフトの設定などによっても通信速度は異なります。  

このように、最大通信速度とは、回線に接続するユーザーが少ないために混雑しておらず、PCなどの機器の処理性能が高いなど、諸条件が最高に整っているときに再現できる理論値ということになります。  

実際にインターネット回線を利用した場合、どのくらいの通信速度が出せるのかは、回線事業者でも保証はできません。  
そのためベストエフォートでは、条件によってはうたわれている最大通信速度を下回ることもあります。  
つまり、ベストエフォートとは、最高の条件で出せる最大の通信速度を表示した契約条件ということになります。  

---

## ネットワーク管理

### ping(ピン，ピング)

IPネットワークにおいて対象の端末にパケットを送信し、正しく届いたかを確認するためのコマンドです。  
具体的には、ICMPの"echo request"(エコー要求)パケットを対象ノードに投げ、対象ノードから"echo reply"(エコー応答)が返ってくることで到達性を確認します。  

### arp(アープ)

ARPテーブルの管理に使用されるコマンドで、ARPテーブルの表示およびエントリの追加／削除の機能をもちます。  
IPアドレスから対応する機器のMACアドレスを得るARP(Address Resolution Protocol)と同名です。  

### netstat

自端末のTCP/IPネットワーク接続状況を調べるコマンドです。  
ルーティングテーブル、通信状態、通信相手、通信量などの情報が得られます。  

### ipconfig

自端末のネットワーク設定を表示するコマンドです。  
IPアドレスやサブネットマスクおよびデフォルトゲートウェイの情報などが得られます。  

### 名前解決コマンド

・nslookup : DNSサーバからの応答を見やすい形にして表示する  
・dig : 応答をほぼそのままの形で表示する  

DNSサーバの名前解決テストに使用されるコマンドは「nslookup」コマンドと「dig」コマンドです。  
どちらもホスト名を引数で与えることで、名前解決を手動で実行でき、ホスト名のIPアドレスの確認やDNSが正しく動作しているかどうかを調べることができます。  

### OpenFlow

既存のネットワーク機器がもつ制御処理と転送処理を分離したアーキテクチャです。  
制御部をネットワーク管理者が自ら設計・実装することで、ネットワーク機器ベンダの設定範囲を超えた柔軟な制御機能を実現できます。  

### SDN(Software-Defined Networking)

[1]  
OpenFlow上でソフトウェア制御による動的で柔軟なネットワークを作り上げる技術全般を意味します。  
SDNを用いると、物理的に接続されたネットワーク上で、 別途仮想的なネットワークを構築するといった柔軟な制御が可能になります。  

[2]  
ソフトウェア制御によって物理的なネットワーク構成にとらわれない動的で柔軟なネットワークを実現する技術全般を意味します。  

SDNを実現するための技術標準がOpenFlowプロトコルであり、既存のネットワーク機器がもつ制御処理(コントロールプレーン)と転送処理(データプレーン)を分離することで、OpenFlowコントローラが中央集権的に複数のスイッチの転送制御を管理します。  
OpenFlowではパケットやフレームをフローとして扱い、フローの様々な情報を使って柔軟に転送制御できるようになっています。  
スイッチはOpenFlowコントローラと通信を行いながら、OpenFlowコントローラから提供されるフローテーブルや直接の転送指示により転送先を判断します。  

![!](https://www.ap-siken.com/kakomon/30_aki/img/35.gif)  

### NFV(Network Functions Virtualisation，ネットワーク機能の仮想化)

仮想化技術を利用して、従来はルータ、スイッチ、ファイアウォール、ロードバランサなどの専用機器で行われていた機能を、汎用サーバ内の仮想マシン上で動くソフトウェアとして実装するアーキテクチャです。  
複数のネットワーク機器の機能を1つの物理サーバに集約できるため、コスト削減や信頼性向上などのメリットがあります。  

SDN(Software-Defined Networking)では、ネットワーク機器の機能のうち制御部だけをソフトウェア化しましたが、NFVでは機器ごと仮想化する点が異なります。  

![!](https://www.ap-siken.com/kakomon/30_haru/img/32.gif)  

### VNF(Virtual Network Function)

ネットワーク仮想化  
ネットワーク制御機能とデータ転送機能を実装したソフトウェアを，仮想環境で利用するための技術  

---

## ネットワーク応用

### MIME(Multipurpose Internet Mail Extension，マイム)

ASCII文字しか使用できないSMTPを利用したメールで、日本語の2バイトコードや画像データを送信するための仕組みです。  
S/MIME(Secure MIME)は、これに暗号化とディジタル署名の機能を付け電子メールの機密性と完全性を高めたものです。  

### Bcc(ブラインドカーボンコピー)

電子メールにおける送信先指定方法の1つで、toで指定した送信先以外に、メールのコピーを送信しておきたい相手を指定する機能のことです。  
この指定を用いると、toの相手及びbccで指定した相手に、自分以外の送り先のアドレスが通知されないため、  
toの相手とbccの相手の相互間で電子メールアドレスを知られたくない場合に使用します。  
メールソフトから送信元サーバへはbccヘッダを付加して送りますが、宛先に到着したときにbccのメールアドレスがメールヘッダ情報として見えてしまうと意味がないので、  
送信元メールサーバではメール送信時にbccヘッダを削除します。  

### Received

メールが到着するまでに経由したメールサーバの一覧を表します。

### CGI(Common Gateway Interface)

ユーザの入力した情報によって表示するWebページを変化させるなど、動的なWebページを作成するための仕組みです。  
Webサーバにおいて，クライアントからの要求に応じてアプリケーションプログラムを実行して，その結果をWebブラウザに返すなどのインタラクティブなページを実現するために，  
Webサーバと外部プログラムを連携させる仕組み。  
CGIはどのプログラム言語を用いても作成できますが、実際にはPHPやPerlが多用されているようです。  

### URL(Uniform Resource Locator)

WWW上において、情報の位置を示す住所のような文字列です。  
URLには、通信に使用するプロトコル名，サーバのホスト名(ドメイン)，ディレクトリ名，ファイル名，使用するポート番号などを記述します。  

### URLとURIの違い

プロになるためのWeb入門でやったのは覚えているがまとめていなかった。  

URLを拡張した概念としてURIが考えだされた。  
URLに加えてURNが追加されたものがURI。  
URI = URL + URN  

- URI(Uniform Resource Identifier)  
  宛先  
- URL(Uniform Resource Locator)  
  住所  
- URN(Uniform Resource Name)  
  名前

URNはインターネット上に存在する名前を一意に識別するために用意された物。  
URLはインターネット上の住所のような物。  
URLだけではリソースが引っ越してしまうと居場所がわからなくなってしまう。  
このような問題を解決するために、インターネット上に存在するリソースに対して統一的な名前を決めようと考えだされたのがURN。  
物理的にどのような位置にあろうと、同じURNで指し示すことができるという寸法。  

「位置」を示すURLと「名前」を示すURNとを統一的に表したものがURI。  
しかし、URNが利用される事はあまりなかったので、実質的にURIもURLも同じ意味で使われるようになった。  
世間的にはURLのほうが一般的かも。  

### サブネットマスク

IPアドレスをネットワークアドレスとホストアドレスに分割し，複数のより小さいネットワークを形成するために使用する32ビット(IPv4では)のビット列です。  
それぞれのIPアドレスとサブネットマスクをAND演算した結果が同じネットワークアドレスになれば同一のネットワークに属していることになります。  

サブネットがかかっている部分→ネットワークアドレス部  
サブネットかかっていない部分→ホストアドレス部  

192.168.30.32/28  
"192.168.30.32"の後方に付加されている"/28"は**アドレスプレフィックス**といい、先頭から何ビットまでがネットワークアドレスであるかを示す表記法です。  

### スーパーネット(ルート集約)

複数のネットワークアドレスを1つにまとめることを**ルート集約**といい、  
複数のIPアドレスを2進数表記にしたときに共通しているビット列の位置までサブネットマスクを左にずらすことでルート集約を行うことができます。  

二つのIPv4ネットワーク 192.168.0.0/23 と 192.168.2.0/23 をそれぞれ2進数表記にすると、

11000000 10101000 00000010 00000000  
11000000 10101000 00000000 00000000  

となり、上位から22ビットまでが共通のビット列であることがわかります。  
つまり共通している22ビット目までをサブネットマスクとした 192.168.0.0/22 がルート集約後のネットワークになります。  
この操作は共通している22ビット目までをサブネットマスクとし、  
それ以後をホストアドレスとして使用することで2つのネットワークを内包する1つのIPネットワークを定義していると考えることができます。  

### マルチホーミング

インターネット回線を複数ISPの回線で接続し、1つの回線が切れてもほかの回線で通信し続けられるようにすることで、耐障害性の向上や負荷分散を行う仕組みです。  

### DNSラウンドロビン

DNSの機能を使用した負荷分散と言えば「DNSラウンドロビン」です。  
具体的には、以下のように同じホスト名に対して複数のAレコードを設定することで、アクセスを複数のコンピュータに（単純に順繰りに）振り分けます。  

``` txt
www IN A 200.x.y.1
www IN A 200.x.y.2
www IN A 200.x.y.3
```

DNSの機能では死活監視ができず、1つのWebサーバがダウンしてもアクセスを分配し続けてしまうため、可用性対策としては負荷分散装置に劣ります。

### ロードバランサー

[【図で理解】ロードバランサーとは？負荷分散の仕組みを解説](https://www.kagoya.jp/howto/it-glossary/network/loadvalancer/#:~:text=%E3%83%AD%E3%83%BC%E3%83%89%E3%83%90%E3%83%A9%E3%83%B3%E3%82%B5%E3%83%BC%E3%81%A8%E3%81%AF%E3%80%81%E3%81%9D%E3%81%AE%E5%90%8D,%E3%81%8C%E3%81%A7%E3%81%8D%E3%81%9F%E3%82%8A%E3%81%97%E3%81%BE%E3%81%99%E3%80%82)  

>ロードバランサーとは、その名の通りサーバーにかかる負荷を、平等に振り分けるための装置のことを指します。  
>これによって1つのサーバーにかかる負担を軽減したり、停止状態を防ぐことができたりします。  
>※ロードバランサーでSSLアクセラレーターを使用することにより、本来サーバーごとに必要なSSL証明書を1本化したり、暗号化通信の負荷を軽減できたりします。  

![!](https://www.ap-siken.com/kakomon/30_aki/img/pm05_3.gif)  

H30A  
LB（ロードバランサ）を使用したシステム構成の場合、クライアント（各部署のPC）はWebサーバのIPアドレスではなく、LBのIPアドレス宛にパケットを送付します。  
その後LBは、どのWebサーバにパケットを振り分けるかを決定して、サーバにパケットを送付します。  
Webサーバは、LBから送付されたパケットを処理して応答結果をLBに送付します。  
その後、LBからクライアントに応答結果が送付されるという流れになります。  
LBは受信したパケットの送信元IPアドレスを書き換えます。  

※LBの負荷分散方式としては、ラウンドロビン方式の他にリーストコネクション方式（コネクション数が最少のサーバに振り分ける）があります。  

### IEEE802.1X

H31S,H26S  
LAN内のユーザ認証の方式を定めたIEEE規格で、正当な端末以外がLANに参加することを防ぐ技術です。  
当初は有線LAN向けとして策定されていましたが、その後にEAP(Extensible Authentication Protocol)として実装され、現在では無線LAN環境(IEEE802.11)における標準の認証機構として利用されています。  
TLS(クライアント証明書)、S/key、MD5によるチャレンジレスポンスなど様々な認証方式をサポートしています。  

IEEE802.1Xの認証システムでは、認証を受けるクライアントである「サプリカント(supplicant)」、RADIUSなどの「認証サーバ(authentication server)」、RADIUSクライアントの機能を持ち、認証サーバ間の認証プロセスを相互に中継する認証装置(認証スイッチ)である「オーセンティケータ(authenticator)」の3つの要素で構成されます。  

![!](https://www.ap-siken.com/kakomon/26_haru/img/pm05_5.gif)  

### ICMPリダイレクト

L3SWやルータが特定のネットワーク宛てのパケットに関してよりよい経路情報を送信元に伝達するために使用されるメッセージです。  
本問のケースで言えば、ネクストホップが設定されたL3SW1は、送信元に対し 172.16.2.251 が適切な転送先である旨のICMPリダイレクトメッセージを返します。  
これを受け取った送信元（PC）は、ICMPリダイレクトを解釈し次からサーバ宛てのパケットを 172.16.2.251（つまりL3SW2）に転送するようになります。  

### ドメインって結局なに？

ドメインとは？  
インターネット上の「住所」に当たるものが「IPアドレス」ですが、IPアドレスをわかりやすく文字列にしたものが「ドメイン」です。  

URLとかのドメインのほう。  
DNSで名前解決の時に使うあれ。  

---

## ネットワーク方式

### LTE(Long Term Evolution)

第三世代携帯電話(3G)を拡張した通信規格であり、下り最大100Mbps以上、上り最大50Mbps以上という家庭用ブロードバンドに匹敵する高速通信が可能な携帯電話用の通信規格です(速度は理論値)。  
日本では2012年より各キャリアによりサービスが開始され、2018年現在、一般的な移動通信規格になるに至っています。  
LTEの仕様は標準化団体である3GPP(3rd Generation Partnership Project)にて標準化されました。  
MIMO(Multiple Input Multiple Output)とは、無線通信において送信データを複数のストリームに分割し、それぞれを複数のアンテナで送受信することで高速に伝送する技術です。  

### VoIP(Voice over Internet Protocol)

音声を各種符号化方式で圧縮しパケットに変換した上でIPネットワークでリアルタイム伝送する技術です。

### MAC(Media Access Control)

LANの媒体アクセス制御を行うデータリンク層の副層のことです。  
イーサネット用のCSMA/CDやトークンリング用のトークンパッシングなどがあります。  

### MDM(Mobile Device Management,携帯端末管理)

企業や団体が、自組織の従業員に支給する複数のスマートフォンやタブレット端末を遠隔から一元管理する仕組みのことです。

### RADIUS(Remote Authentication Dial In User Service)

認証情報と認証手続き、および利用ログの記録(アカウンティング)をネットワーク上のサーバに一元化することを目的としたシステムです。

### NAPT(Network Address Port Translation)

プライベートIPアドレスとグローバルIPアドレスの相互変換するNATの考え方にポート番号を組み合わせた技術です。  
ホストごとにユニークなポート番号を割り当てることで、1つのグローバルIPアドレスで複数のプライベートIPアドレスを持つノードを同時にインターネット接続させることが可能です。  

パケットを内部から外部に中継する場合は、パケットの送信元プライベートIPアドレスをルータ(またはファイアウォール)自身のグローバルIPアドレスに変換するとともに、  
送信元ポート番号に任意の空いているポートを割り当てます。逆に外部から内部に応答パケットを中継する場合は、  
「宛先IPアドレスと宛先ポート番号に送信時に保存しておいたプライベートIPアドレスとポート番号を設定」し、内部のノードにパケットを通します。  

![!](https://www.ap-siken.com/kakomon/31_haru/img/31a.gif)  

### LPWA

LowPower=省電力、WideArea=広範囲の名称の通り、省電力・広範囲を特徴とする無線通信規格の総称です。  
伝送速度は遅いものの、Wi-fiやBluetoothが届かない数キロメートルから数十キロメートル間の通信をカバーします。  
LPWA規格には、SIGFOX、LoRaWAN、Wi-SUN、NB-IoT、Cat-M1などがあります。  

IoT(Internet of Things)では、制御や情報取得のために各所に散りばめられたデバイス同士が通信を行うことになります。  
この個々の通信はそれほど大きいデータ量ではないので、LPWAの低い伝送速度が問題になることは余りありません。  
それよりも小型化が進むデバイスのバッテリー消費を抑えられることがIoTにおける強みとなります。  
このような理由から、LPWAは小型デバイスを多数配置した広範囲のIoTネットワークの運用を実現する手段として期待されています。  

### PoE(Power over Ethernet)

イーサネットのLANケーブルを通じて電力を供給する技術です。  
屋外に設置されるネットワークカメラや、天井や壁に設置される無線LANアクセスポイントのように、電源コンセントがない又は電源配線が難しい場合に利用されます。  
利用にはPoEに対応した機器が必要です。  

### PLC(Power Line Communications)

電力線を通信回線としても利用する技術です。  

### BLE(Bluetooth Low Energy)

無線通信規格Bluetoothの一部で、その名前の通り低消費電力に特化した通信モードのことです。  
通信速度は低速ながら、ボタン電池1個で数カ月から1年程度稼働できるほど省電力性に優れ、低コストであることからIoTネットワークでの活用が期待されています。  
最大通信距離は選択する速度によって異なり10ｍ～400ｍ程度です。  

### フォワードプロキシ

Webブラウザの代理として，Webサーバに対するリクエストを送信する。  
プロキシサーバは、内部ネットワーク内の端末からの要求に応じてインターネットへのアクセスを代理する装置です。  
単にプロキシともいいます。  
プロキシサーバを設置すると、キャッシュ機能によるレスポンス向上、認証やフィルタリングによるセキュリティ、内部ネットワークの秘匿化などの効果を期待できます。  

![!](https://www.ap-siken.com/kakomon/01_aki/img/35.gif)  

### リバースプロキシ

クライアントとWebサーバの間のWebサーバ側に位置し、Webサーバを代理する形でクライアントからのリクエストを受け取り、そのリクエストをWebサーバに受け渡す仕組みです。  
クライアントからのリクエストは必ずリバースプロキシを経由するので、リバースプロキシにアクセス制御や認証などの機能をもたせることで、Webサーバのセキュリティ向上が期待できます。  

![!](https://www.ap-siken.com/kakomon/31_haru/img/35.gif)  

### 3ウェイハンドシェイク

TCPがコネクションを確立する手順は次のようになっています。  
(説明中で〇〇パケットとしていますが、正確にはTCPヘッダ中のコントロールフラグの〇〇を1に設定したパケットです)  

1. 要求元から要求先に対してSYNパケットを送信する（接続要求）。  
2. SYNパケットを受信し要求先は、要求者の接続を許可することを表すSYN/ACKパケットを送信する（接続許可）。  
3. SYN/ACKパケットを受信した要求元は接続開始を表すACKパケットを要求先に送信し、相手との通信を開始する（コネクション確立）。  

![!](https://www.ap-siken.com/kakomon/01_aki/img/pm05_4.gif)  

### Keep-Alive

HTTP/1.1では目的の通信が終わった後もTCPコネクションを一定時間維持し、連続した要求が来たときは前回の接続を再利用することで、  
毎回TCPコネクションを確立する無駄を省いています。  
この仕組みを「Keep-Alive」といいます。  

### ISDN (Integrated Service Digital Network : サービス総合デジタル網)

<https://www.tramsystem.jp/voice/voice-2065/>

・電話線を使用したデジタル回線のインターネット通信技術  
・ISDNとINSはほぼ同じ意味。ISDNは国際規格名。INSはNTTの国内サービス名  
・ADSL(Asymmetruc Digital SubScriber Line)(非対称デジタル加入者線)との違い  
  ・ISDNがデジタル回線を使用するのに対し、ADSLはアナログ回線の一部を使用する。  
  ・ADSLは上りと下りの速度が大きく違う(非対称)  
  ・速度はADSLが上だが、安定性はISDNのほうが上  
・安定性があり、理論値がほぼ出るので、企業間の簡素なデータ通信では役に立つ。実際現在でもつかわれている模様。  
・ただ、やっぱり通信速度が遅いのと、使用料金が高いので廃れていき、2024年に廃止が決定された。  

ISDNの前が電話回線を使ったインターネット。  
電話をしている最中にFAXを使えないとか、誤り訂正ができないなど、さんざんなものだったはず。  
それからISDN→ADSL→光となって行ったとおもわれる。  

・ほぼ理論値がでて安定するが、料金が高く、通信速度が遅い。  
・なので、大した量は送らないけど、安定が必要な場面ではまだ使われている。  
・2024年にサービス終了。  

### ADSL (Asymmetric Digital Subscriber Line : 非対称デジタル加入者線)

・電話回線を使う。  
・上りと下りで速度が違う。  

### VLAN (Virtual LAN)

VLANとは、一つの構内ネットワーク（LAN）内に、物理的な接続形態とは独立に機器の仮想的なグループを設定し、それぞれをあたかも一つのLANであるかのように運用する技術。  

LANスイッチ（スイッチングハブ）の機能の一つで、接続された機器を管理者の設定した任意の数のグループに分け、ネットワークを分割することができる。  
これにより、各機器はそれぞれのグループの範囲内でのみ直接通信できるようになり、ブロードキャストフレーム（宛先に全機器を指定したデータ）による回線の混雑を緩和することができる。  

また、複数のスイッチにまたがる大規模なネットワークをVLANに分割することもでき、多数の機器を一つのフラットなネットワークに繋いで管理することができる。  
端末を使用する従業員の所属先に応じて参加するネットワークを切り替えるなど、物理的な配線に縛られずに柔軟にネットワークを構成・変更することができる。  

人員の異動や機器の入れ替え、移転の際にも機器の配置や配線を気にすることなくVLANの設定を確認・変更するだけで済む。  
利用者は組織内の自分に無関係なネットワークへは直接接続できないようなるためセキュリティを向上させる効果もある。  

``` txt : 早見表
種類                 |  説明
---------------------|------------------------------------------------------------------------------------
ポートベースVLAN     | スイッチのどの穴に線を挿すかで、どのネットワークに所属するかが決まるやり方
MACベースVLAN        | コンピュータのMACアドレスによって、どのネットワークに所属するかが決まるやり方
サブネットベースVLAN | コンピュータのIPアドレスによって、どのネットワークに所属するかが決まるやり方
ユーザベースVLAN     | 使うときに認証を行い、その認証されたユーザによって、コンピュータがどのネットワークに所属するかが決まるやり方
プロトコルベースVLAN | 通信の種類（通信プロトコル）によって、コンピュータがどのネットワークに所属するかが決まるやり方
タグVLAN             | データにそのデータが所属するネットワークの情報を付与し、制御する側はその情報を見て所属するネットワークを判断するやり方
マルチプルVLAN       | ネットワークを掛け持ちしてる奴がいるVLAN。実際にはポートベースVLANやタグVLANを使って実現する
```

### ポートベースVLAN

ポートVLANとは、VLAN（仮想LAN/バーチャルLAN）の方式の一つで、一台のネットワークスイッチ（スイッチングハブ）の差込口（ポート）を単位に、物理的な回線でグループを構成する方式。VLANのうち最も単純な手法である。  

スイッチに並んだケーブルの差込口のそれぞれに、所属するVLANの番号（ID）を割り当てていく。  
IDは通常、1から4094の任意の整数が用いられる。同じVLAN IDのポート間は接続・通信することができるが、他のIDのポートとは通信が遮断される。この方式では一つのポートが複数のVLANに所属することはできない。  

複数のスイッチ間でも、同じVLAN IDを設定したポート同士をケーブルで接続すれば、両スイッチの同じVLAN IDのポートに接続された端末間で相互に通信することができる。  
ただし、接続はVLANごとに行わなければならないため、VLANの数やスイッチの台数が増えるとスイッチ間接続に必要なポートが急激に増えてしまう。  

ポートVLANはスイッチ内で設定が完結するため端末側が特定の仕様や技術に対応している必要がなく、ほとんどのスイッチが対応しておりスイッチ間の互換性の問題もほとんどない。  
小規模で単純な構成のネットワークでVLANを導入したい場合に用いられることが多い。  

### タグVLAN

タグVLANとは、VLAN（仮想LAN）の方式の一つで、ネットワークを流れる個々のフレームに転送先のグループの識別番号を付与する方式。  

LAN上を流れるデータはフレーム（MACフレーム/Ethernetフレーム）と呼ばれる単位で送受信されるが、タグVLANでは各フレームの先頭部分にある送信元や宛先などの制御情報が記述されたヘッダ内の特定の箇所にVLAN番号（VLAN ID）を記す。  

各端末はフレームの送信時にVLAN番号を付与して送信し、ネットワークスイッチはこれを見て同じグループに所属する端末へフレームを転送する。  
異なるVLANの端末へはフレームを送らない。  

ヘッダ内でのVLAN IDの記述方式はIEEE 802.1Qという規格によって標準化されており、異なるメーカーの機器をまたいで共通して利用することができる。  

ネットワークスイッチのポート単位でグループを構成する「ポートVLAN」（ポートベースVLAN）方式に比べ、複数のスイッチをまたいで共通のVLANグループを構成することができ、同じポートを複数の端末が使用する場合でもそれぞれ別のVLANの所属させることができる。  

[わかりそう](https://wa3.i-3-i.info/word12091.html)  

---

## ネットワーク方式 問題

### 令和2年秋期　問32

図のようなネットワーク構成のシステムにおいて，同じメッセージ長のデータをホストコンピュータとの間で送受信した場合のターンアラウンドタイムは，端末Aでは100ミリ秒，端末Bでは820ミリ秒であった。上り，下りのメッセージ長は同じ長さで，ホストコンピュータでの処理時間は端末A，端末Bのどちらから利用しても同じとするとき，端末Aからホストコンピュータへの片道の伝送時間は何ミリ秒か。ここで，ターンアラウンドタイムは，端末がデータを回線に送信し始めてから応答データを受信し終わるまでの時間とし，伝送時間は回線速度だけに依存するものとする。

``` txt
2つの回線の速度差に着目して答えを導いていきます。

まずホストコンピュータでの処理時間を求めます。
伝送時間はターンアラウンドタイムからホストコンピュータの処理時間を差し引いた時間なので、ホストコンピュータの処理時間を a とすると、次のような式で表せます。
端末A：(100－a)ミリ秒
端末B：(820－a)ミリ秒
この値と2つの回線速度の速度差が「10倍」であることを利用すると

　(100－a)×10＝820－a

という方程式を立てることができます。この式を解きホストコンピュータでの処理時間を導きます。

　(100－a)×10＝820－a
　1000－10a＝820－a
　180＝9a
　a＝20ミリ秒

上り、下りのメッセージ長は同じ長さですから、端末Aのターンアラウンドタイムからホストコンピュータでの処理時間を差し引いて、それを半分にすれば片道の伝送時間がわかります。

　(100－20)÷2＝40ミリ秒
```

---

## IEEE802.3規格

![!](https://www.ap-siken.com/kakomon/03_aki/img/pm05_5.gif)  

### UTPケーブル (Unshielded Twisted Pair cable) 非シールドより対線

UTPケーブルとは、撚り合わせた一対の金属線により電気信号や電力を伝える通信用ケーブルの構造の一つで、電磁ノイズを遮断するシールド加工を行っていないもの。  
電話回線やコンピュータネットワーク用の通信ケーブルとして最も広く普及している。  

UTPケーブルはより対線の中で最も簡易な構造のケーブルで、各対あるいは最外周に金属メッシュやホイルなどのシールドを施さず、絶縁体の柔らかい合成樹脂などでできた被覆（シース）のみで外界と隔てられている。  

ケーブル内外の電磁波の通過を特に妨げないため、信号やノイズが外部に漏れやすく、また、外部の他の機器やケーブルの放つノイズの影響を受けやすいが、構造が単純で部材が少ないため最も安価である。  
極めて高い周波数による通信が必要な場合や、工場など特殊な環境でなければ、ほとんどの場合UTPケーブルで事足りる。  

### STPケーブル (Shielded Twisted Pair cable) シールド付きより対線

STPケーブルとは、撚り合わせた一対の金属線により電気信号や電力を伝える通信用ケーブルの構造の一つで、電磁ノイズを遮断するシールド加工を行ったもの。  
コンピュータネットワーク用のケーブルとして、高い周波数が必要な規格やノイズの多い環境で用いられる。  

STPケーブルはより対線とケーブル外周の被覆（シース）の間に金属製のシールドが挿入されており、外部への電磁波の漏洩や外部のノイズ源からの干渉による信号の減衰や乱れを防ぐことができる。  
シールドのないUTPケーブルに比べ高価で、シールドをアースしなければ遮蔽効果がないため、使用できる機器が限られ、扱いも難しい。  
主にUTPでは対応が難しい工場内などノイズの多い環境や、極めて高い周波数で高速な通信を行う規格などで用いられる。  

コネクタもUTP用のRJ45（8P8C）ではコネクタ部から干渉を受けてしまうため、コネクタ部をシールドで覆って機器側でアースする構造のTERAやGG45などの規格が用いられる。  
金属線ケーブルの特性を定めた標準規格のカテゴリ6Aやカテゴリ7では、極めて高い周波数の信号を伝送しなければならないため、STPケーブルを用いるのが基本とされている。  

### ツイストペアケーブル(twisted pair cable：より対線)

ケーブルの一種で、絶縁された二本の銅の線材を撚り合わせたものを何対か束ねて一本のケーブルとしている。  
よく使われるのは2対4本を束ねた4線式（4芯式）と4対8本を束ねた8線式（8芯式）である。  

### 1000BASE-T (IEEE 802.3ab) せんベースティー

1000BASE-Tとは、最高通信速度1GbpsのGigabit Ethernet規格の一つで、UTPケーブル（非シールドより対線）を利用するもの。  
1999年にIEEE 802.3abとして標準化された。  

広く普及している100Mbpsの100BASE-TXと同じ、カテゴリ5e（CAT5e、エンハンストカテゴリ5）以上のUTPケーブルを使用する規格で、4対8芯の信号線すべてで通信する。  
最大伝送距離は100m。  

Gigabit Ethernet規格の中では最も人気があり、従来100BASE-TXが用いられてきた企業内LANや家庭内LANなどで、これを置き換える形て普及が進んでいる。  
1000BASE-T対応のスイッチングハブなどの多くは100BASE-TXと両対応となっており、従来機器との混在も可能であることも普及を後押ししている。  

### 1000BASE-X (IEEE 802.3z)

1000BASE-Xとは、最高通信速度1GbpsのGigabit Ethernet規格のうち、主に光ファイバーケーブルを使用する規格群の総称。  
IEEE 802.3zとして規定された3つの規格を指すことが多いが、これ以外の光ファイバーを使用するGigabit Ethernet仕様を含む総称として用いられることもある。  

### FTTH (Fiver To The Home)

光ファイバーを伝送路として一般個人宅へ直接引き込む、アクセス系光通信の網構成方式のこと。  
もとは、一般家庭に光ファイバーを引き、電話、インターネット、テレビなどのサービスを統合して提供する構想の名称だったが、転じて、そのための通信サービスの総称として用いられるようになった。  

### カテゴリー

``` txt
カテゴリ | 最大周波数 | 主な用途
---------|-----------|-----------------------------------
Cat1     | 1MHz        電話線
Cat2     | 4MHz        低速なデータ通信用
Cat3      16MHz        Ethernet(10BASE-T)
Cat4      20MHz        TokenRing(16Mbps)
Cat5      100MHz       Fast Ethernet(100BASE-TX)
Cat5e     100MHz       Gigabit Ethernet(1000BASE-T)
Cat6      250MHz       Gigabit Ethernet(1000BASE-T/TX)
Cat7      600MHz       10Gigabit Ethernet(10GBASE-T)
```

---

## IEEE 802.11規格

Wi-Fi（無線LAN）には、「IEEE 802.11」という国際的な標準規格があります。  
現在一般的に普及している通信規格は、「IEEE 802.11a」「IEEE 802.11b」「IEEE 802.11g」「IEEE 802.11n」「IEEE 802.11ac」の5種類があり、略して「802.11a」や「11a」などと呼ばれることもあります。  

ネットワークにおけるOSI参照モデルで言う、物理層とデータリンク層（MACレイヤ）の規格となる。  

### Wi-Fi

「Wireless Fidelity(ワイヤレス機器の相互接続性を保証する)」の略で、「Wireless」＝無線、「Fidelity」＝忠実という意味。  
無線LANアダプターのブランド名で、米国の業界団体、Wi-Fiアライアンスが機器間の相互接続性を認定したことを示す。（デジタル大辞泉より引用）  

無線LANの中でも業界団体が認める基準を満たしたブランド名となっています。  
その規格を使用する無線LANに関する登録商標である。  

Wi-Fiの由来は諸説あるそうで、音楽や放送の世界では、もとの音を忠実に再現できることをHigh Fidelity（Hi-Fi＝ハイファイ）をもじって、「Wi-Fi」と名付けたという由来もあるそう。  

### 規格表

それぞれ最大通信速度や周波数帯などの特徴が異なります。  
各規格の策定時期と最高通信速度、使用できる周波数帯の関係は次のとおりです。  

``` txt
IEEE規格      | 世代名  | 策定時期   | 最大通信速度 | 周波数帯
--------------+---------+------------+-------------+--------------
IEEE 802.11a  |         | 1999年10月 | 54Mbps      |  5GHz
IEEE 802.11b  |         | 1999年10月 | 11Mbps      |  2.4GHz
IEEE 802.11g  |         | 2003年6月  | 54Mbps      |  2.4GHz
IEEE 802.11n  | Wi-Fi 4 | 2009年9月  | 600Mbps     |  2.4GHz/5GHz
IEEE 802.11ac | Wi-Fi 5 | 2014年1月  | 6.9Gbps     |  5GHz
IEEE 802.11ad | WiGig   | 2013年1月  | 6.8Gbps     |  60GHz
IEEE 802.11ax | Wi-Fi 6 | 2021年2月  | 9.6Gbps     |  2.4GHz/5GHz/6GHz
```

### IEEE802.11n (Wi-Fi 4)

11nは、アンテナ1本あたり約150Mbpsでの通信を可能としており、それを4本まで束ねることができます。  
アンテナを束ねることにより、最大600Mbpsの通信速度を実現します。ただし、実測値（実際に送受信されるデータ量）は理論値の半分～3分の1ほどといわれています。  
Wi-Fiルーターやパソコンではアンテナを2～3本、スマホやタブレット、携帯ゲーム機ではアンテナを1～2本を搭載している製品が多く、ほとんどの製品が最大速度を約80Mbpsや約240Mbpsとしています。  

11nは、2.4GHz帯と5GHz帯の双方の周波数帯を使うことができるという特徴があります。  
2.4GHz帯の電波は、電子レンジなどさまざまな家電も利用しており、干渉し合って通信速度が遅くなったり不安定になったりする点はデメリットです。  
その代わり、2.4GHz帯の電波は壁などの障害物があっても遠くまで届きやすい性質があり、Wi-Fiルーターと端末を違う部屋に設置している場合は有利といえるでしょう。  

5GHz帯を利用する機器は、現在のところWi-Fiルーター以外にないので、5GHz帯を利用することで電化製品が多い部屋でもノイズの影響を受けにくく、安定した通信を行えるメリットがあります。  
ただし、壁などの障害物があると、電波が届きにくくなります。5GHz帯を使っているのに通信速度が遅いと感じるときは、Wi-Fiルーターの配置を工夫してみるといいでしょう。  

### IEEE802.11ac (Wi-Fi 5)

11acは、11nの10倍以上の高速通信が可能なWi-Fi（無線LAN）規格です。  
2013年にWave1（第一世代）が登場し、2015年にさらに高速なWave2（第二世代）が登場しました。  

11acは11nと比べて、帯域幅（速度制限）や信号（データ量）などがパワーアップしたことにより、高速化を実現しています。  
例えば、11nの帯域幅（一度に送れるデータの量）は20～40MHzですが、11acの帯域幅は80～160MHzに引き上がっています。  
また、1つの信号に含まれる情報量は、11nが6ビット（64QAM）なのに比べて、11acでは8ビット（256QAM）に増えています。  

11acは、アンテナ1本あたり約867Mbpsでの通信を可能としており、それを8本まで束ねることができます。  
アンテナを束ねることにより、最大約6.9Gbpsの通信速度を実現します。  
ただし、この最大速度を活かせるWi-Fi（無線LAN）機器は、家庭向けの製品としては売られていません。  
また、実測値は理論値の半分～3分の1ほどといわれています。  
Wi-Fiルーターやパソコンではアンテナを2～3本、スマホやタブレット、携帯ゲーム機ではアンテナを1～2本を搭載している製品が多く、ほとんどの製品が最大速度を約433Mbpsや1.3Gbpsとしています。  

11acが使うのは5GHz帯の電波ですので、家電などの影響を受けにくく、安定した高速通信を実現することができます。  
11acの電波は障害物にぶつかるとやや弱くなりますが、Wi-Fiルーターの配置を工夫するなどの対策をすることで改善できる場合もあります。  

なお、11nと11acは規格が異なりますが、互換性があるため通信することが可能です。  
11nのWi-Fiルーターに11ac対応のパソコンやスマホをつなぐこともできますが、接続は11nのため、11acの通信速度を活かすことはできません。  

![!](https://www.ap-siken.com/kakomon/03_haru/img/33.gif)  
![!](https://www.ap-siken.com/kakomon/03_haru/img/33a.gif)  

### IEEE802.11ad (WiGig)

11adはこれまでのWi-Fiの通信規格と異なり、60GHzという周波数帯を利用します。  
「11ad」＝「WiGig（ワイギグ）」と表記されている場合もあります。  
60 GHzという高い周波数帯を使うため、壁や障害物のない、10 m程度の近距離でのギガビット通信を想定している。  

2019年6月現在、「11ad」に対応したWi-FiルーターならびにWi-Fi子機の製品はまだ数が少ないため、一般家庭ではあまり普及していません。  

### IEEE802.11ax (Wi-Fi 6)

IEEE 802.11axとは高効率ワイヤレスを目指した、Wi-Fi仕様標準の1つであり 、Wi-Fi AllianceによりWi-Fi 6として認定されている。  

CES 2018で発表されたIEEE 802.11ax対応デバイスは、合計11 Gbit/sの理論データレートをサポートしている。  
高密度利用環境下の場合、従来規格IEEE 802.11acに対して、平均スループットは4倍、遅延は75％低下することが報告されている。  

周波数のより効率的な利用のため、IEEE 802.11axでは、**直交周波数分割多重アクセス (OFDMA)**、1024-QAM変調、干渉を回避するため電力制御方式が導入された。  
また、MIMOおよび**MU-MIMO**により、スループットが従来規格よりも向上し、**Target Wake Time**の導入による消費電力性能の向上や、**WPA3**の採用によるセキュリティの向上が図られている。  

### OFDMA (Orthogonal Frequency Division Multiple Access)

OFDMAとは、同一の通信路を複数の通信主体で混信することなく共用するための多元接続（多重アクセス）技術の一つで、周波数分割多重化（FDM）の一種であるOFDMを応用したもの。  
LTEや5G、WiMAX、IEEE 802.11ax（Wi-Fi 6）などで利用されている。  

OFDMは隣り合う周波数の搬送波同士の位相を互いに直交させて周波数帯域の一部を重なり合わせ、高密度な周波数分割を行う手法で、割り当てられた周波数帯の中に多数の狭い帯域の搬送波（サブキャリア）を形成することができる。  

OFDMAはこれと時分割多元接続（TDMA）を組み合わせた方式で、各サブキャリアの使用権をミリ秒単位の極めて短い時間ごとに分割し、異なる通信主体に割り当てる。  
各端末の電波状況に応じてきめ細かく割り当てを変化させることができ、効率よく電波を活用することができる。  

### MU-MIMO (Multi-User MIMO) マルチユーザMIMO

MU-MIMOとは、無線通信で複数のアンテナを同時に用いて伝送経路を増加させるMIMO技術を応用し、複数の利用者と同時刻に同じ周波数で通信する方式。  
無線LAN（Wi-Fi）などで実用化されている。  

MIMOは通常は不可能な同時刻に同じ周波数で複数の異なる信号を伝送する技術で、送信側も受信側も複数のアンテナを少しずつ離して設置し、送信側は各アンテナがそれぞれ別の信号を送信、受信側は各アンテナに届いた合成波の差異を元に信号を分離、復元する。  

MU-MIMOではこれを応用し、アクセスポイントや基地局など複数の端末と同時に通信しなければならない機器が複数のアンテナを用いて各機器向けの信号を送信する。  
受信側には自分以外の近隣の端末向けの信号も合成された状態の電波が届くが、事前に測定した特性から自分向けの信号だけを分離して取り出す。  

MU-MIMOは基地局側と端末側の双方が通信制御に対応している必要があるが、基地局にアンテナが複数あれば、端末のアンテナは1本でも利用することができる。  
端末に複数のアンテナがある場合はMU-MIMOを行いつつ通常のMIMOで通信速度を向上させることもできる。  

### TWT(Target Wake Time)

従来の省電力技術に加えて、端末ごとに起動するタイミングを指定できるTWT（Target Wake Time）方式が追加され、各端末が自分に必要な時間だけ通信し、あとはスリープ状態で電力消費を抑えることができる。  

この以前のパワーセーブではDTIMで設定した「ウェイクアップ」のタイミングでアクセスポイントに接続する全ての端末が仮眠（スリープ状態）から起こされるため、アクセスポイントの設定によっては、端末の電力消費が早くなったりということもあり得たのです。  

Wi-Fi 6のTWTでは、複数の端末が圏内にいることを初めから想定しており、端末がいつスリープしていつ起きるのか、その間隔を端末ごとにネゴシエーション（合意）してスケジュールを設定します。  

つまり、端末がウェイクアップするタイミングは、他の端末が起きるタイミングに影響されなくなるわけです。  
これによって、端末の消費電力と電池寿命を延ばすことにつながっています。  

### 周波数帯の特徴

#### 2.4GHz

【メリット】  
壁や天井などの障害物に強く、離れた部屋でも比較的通信が届きやすい  

【デメリット】  
同じ周波数帯を利用する機器が多いため、電波干渉により接続状況が不安定になったり、通信速度が低下しやすい  

#### 5GHz

【メリット】  
無線LAN専用の周波数帯のため近隣住居や他の家電製品の電波干渉を受けにくく、接続状況が安定しやすく、通信速度の向上を見込める  

【デメリット】  
壁や天井などの障害物に弱く、2.4GHzより通信距離が短い  

#### 60GHz

【メリット】  
あまり使用されない周波数帯のため、近隣住居や他の家電製品からの電波干渉を受けにくい  

【デメリット】  
5GHz帯より障害物に弱く、通信距離も10メートル程度と短いため、別室や屋外で利用する通信端末には不向き  

### チャネル

無線LANネットワークでは、近接するネットワークとの電波干渉を避けるために、使用する周波数帯をネットワークごとに微妙にずらすことが可能になっています。  
このときに設定する値をチャネル（チャンネル）といいます。  

2.4GHz帯を使用するIEEE802.11gでは1～13のチャネル（11bでは1～14）を選択できますが、1つのチャネルの周波数帯域は22MHz、各チャネルは5MHzずつ区切られているので、近接するチャネル同士は周波数帯が一部重なっていて電波干渉が起きます。  
このため、近くの無線LANネットワークで同じまたは近接するチャネルが使用されていると通信が不安定になってしまうという特性があります。  
なお、5GHz帯を使用する無線LAN規格では各チャネルの周波数帯は完全に独立しているので、近接するチャネルを設定しても2.4GHz帯のような電波干渉は起きません。  

![!](https://www.ap-siken.com/kakomon/03_haru/img/36.gif)  

※アクセスポイント相互の電波の干渉を避けるために，隣り合うアクセスポイントには，例えば周波数チャネル番号1と6，6と11のように離れた番号を割り当てるのがよい。  
2.4GHz帯ではチャネルが5つ以上離れていないと電波干渉が起こるので、通信範囲が重なり合うアクセスポイントには、1、6、11などの離れた番号を割り当てる必要があります。  

### SSID(Service Set Identifier)

無線LANの規格であるIEEE802.11系において「混信」を避けるためにアクセスポイントと端末に設定されるネットワーク識別子です。  
SSIDには最長で32文字の任意の英数字を設定できます。  
通信を行う端末とスイッチがコードで接続されている有線LANと異なり、無線LAN環境では1つの端末が複数のアクセスポイントと通信できてしまう「混信状態」が発生し得ます。  
これを回避するため、無線LANではアクセスポイントと端末にそれぞれSSIDを設定し、SSIDが一致する機器同士しか通信ができないようにアクセス制御を行っています。  

※最長32オクテットのネットワーク識別子であり，接続するアクセスポイントの選択に用いられる。  
※SSIDはホスト識別子ではなくネットワーク識別子です。  

---

## 難しかった問題・残しておきたい問題

**平成28年秋期　問34**
図はNTPによる時刻合わせの基本的な仕組みを表している。NTPサーバからの応答には，NTPサーバでの問合せ受信時刻と，応答送信時刻が含まれており，PCは図に示した四つの時刻からサーバ時刻とのずれを計算する。このとき，PCの内部時計はNTPサーバの時計と比べてどれだけずれているか。ここで，伝送遅延は問合せと応答で等しいものとする。また，図中の時刻は，PCとNTPサーバのそれぞれの内部時計の時刻であり，aa:bb:cc.dddddd は aa時bb分cc.dddddd秒 (ddddddはマイクロ秒)を表す。
→
まず、4つの時刻から問合せ・応答の伝送遅延時間を求めます。
PCの問合せ送信から応答受信までが(900-100=)800マイクロ秒、NTPサーバの問合せ受信から応答送信までが(400-200=)200マイクロ秒なので、問合せ・応答の往復に要した伝送時間は、以下のように計算できます。
　800－200＝600(マイクロ秒)
設問にて「伝送遅延は問合せと応答で等しい」と示されているため、問合せと応答の際の伝送遅延は各々300マイクロ秒とわかります。
次に、求めた伝送遅延時間を用いて時刻のずれを計算します。
NTPサーバの応答送信時刻が aa:bb:cc.000400 なので、これに伝送遅延の300マイクロ秒を足した aa:bb:cc.000700 がPCの応答受信時刻になるはずです。
しかしPCの応答受信時刻は aa:bb:cc.000900 を示しているため、時計のずれが生じていると判断できます。PCとNTPサーバの時計の差は次のように導けます。
　900－700＝＋200(マイクロ秒)
→
300マイクロ秒の差があるなら、問い合わせ開始時間と問い合わせ受信時間のズレに納得がいかないと思ったけど、
最初から200マイクロ秒ずれていると考えたら辻褄は合う。
わかるようでわからない問題だから辛い。
まずやることは、PC側の送信受信時間とNTPサーバーの受信送信時間から伝送遅延を導くこと。
求めた伝送遅延をNPTか送信して到着するまでの時間に当てはめて、そのずれを導けば良いということか。



10Mバイトのデータを100,000ビット／秒の回線を使って転送するとき，転送時間は何秒か。ここで，回線の伝送効率を50%とし，1Mバイト＝10^6バイトとする。
→
伝送効率が50%である100,000ビット／秒の通信回線を使うので、実効転送速度は以下のように計算できます。
　100,000[ビット／秒]×0.5＝50,000[ビット／秒]
転送するデータの単位がバイトなので実効転送速度もバイト単位に直します（1バイト＝8ビット）。
　50,000[ビット]÷8[ビット]＝6,250[バイト／秒]
転送するデータ量（10Mバイト）を1秒当たりの転送量（6,250[バイト／秒]）で割ることで、転送時間を計算できます。
　10,000,000[バイト]÷6,250[バイト／秒]＝1,600[秒]

【別解】
上記の解説ではバイトに揃えて計算していますが、Mビットに揃えた方が計算が容易かもしれません。

【実行転送速度】
　100,000[ビット／秒]×0.5＝50,000[ビット／秒]
＝0.05[Mビット／秒]
【転送するデータ量】
　10[Mバイト]×8[ビット]＝80[Mビット]
【転送時間】
　80[Mビット]÷0.05[Mビット／秒]＝1,600[秒]



64kビット／秒の回線を用いて106バイトのファイルを送信するとき，伝送におよそ何秒掛かるか。ここで，回線の伝送効率は80%とする。
→
回線速度が64kビット／秒で伝送効率が80%なので、

　64kビット／秒＝8kバイト／秒
　8k×0.8＝6.4kバイト／秒

1秒間の伝送可能量は最大で6.4kバイトと計算できます。したがって106バイトのファイルを送信するときの伝送時間は、

　1,000,000÷6,400＝156.25(秒)

およそ「156秒」が適切です。



符号化速度が192kビット／秒の音声データ2.4Mバイトを，通信速度が128kビット／秒のネットワークを用いてダウンロードしながら途切れることなく再生するためには，再生開始前のデータのバッファリング時間として最低何秒間が必要か。
→
音声データサイズを符号化速度※で割ると再生時間がわかります。音声データ2.4Mバイト、符号化速度は192kビット／秒と単位がビット・バイトで異なるので、どちらかに合わせて計算します。ここでは符号化速度の方を「192kビット÷8ビット＝24kバイト」とバイト単位に直します。

　2.4[Mバイト]÷24[kバイト]
＝2,400[kバイト]÷24[kバイト]
＝100[秒]

この計算により再生時間100秒相当の音声データであるとわかります。

次に音声データサイズを通信速度で割って、ダウンロードに要する時間を求めます。音声データサイズは2.4Mバイト、ネットワークの通信速度は128kビット／秒(＝16kバイト／秒)なので、ダウンロードに要する時間は、

　2.4[Mバイト]÷16[kバイト]
＝2,400[kバイト]÷16[kバイト]
＝150[秒]

再生時間よりダウンロード時間が長い状態ではデータの転送が遅れ、再生途中で停止してしまうことになるため、再生開始前にある程度のデータをバッファリング(一時的に蓄えておく処理)する必要が生じます。再生時間と転送時間の差は50秒なので、この差分である50秒分のデータをあらかじめ蓄えた状態で再生を開始し、再生しながらデータをダウンロードすれば、最後まで途切れずに再生が行われることになります。

したがって〔ウ〕が適切です。

※符号化速度は、アナログデータをディジタルデータに変換するに際して、単位時間当たり何ビットで表現するかを示します。



平成29年春期　問30
本社と工場との間を専用線で接続してデータを伝送するシステムがある。このシステムでは2,000バイト／件の伝票データを2件ずつまとめ，それに400バイトのヘッダ情報を付加して送っている。伝票データは，1時間に平均100,000件発生している。回線速度を1Mビット／秒としたとき，回線利用率はおよそ何%か。
→
システムでは発生したデータを「2件の伝票データ＋ヘッダ → 1つの送信単位」と変換を行ってから送信します。
この送信単位となるデータは、上の図のように伝票データを2件まとめたものにヘッダ情報が付加されるので、
　2,000×2＋400＝4,400(バイト)
1つ当たり4,400バイトになります。
1時間に発生する伝票データは平均100,000件なので、送信時には半分の50,000件の送信データに変換されます。
1時間に4,400バイトのデータが50,000件送信されるので、1時間当たりの伝送量は平均で、
　4,400バイト×50,000件＝220Mバイト

回線速度は、1Mビット／秒＝125kバイト／秒で、1時間の伝送可能量は、
　125kバイト×3,600秒＝450Mバイト
したがって回線利用率は、
　220÷450＝0.48888…
およそ49%とわかります。



平成28年秋期　問35
地上から高度約36,000kmの静止軌道衛星を中継して，地上のA地点とB地点で通信をする。衛星とA地点，衛星とB地点の距離がどちらも37,500kmであり，衛星での中継による遅延を10ミリ秒とするとき，Aから送信し始めたデータがBに到達するまでの伝送遅延時間は何秒か。ここで，電波の伝搬速度は3×108m／秒とする。
→
A地点－衛星間、および衛星－地点B間は共に37,500kmなので通信距離は、
　37,500×2＝75,000(km)
と分かります。75,000kmをメートル単位に変換すると、75,000,000m＝7.5×10^7mです。電波の伝搬速度は3×10^8m／秒であるため、電波が75,000kmの距離を伝搬するために必要な時間は、
　(7.5×10^7)÷(3×10^8)
＝(7.5×10^7)÷(30×10^7)
＝7.5÷30
＝0.25(秒)
これに衛星での中継による遅延時間10ミリ秒(0.01秒)を加えた0.26秒が、地点Aから地点Bに到達するまでの伝送遅延時間になります。したがって正解は〔エ〕です。



令和元年秋期　問30
10Mビット／秒の回線で接続された端末間で，平均1Mバイトのファイルを，10秒ごとに転送するときの回線利用率は何%か。
ここで，ファイル転送時には，転送量の20%が制御情報として付加されるものとし，1Mビット＝106ビットとする。
→
回線利用率は「転送量÷回線速度」で求められます。

[1秒当たりの転送量]
転送するファイルサイズは平均1Mバイトですが、転送の際に転送量の20％の制御情報が付加されるので、実際に転送するデータ量は、

　1Mバイト×1.2＝1.2Mバイト

ファイルの転送は10秒ごとに行われるので、1秒当たりの平均転送量は、

　1.2Mバイト÷10＝0.12Mバイト

[転送速度]
回線の通信速度はビット単位なのでバイト単位に変換してから計算しなければなりません。10Mビット／秒をバイト単位に変換すると、

　10M÷8＝1.25Mバイト／秒

[回線利用率]
0.12Mバイト／秒のデータを1.25Mバイト／秒の回線で転送するので、回線利用率は、

　0.12÷1.25＝0.096＝9.6%


---

## 1回目に間違えた問題

電子メールのヘッダフィールドのうち，SMTPでメッセージが転送される過程で削除されるものはどれか。
→
受け取ったという情報は消えていいよなと思って「Received」なるものを選択してみたが、ダメだった。
Bccは情報としては消えるべきだが、ヘッダーとして消えるべきか怪しかったので選ばなかったがこれが正解だった。


IPv4アドレス 128.0.0.0 を含むアドレスクラスはどれか。
→
完全に忘れてる問題。
3回目なのでいい加減に覚える。
A : 0
B : 10
C : 110
D : 1110



TCP/IPネットワークで，データ転送用と制御用に異なるウェルノウンポート番号が割り当てられているプロトコルはどれか。
→
普通に知らなかった。
ズバリFTPなのだが、確かに2つある。
ついでにDNSも2つある。
覚えよう。



10Mバイトのデータを100,000ビット／秒の回線を使って転送するとき，転送時間は何秒か。ここで，回線の伝送効率を50%とし，1Mバイト＝106バイトとする。



地上から高度約36,000kmの静止軌道衛星を中継して，地上のA地点とB地点で通信をする。衛星とA地点，衛星とB地点の距離がどちらも37,500kmであり，衛星での中継による遅延を10ミリ秒とするとき，Aから送信し始めたデータがBに到達するまでの伝送遅延時間は何秒か。ここで，電波の伝搬速度は3×108m／秒とする。
→
0.25秒を求めるまではよかったが、10ミリ秒=0.01秒を0.1秒として0.35秒で応えてしまった。
SI単位系もしっかりしておかないといけない。
そのためにも基礎理論を時間をかけて復讐することにするか。

ミリ = 10^-3
ナノ = 10^-6
マイクロ = 10^9



10Mビット／秒の回線で接続された端末間で，平均1Mバイトのファイルを，10秒ごとに転送するときの回線利用率は何%か。ここで，ファイル転送時には，転送量の20%が制御情報として付加されるものとし，1Mビット＝106ビットとする。
→
1分で考えるから悪かった。
秒単位でも十分いける。
1.2Mを10で割る。 0.12M

10Mビットだ。問題文よく見てなかった。
10/8 = 1.25M

0.12/1.25 = 0.096=9.6%
