# サンプル1

ストラテジーパターン + ファクトリメソッドパターン を用いたタイプのサンプル。  

---

修正前

``` cs
public void ViewLogic(Auth auth)
{
    switch (auth) {
        case ADMIN:
            // 閲覧+管理者閲覧処理
            break;
        case VIEWER:
            // 閲覧処理
            break;
    }
}

public void RegisterLogic(Auth auth)
{
    switch (auth) {
        case ADMIN:
            // 登録処理
            break;
        case VIEWER:
            // 閲覧しかできないので権限エラー
            break;
    }
}
```

修正後

``` cs
// ユーザー操作インターフェース
interface IUserOperation
{
    void 閲覧();
    void 登録();
}

// 管理者用操作クラス
public class AdminOperation : IUserOperation
{
    public void 閲覧(){}
    public void 登録(){}
}

// 閲覧者用操作クラス
public class ViewerOperation : IUserOperation
{
    public void 閲覧(){}
    public void 登録(){}
}

// ユーザー操作Factoryクラス
public static class UserOperationFactory
{
    public static IUserOperation GetOperation(Auth auth)
    {
        switch (auth) {
            case ADMIN:
                return new AdminOperation();
            case VIEWER:
                return new ViewerOperation();
        }
    }
}

// 閲覧処理クラス
public class ViewLogic
{
    public void view(Auth auth)
    {
        IUserOperation ope = UserOperationFactory.GetOperation(auth);
        ope.閲覧();
    }
}
// 登録処理クラス
public class RegisterLogic
{
    public void Register(Auth auth)
    {
        IUserOperation ope = UserOperationFactory.GetOperation(auth);
        ope.登録();
    }
}
```

コンテキストクラスを採用するならこうなるだろうか。  

``` cs
// Contextクラスの定義
public class UserOperationContext
{
    private readonly IUserOperation strategy;

    public Prefix(Auth auth)
    {
        strategy = UserOperationFactory.GetOperation(auth);
    }

    public void 閲覧()
    {
        strategy.閲覧();
    }

    public void 登録()
    {
        strategy.登録();
    }
}

// ユーザー操作Factoryクラス
public static class UserOperationFactory
{
    public static IUserOperation GetOperation(Auth auth)
    {
        switch (auth) {
            case ADMIN:
                return new AdminOperation();
            case VIEWER:
                return new ViewerOperation();
        }
    }
}
```

---

[Switch文は増やさない！ Strategyパターン & Factory Methodパターン 活用術 - Speaker Deck](https://speakerdeck.com/satoshishibata0108/switchwen-hazeng-yasanai-strategypatan-and-factory-methodpatan-huo-yong-shu)  
