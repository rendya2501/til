# Rendering

---

## 概要

<https://serip39.hatenablog.com/entry/2020/08/23/225000>  

Web案件のはSPAだと思うけどなぁ。
Angular自体SPA開発向けだった気がするし。→実際そうだった。
SEOなんて考えなくていいしね。業務アプリケーションだし。

SSRとSSGの違いは、SSRは都度APIでデータをもらってからレンダリングするのに対して、
SSGはもう全部のデータを取得してレンダリングして渡すから細かい要求に対応できないんだろうな。
どっちもサーバー側で頑張る点は変わらない。

---

## SPA : Single Page Application

Client Side Rendering は、SPA（= Single Page Application）とほぼ同意義。

1枚のHTMLに対してJavaScriptで動的に変更を加えながら画面の描画を実現するアーキテクチャのこと。  
従来のWebアプリケーションと異なり、ページ全体をロードするのは初回のみで、2回目以降はサーバからJSONデータを受け取ることで必要箇所のみリロードする。  

登場背景  
・HTML,CSS,ブラウザの進化に伴い、既存のWeb技術だけで実現できることが増えた。  
・RIAに代表されるFlash等の衰退。  
・RIAの代替技術として注目されるようになった。  

[SPA(Single Page Application)ってなに？](https://digitalidentity.co.jp/blog/creative/about-single-page-application.html)

SPAのメリット
SPAのメリットは以下の3点です。

動作性の向上
より高度なWeb表現
ネイティブアプリの代用
単一のWebページでコンテンツ切り替えを行うことで、ページ遷移の必要がなく、ブラウザの挙動に縛られないWeb表現を可能にするのです。
では、順にご説明していきます。

動作の向上が期待できる
まずは動作が向上するという点に関してご説明していきます。
そもそも、従来のWebアプリケーションの仕組みは、以下のようになっていました。

ユーザーが何かしらのアクション（クリックなど）を行う
それを受けてサーバに通信（リクエスト）
サーバ側でHTMLを生成し、ブラウザに返す（レスポンス）
HTMLに反映
この仕組みではページを更新する度に変更していない部分までサーバ側で生成し直していました。
例えば、ページのヘッダーやフッターはユーザーが変更するように作られていないことがほとんどでしょう。
そういった変更のない部分までサーバに送信しているので、処理に時間がかかってしまっていたのです。
これに対して、SPAを導入した際のWebアプリケーションの仕組みは、以下のように変更されました。

ユーザーが何かしらのアクション（クリックなど）を行う
そのアクションに必要な部分のデータだけをサーバに要求
返ってきたデータをJavaScriptで処理
処理HTMLに反映
つまり、ブラウザ側でできる処理はJavaScriptで終わらせることで、サーバとの通信量を最低限に抑えることが可能です。
これによって、Webアプリケーションの動作の向上が期待できます。

SPAを採用すべき場面
ここまでで、SPAについてある程度のことは理解できたと思います。
では、実際にSPAを使う際にどのようなサービスが適しているのでしょうか？

滞在時間の長いサービスに適している
SPAはページ遷移を高速化するという特徴から、滞在時間の長いサービスに適しています。
例えば、デジタルマーケティングで使用するツールや、口コミや評判などを分析するサイトでは、ユーザーが繰り返しアクションを行い、その度にページ遷移することもしばしばです。
こういったサービスではSPAに適していると言えるでしょう。
ページ遷移が早くなることでユーザーのストレスが減少し、サイトに対する満足度の向上も期待できるでしょう。

SPAに適していないケースは？
滞在時間の長くないサービス、言いかえると直帰率の高いサービスは、SPAに適していないと考えられます。
主な例としては、ブログなどが挙げられます。
直帰率の高いサービスでは、アクセス時にかかる時間が増加してしまうSPAを導入すると、ユーザーは不快感を感じてしまい、直帰率が上昇する危険性があります。
SPAの導入を検討する際は、サイトにおけるユーザーの行動を分析することが重要です。

SPAはSEO上不利になる？
SPAで制作されたWebサイトはJavaScriptでコンテンツを描画しているため、Googlebotに正しく認識されずSEOの観点で問題が生じるのではないかという懸念の声がしばしば聞かれます。
しかし、現在のGooglebotには、Chrome 74相当のレンダリングが搭載されており、最新のJavaScript技術に対応しています。
ですので、SPAで制作されたWebサイトが何らかSEO上で不利になるということは考えられないでしょう。

このアップデートはGoogle I/O 2019にて発表され、アメリカ版Googleウェブマスター向け公式ブログでも告知されています。

最小限のHTMLとJSだけ渡して、相手のPCで画面を組み立てる。  
最小のデータしか渡さないので、都度APIをたたいてデータを取得して各端末で組み立てるという順序になる。  
最小のデータなのでSEOは絶望的。  
Web案件の基幹システム的なものにはよいのかな？中身を解析される恐れもないのでセキュリティ面でも有利化もしれない。  

---

## SSR Server Side Rendering

サーバー側で都度ページを作って渡す。
消去法的に大体これになる。
SEOにもある程度対応できるしね。
サーバー側で作ったページを渡して、細かいものは都度もらってねって方式。  

---

## SSG : Static Site Generator

あんまり画面の変更がないページはこれの方式が適してるよ。  
ビルド時にデータを含めてページを作成しておき、あとはそれを渡すだけ。
渡すだけだから処理も軽い。
ヘルプページとか、変化が少ない、人によって変化しない静的なサイトに向いている。
もちろん、都度画面がガチャガチャやるものに使ってはいけない。

SSGとSSRの違いは、都度か最初だけかの違いだよなぁ。