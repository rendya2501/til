# セキュリティ

## 情報セキュリティ

### エクスプロイトキット

複数のエクスプロイトコードをまとめ、ソフトウェアやOSに内在する脆弱性を確認したり、攻撃者がその脆弱性を悪用したりするツール群です。  
エクスプロイト(exploit)には、悪用という意味があります。  

エクスプロイトキットが仕掛けられたWebサイトにアクセスすると、PC上の脆弱性が調べられ、その脆弱性を突く攻撃が行われます。  
最終的にはマルウェアがダウンロードされ、ランサムウェアやクリプトジャッキングの被害を受ける可能性があります。  
被害を受けないためにはPCで使用しているOSやソフトウェアを常に最新バージョンに更新しておくことが重要です。  

### エクスプロイトコード

ソフトウェアの脆弱性を悪用した不正な動作を再現するために作成されたスクリプトやプログラムを指す言葉です。  

このようなプログラムは、善意の第三者や製品開発元の間で安全に流通している状況であれば問題ありませんが、  
世の中に出回ると攻撃方法の詳細が広く知られることになり、攻撃者が個人や企業、組織などへの攻撃を実行する際に悪用することが可能になります。  
実際に様々な脆弱性に対して攻撃が成功するように、複数のエクスプロイトコードをまとめたエクスプロイトキットというツールも存在し、攻撃に利用されています。  

エクスプロイトコードは、多くの場合、悪意を持ったマルウェアのことを指しますが、  
セキュリティ向上目的での研究材料や脆弱性検査のために作成された実証用コードという意味でも用いられます。  

### ルートキット(rootkit)

攻撃者がシステムへ不正侵入した後に侵入した痕跡を隠蔽したり、再び侵入するためのバックドアを設置するための機能をまとめたソフトウェア群です。  
ルートキットにはキーロガー、パスワード窃盗ツール、クレジットカードやオンラインバンキングの情報を盗むモジュール、DDoS攻撃用のボット、  
セキュリティソフトウェアを無効にする機能など、多数の悪意あるツールが含まれている可能性があります。  

### SIEM(Security Information and Event Management)

OS、データベース、アプリケーション、ネットワーク機器など多様なソフトウェアや機器が出力する大量のログデータを分析し、  
異常があった場合に管理者に通知したり対策を知らせたりする仕組みです。  
日本語ではセキュリティ情報およびイベント管理と訳されます。  

Webサイトのアクセスログから，Webサイトの脆弱性を悪用した攻撃を検出するツール。  
SIEMではありませんが、IPAでWebサーバのアクセスログから攻撃の痕跡を探す「iLogScanner」というソフトウェアが公開されています。  

### 楕円曲線暗号

楕円曲線の点の演算を用いた**公開鍵暗号方式**  
楕円曲線によって定義された有限可群上の離散対数問題を解く際の計算量の多さを安全性の根拠とし、同じ強度を想定した場合、RSAより鍵長を短くできる利点があります。  

### タイムスタンプ

対象とする電子文書に対して、信頼できる第三者機関である時刻認証局(TSA:Time Stamp Authority)が発行する時刻情報を含んだ電子データです。  
タイムスタンプは、付与時点での**存在性**、およびその時刻以後の**完全性**を証明することを目的としています。  

結合データに付されたディジタル署名が正当なものであるということは「結合データが第三者機関によって作成され、改ざんされていないこと」を意味するため、  
結合データ内のハッシュ値に対応するファイルがその日時に存在し、その日時以降に改ざんされていないことが証明されます。  

タイムビジネス推進協議会ガイドラインではタイムスタンプを「特定の電子情報と時刻情報を結合する事により、  
その時刻以前にその電子データが存在していたことの証明（存在証明）と  
その時刻までの間にその電子情報が変更・改ざんされていないことの証明（非改ざん証明）することができる手段、およびその証拠に結びつく情報」と定義しています。  

### ダークネット

インターネット上で到達可能かつ未使用のIPアドレス空間のことを指します。  

通常のインターネット利用を考えれば特定のホストに割り当てられていない未使用のIPアドレス宛にパケットが送信されることは稀なはずですが、  
実際にダークネットを観測すると相当数のパケットが未使用のIPアドレス宛に送信されているようです。  

これらは、  
・マルウェアが次の感染対象を探すためのスキャン  
・マルウェアが脆弱性を攻撃するためのパケット  
・送信元IPアドレスが詐称されたパケットへの応答パケット  
などの不正な活動を目的とするパケットに因るものです。  

ダークネットで観測されるパケットは、実際には使用されていないIPアドレスが宛先に設定されています。  
よって、マルウェアが総当たり的に次の攻撃対象を探すためのパケットが観測されます。  

### C&C(コマンド&コントロール)サーバ

攻撃者がマルウェアに対して指令コマンドを送信し、マルウェアに感染した支配下のコンピュータ群(ボットネット)の動作を制御するために用いられる外部の指令サーバです。  
コンピュータに感染したボットは、数秒～数分間隔で外部のC&Cサーバと通信を行うように仕込まれています。  
C&Cサーバは、それに応答する形で攻撃者の端末に指令コマンドを送り込みます。
この仕組みを「コネクトバック通信」といいます。  

### 辞書攻撃

一般的な単語や人名からパスワードのリストを作成し，インターネットバンキングへのログインを試行する。

### パスワードリスト攻撃

複数のサイトで同様のID・パスワードの組合せを使用している利用者が多いという傾向を悪用したもので、  
あるサイトに対する攻撃などによって得られたIDとパスワードのリストを用いて、別のサイトへの不正ログインを試みる攻撃です。  

この攻撃に対しては、利用者側で「パスワードの使いまわしをやめる」ことや、  
管理者側で「2段階認証を行う」「ログイン履歴を表示し利用者に確認してもらう」などの対策が考えられます。  

### 水飲み場型攻撃

特定の組織や人に狙いを定める標的型攻撃の一つで、標的ユーザが良く利用するWebサイトにドライブバイダウンロードのコードなどを仕込み、  
アクセスした標的ユーザにマルウェアやウイルスを感染させる攻撃です。  
一般的には標的対象のみに感染するマルウェアが用いられ、標的以外の第三者がアクセスしても何も起こらないため、  
脅威の存在やWebサイトの改ざんなどが発覚しにくくなっています。  

「水飲み場型攻撃」の名称は攻撃者をライオンなどの肉食獣に、標的ユーザが良く利用するWebサイトを草食獣が集まる水飲み場に見立て、  
肉食獣が水飲み場に来る獲物を待ち伏せする様子になぞらえています。  

### ドライブバイダウンロード

Webサイトにマルウェアやウイルスを仕込んでおき、利用者がアクセスすると同時に秘密裏に利用者のコンピュータにそれらをダウンロードさせたり実行させる攻撃手法  
この攻撃単体で仕掛けられるほか、Gumblar攻撃や水飲み場型攻撃などのように他の攻撃の一部に組み込まれて使用されるケースもあります。  

※autorun.inf  
PCにCDやUSBが接続されたときに自動で起動するファイル名を記述するための設定ファイル  

### ランサムウェア

PCに格納されているファイルを勝手に暗号化して，復号することと引換えに金銭を要求する。  

### ウォードライビング(War Driving)  

不正にアクセスする目的で，建物の外部に漏れた無線LANの電波を傍受して，セキュリティの設定が脆弱な無線LANのアクセスポイントを見つけ出す。  

### ブルートフォース攻撃

パスワードクラックや暗号鍵の解読に用いられる手法の1つで、特定の文字数および文字種で設定される可能性のあるすべての組合せを試すことで不正ログインを試みる攻撃手法です。  
総当たり攻撃とも呼ばれます。  
パスワード長が短く、使用可能な文字種が少ない場合には、この手法によって認証を不正に突破されてしまう危険性が高くなります。  

### DDoS(Distributed Denial of Service)

複数の機器を踏み台にして、特定の機器に一斉攻撃を仕掛けるサイバー攻撃の一種。  
Distributedの分散は複数の機器を使う事に起因している。  

DoS攻撃との違い。  
DoS攻撃は1台の機器から対称の機器に過剰なアクセスを仕掛けるサイバー攻撃。  
分散がないので、1台からってことになる。  

・DoS攻撃：1台の機器から、対象の機器に過剰な負荷をかける攻撃  
・DDoS攻撃：複数の機器を「踏み台」に利用して、対象の機器に過剰な負荷をかける攻撃  

Distribute  
分配する。配る。配布する。流通させる。供給する。  

Distributeの過去形  
ITの分野では分散の意味になるらしい。  

denial(名) : 否認、否定
denyは動詞 拒否する

### レインボー攻撃(レインボーテーブル攻撃)

パスワードを不正に得る手法の1つ。  
パスワードとして使われるような文字列のハッシュ値をテーブル化しておき、解読したいパスワードのハッシュ値と比較することでパスワードを推測する手法。  

``` C#
var hashList = Hash(new List<string>(){使われそうなパスワード一覧]);
var getHash = 入手したハッシュ;
var result = hashList.FirstOrDefault(f => f == getHash);
```

つまりこういうことだろう。  
パスワードは大抵ハッシュ化されているので、ハッシュ値を入手したうえで、パスワードをハッシュ一覧にして、  
同じだったら、そのパスワードを入手できるって手法。  

### トロイの木馬

一見正常に動作しているように見えますが、実際には裏でユーザのキーストロークを盗んだり、  
バックドアとして機能したりするように巧妙につくりかえられたプログラムのこと。  
特定の条件になるまで活動をせずに待機する。  

### ワーム(Worm)

自己の複製をネットワークや電子メール、またはUSBメモリなどの外部メディアに送り込み、  
他のコンピュータへの拡散動作を繰り返す性質を持つマルウェアです。  
感染したコンピュータへの悪影響はもとより、感染拡大によりネットワーク負荷やCPU負荷の増大といった二次被害をもたらします。  
それ自身が独立したプログラムであるため、別のシステムに感染しようとする時に宿主となるファイルを必要としません。  

### スパイウェア(Spyware)

利用者や管理者の意図に反してインストールされ、利用者の個人情報やアクセス履歴及びキーストロークなどの情報を秘密裏に収集し、  
勝手に外部の組織や個人に送信する不正プログラムです。  
ユーザに気付かれずに情報を収集することが目的であるため、  
ウイルスの特徴であるシステムの改ざんやファイルの破壊などの目立つ活動は行わないことが多く、  
インストールされていることをユーザから隠すようになっています。  

### マルウェア

ウィルスやワーム、トロイの木馬、スパイウェアなど、ユーザーのデバイスに不利益をもたらす悪意のあるプログラムやソフトウェアを総称する言葉。  
英語のmalicious（マリシャス:悪意のある）にsoftware（ソフトウェア）の2つの単語が組み合わさった造語。  

●主な種類  
・トロイの木馬  
・ワーム  
・スパイウェア  
・ランサムウェア
とにかくあらゆる悪い物は全部含まれる

●主な感染経路  
・メールの添付ファイル  
・ネットワーク経由で侵入  
・不正サイトや悪意のあるサイトへのアクセス  
・不正なソフトウェアやアプリのインストール  
・ソフトウェアの脆弱性を突いて侵入  

●主な被害  
・個人情報を抜き取られたり、情報が流出したりする  
・デバイスに保存されているファイルが改ざんされる  
・デバイスを勝手にロックされて持ち主でも操作ができなくなる  
・外部と勝手に通信を行う  
・デバイスを乗っ取られ、サイバー攻撃の「踏み台」として使われる  

### OSコマンドインジェクション

ユーザの入力をもとにOSのコマンドを発行して処理を行うWebアプリケーションに対して、  
不正なコマンドを渡すことで任意のファイルに対する読出し，変更，削除やパスワードの取得などを行う攻撃方法。  
OSコマンドの呼出しに使われる関数は、C,Perl,PHPの"exec"，"system"、入力値としてコマンドを許しているPerlの"open"関数などがある  

### SQLインジェクション

入力データとしてデータベースへの命令文を構成するデータを入力し、Webアプリケーションが想定しない想定外のSQL文を意図的に実行させることでデータベースを攻撃する方法  

### クロスサイトスクリプティング

動的にWebページを生成するアプリケーションのセキュリティ上の不備を意図的に利用し、  
サイト間を横断して悪意のあるスクリプトを混入させることでユーザのクッキーを盗むなどの攻撃を行う方法  

### クロスサイトリクエストフォージェリ

悪意のあるスクリプトが埋め込まれたWebページを訪問者に閲覧させて，別のWebサイトで，その訪問者が意図しない操作を行わせる攻撃手法。  
会員制サイトでログイン状態であるときに会員情報の変更や商品の注文画面への直接リンクを踏ませる(またはスクリプトでリダイレクトする)などの意図しない不正な処理要求を行わせる行為がこれに該当する。  

### セッションハイジャック

認証が完了してセッションを開始しているブラウザとWebサーバの間の通信において、  
CookieやセッションIDなどのセッション情報を盗むことで、対象セッションを通信当事者以外が乗っ取る攻撃方法  

### DNSキャッシュポイズニング攻撃

DNSキャッシュサーバに偽のDNS情報をキャッシュとして登録させることで、利用者を偽のWebサイトに誘導する攻撃です。  

まず設問に登場する「再帰的な問合せ」について確認しておきます。  
DNSの名前解決はその性質によって「再帰的な問合せ」と「反復(非再帰的)問合せ」に区別されます。  
**再帰的な問合せ**  
リゾルバから名前解決要求を受けたDNSサーバが他のDNSサーバに代理して問合せを行い、最終的な結果をリゾルバに返す必要のある問合せのこと  
**反復問合せ**  
リゾルバから再帰的問合せを受けたDNSサーバが、それを解決できるまで繰り返し他のDNSサーバに行う問合せのこと  

この2つの問合せの違いを踏まえて、攻撃者がDNSキャッシュサーバに偽のキャッシュ情報を登録させる手順を追ってみます。  

[1]攻撃者は、キャッシュサーバに対して偽の再帰的な問合せを行い反復問合せを強制的に生じさせる。  
[2]キャッシュサーバは、コンテンツサーバに対して反復問合せを行う。  
[3]攻撃者は、コンテンツサーバが正規の応答を返すよりも先にキャッシュサーバへ偽の応答を送りつける。  
[4]キャッシュサーバは、攻撃者から送られた偽の応答を正規のものと判断しキャッシュに登録する。  
この時点でDNSクエリは解決済なのでコンテンツサーバから送られた正規の応答は破棄される。  

DNSキャッシュポイズニングは、上記のように外部から攻撃目的で送られた再帰的な問合せをキャッシュサーバが処理してしまうことから始まります。  
再帰的問合せの役割は、内部ネットワークのホストが外部ネットワークに接続する際の名前解決であり、  
原則として外部からの再帰的な問合せに応じる必要はないはずですから、
再帰的な問合せを受け付けるホストを内部ネットワークだけに限定することがキャッシュポイズニング攻撃への対策となります。  
また、DNSでは送信元のIPアドレスとポート番号、トランザクションIDの全てが一致しないと、  
キャッシュサーバはコンテンツサーバからの正しい応答として認めない仕組みを備えています。  
このためDNSキャッシュポイズニングが成立するためには、反復問合せに対する偽の応答メッセージに含まれる各情報を正規の応答と一致させる必要があります。  
DNSの設定で、ポート番号やトランザクションIDが固定されていたり推測されやすいものになっていたりすると、パケットの偽装が容易になり攻撃に対して脆弱になってしまいます。  

### ディレクトリトラバーサル攻撃

ファイル名を要求するプログラムに対してサーバ内の想定外のファイル名(親ディレクトリの移動「../」など)を直接指定することによって、  
本来許されないファイルの不正な閲覧・取得を狙う攻撃方法です。  

### チャレンジレスポンス方式

通信経路上に固定パスワードを流さないようにすることで、盗聴によるパスワードの漏えいやリプレイアタックを防止する認証方式です。  

[1]サーバは、クライアントから要求があるたびに異なる乱数値(チャレンジ)を生成して保持するとともに、クライアントへ送る。  
[2]クライアントは、利用者が入力したパスワードと(1)でサーバから送られた"チャレンジ"から所定の方法でレスポンスを計算する。  
[3]クライアントは、(2)で生成した"レスポンス"と利用者が入力した利用者IDをサーバに送る。  
[4]サーバは、クライアントから受け取った利用者IDで利用者情報を検索して、取り出したパスワードと(1)で保持していた"チャレンジ"を用いてクライアントと同じ手順でレスポンスを生成する（レスポンス照合データ）。  
[5]サーバは、"レスポンス照合データ"とクライアントから受け取った"レスポンス"を比較し、両者が一致すれば認証成功とする。  

### サーバ証明書

TLS暗号化通信の開始に先立ち、サーバからクライアントに送られる公開鍵に対する電子式の証明書で、認証局(CA)と呼ばれる第三者機関によって発行されています。  
サーバ証明書には、認証を受けた公開鍵が含まれていて、その信頼性を担保するために認証局のディジタル署名が付されています。  
サーバ証明書を提示された利用者は、暗号化通信の開始に際し「認証局の公開鍵」を使用してサーバ証明書に付された「認証局のディジタル署名」を検証します。  
ディジタル署名の検証に成功したならば、同封されている公開鍵が正当であり、かつ、改ざんされていないことが保証されます。  

SSL/TLSでは公開鍵の検証後、その公開鍵を使って通信相手と共通鍵を共有します（RSA方式の鍵交換の場合）。  
そして、以降はその共通鍵を使用して暗号化通信を行います。  

![!](https://www.ap-siken.com/kakomon/29_haru/img/37.gif)  

### ディジタル署名

公開鍵暗号の技術を応用してディジタル文書の正当性を保証する仕組みです。  
送信するディジタル文書にディジタル署名を付けると、受信側で「発信元が正当であるか」と「改ざんの有無」の2点を確認することができます。  
ただし、改ざん部位の特定、および訂正の機能は有しません。  
ディジタル署名の生成には「送信者の秘密鍵」を使用し、受信側での検証には「送信者の公開鍵」を使用するため、  
設問中の署名検証鍵Xは「送信者の公開鍵」、署名生成鍵Yは「送信者の秘密鍵」に相当します。  

[1]送信者は、平文をハッシュ関数で圧縮したメッセージダイジェストを送信者の秘密鍵で暗号化し、平文と一緒に送信する。  
[2]受信者は、受信したメッセージダイジェストを送信者の公開鍵で復号し、受信した平文をハッシュ関数で圧縮したものと比較する。  
[3]送信者から送られてきたメッセージダイジェストと、受信側でハッシュ化したメッセージダイジェストが同じなら、通信内容が改ざんされていないことが証明される。  
![!](https://www.ap-siken.com/kakomon/26_aki/img/36a.gif)  

### OCSP(Online Certificate Status Protocol)

リアルタイムでディジタル証明書の失効情報を検証し、有効性を確認するプロトコルです。  
OCSPクライアントは、確認対象となるディジタル証明書のシリアル番号等をOCSPレスポンダに送信し、有効性検証の結果を受け取ります。  
この仕組みを利用することで、クライアント自身がCRL(証明書失効リスト)を取得・検証する手間を省くことができます。  
![!](https://www.ap-siken.com/kakomon/02_aki/img/38.gif)  

### AES(Advanced Encryption Standard)

アメリカ合衆国の標準暗号規格として制定された共通鍵暗号方式です。  
DESの後継。  

### ハイブリッド暗号方式

公開鍵暗号方式を用いて共通鍵を通信相手へ安全に配送し、以後はその共通鍵を使用して暗号化通信を行う方式です。TLSやS/MIMEで採用されています。  

**共通鍵暗号方式**  
安全に鍵を配送するのに手間が掛かる  
通信相手が増えると必要な鍵数が多くなる  
**公開鍵暗号方式**  
暗号化・復号に要する計算量が多いため処理に時間が掛かる  

ハイブリッド暗号は、両者を組み合わせることで、鍵を安全に配送しながら低い処理負荷での暗号化・復号を可能にしています。  
![!](https://www.ap-siken.com/kakomon/28_aki/img/42.gif)  

### ハッシュ関数

任意の長さのデータを入力すると固定長のビット列(ハッシュ値，メッセージダイジェスト)を返す関数で、次のような性質を持っています。  
・入力データが同じであれば、常に同じメッセージダイジェストが生成される。  
・入力データが少しでも異なっていれば生成されるメッセージダイジェストは大きく異なったものになる。  
・メッセージダイジェストから元の入力データを再現することが困難である。  
・異なる入力データから同じメッセージダイジェストが生成される可能性が非常に低い。  
このうち3つ目の「あるメッセージのハッシュ値を得ることは簡単にできるが、その逆は事実上できない」というハッシュ関数の一方向性を「原像計算困難性」といいます。
ちなみに「ハッシュ値が一致する二つの相異なるメッセージを見つけることが計算量的に困難であるという性質」は、衝突発見困難性(強衝突耐性)を説明した文です。

### 否認防止(Non-Repudiation)

情報セキュリティマネジメントの付加的な要素で、行った操作や発生した事象を後になって否認されないように証明できる能力のことです。  
ログの取得で必要な項目を確実に記録するとともに、完全性が損なわれないように保管することで確保できます。  
ディジタル署名やタイムスタンプは否認防止に活用される技術です。  
JIS Q 27000では「主張された事象又は処理の発生、及びそれを引き起こしたエンティティを証明する能力」と定義されています。  

### クロスサイトスクリプティング(XSS)

動的にWebページを生成するアプリケーションのセキュリティ上の不備を意図的に利用して、悪意のあるスクリプトを混入させることで、  
攻撃者が仕込んだ操作を実行させたり、別のサイトを横断してユーザのクッキーや個人情報を盗んだりする攻撃手法です。  

XSS脆弱性のあるWebアプリケーションでは、以下の影響を受ける可能性があります。  
[1]サイト攻撃者のブラウザ上で、攻撃者の用意したスクリプトの実行によりクッキー値を盗まれ、利用者が被害にあう。  
[2]同様にブラウザ上でスクリプトを実行され、サイト利用者の権限でWebアプリケーションの機能を利用される。  
[3]Webサイト上に偽の入力フォームが表示され、フィッシングにより利用者が個人情報を盗まれる。  

### リスクベース認証

通常とは異なる利用環境(例えば、普段とは異なるIPアドレスやISP及びOSやWebブラウザ等)からの認証要求があった場合に、  
通常の認証に追加する形で別の認証を実施する方式です。  
不正ログインの可能性のあるアクセスに対してだけ追加の本人認証を行うため、一定の利便性を保ちつつ、  
異なる利用環境からの不正アクセスに対してセキュリティを高めることができます。  

### 二要素認証

いかなる利用条件でのアクセスの要求においても，ハードウェアトークンとパスワードを併用するなど，  
常に二つの認証方式を併用することによって，不正アクセスに対する安全性を高める。  

### RADIUS認証

いかなる利用条件でのアクセスの要求においても認証方法を変更せずに，同一の手順によって普段どおりにシステムにアクセスできるようにし，可用性を高める。

---

## 情報セキュリティ管理

### SaaS(Software as a Service)

サービスの形で提供されるソフトウェア。  
利用者に提供される機能は、クラウドのインフラストラクチャ上で稼動しているプロバイダ由来のアプリケーションである。  
アプリケーションには、クライアントの様々な装置から、ウェブブラウザのようなシンクライアント型インターフェイス（例えばウェブメール）、  
またはプログラムインターフェイスのいずれかを通じてアクセスする。  
ユーザは基盤にあるインフラストラクチャを、ネットワークであれ、サーバーであれ、オペレーティングシステムであれ、  
ストレージであれ、各アプリケーション機能ですら、管理したりコントロールしたりすることはない。  
ただし、ユーザに固有のアプリケーションの構成の設定はその例外となろう。  

### PaaS(Platform as a Service)

サービスの形で提供されるプラットフォーム。
利用者に提供される機能は、クラウドのインフラストラクチャ上にユーザが開発したまたは購入したアプリケーションを実装することであり、  
そのアプリケーションはプロバイダがサポートするプログラミング言語、ライブラリ、サービス、およびツールを用いて生み出されたものである。  
ユーザは基盤にあるインフラストラクチャを、ネットワークであれ、サーバーであれ、オペレーティングシステムであれ、  
ストレージであれ、管理したりコントロールしたりすることはない。一方ユーザは自分が実装したアプリケーションと、  
場合によってはそのアプリケーションをホストする環境の設定についてコントロール権を持つ。  

### IaaS(Infrastructure as a Service)

サービスの形で提供されるインフラストラクチャ。
利用者に提供される機能は、演算機能、ストレージ、ネットワークその他の基礎的コンピューティングリソースを配置することであり、
そこで、ユーザはオペレーティングシステムやアプリケーションを含む任意のソフトウェアを実装し走らせることができる。  
ユーザは基盤にあるインフラストラクチャを管理したりコントロールしたりすることはないが、  
オペレーティングシステム、ストレージ、実装されたアプリケーションに対するコントロール権を持ち、  
場合によっては特定のネットワークコンポーネント機器（例えばホストファイアウォール）についての限定的なコントロール権を持つ。  

![https://www.ap-siken.com/kakomon/28_haru/img/42_2.gif](https://www.ap-siken.com/kakomon/28_haru/img/42_2.gif)  

### 情報セキュリティ早期警戒パートナーシップガイドライン

IPAやJPCERTコーディネーションセンター(JPCERT/CC)等が共同で策定しているガイドラインで、脆弱性関連情報の適切な流通により、  
コンピュータ不正アクセス、コンピュータウイルス等による被害発生を抑制するために、関係者に推奨する行為をとりまとめたものです。  
具体的には、IPAが受付機関、JPCERT/CCが調整機関という役割を担い、発見者、製品開発者、ウェブサイト運営者と協力をしながら脆弱性関連情報に対処するための、  
その発見から公表に至るプロセスを詳述しています。  

本ガイドラインにおいて、ソフトウェア製品に係る脆弱性関連情報取扱の概要は、以下のようになっています。  
[1]発見者は、IPAに脆弱性関連情報を届け出る  
[2]IPAは、受け取った脆弱性関連情報を、原則としてJPCERT/CCに通知する  
[3]JPCERT/CCは、脆弱性関連情報に関係する製品開発者を特定し、製品開発者に脆弱性関連情報を通知する  
[4]製品開発者は、脆弱性検証を行い、その結果をJPCERT/CCに報告する  
[5]JPCERT/CCと製品開発者は、対策方法の作成や海外の調整機関との調整に要する期間、当該脆弱性情報流出に係るリスクを考慮しつつ、脆弱性情報の公表に関するスケジュールを調整し決定する  
[6]製品開発者は、脆弱性情報の公表日までに対策方法を作成するよう努める  
[7]製品開発者は、製品利用者に生じるリスクを低減できると判断した場合、JPCERT/CCと調整した上で、公表日以前に製品利用者に脆弱性検証の結果、対策方法および対応状況について通知することができる  
[8]IPAおよびJPCERT/CCは、脆弱性情報と、③にてJPCERT/CCから連絡したすべての製品開発者の脆弱性検証の結果、対策方法および対応状況を公表する  
[9]IPAは統計情報を、原則、四半期ごとに公表する  

![!](https://www.ap-siken.com/kakomon/03_aki/img/38.gif)  
なお、ウェブアプリケーションに係る脆弱性関連情報の場合には、JPCERT/CCを介さずに、IPAからウェブサイト運営者に対して直接通知される取扱い手順となっています。  

・令和3年秋期 問38  

### JIS Q 27000:2019

情報セキュリティを「情報の機密性、完全性及び可用性を維持すること」と定義しています。  
この定義に集約されているように、情報セキュリティマネジメントにおいては、主に「機密性」「完全性」および「可用性」の3つの特性を維持・管理することが肝要です。  

### JIS Q 31000:2010(リスクマネジメント－原則及び指針)

リスクマネジメントに関する原則及び一般的な指針を示すJIS規格です。この中で残留リスクは次のように定義されています。  

#### 発見リスク

監査手続を実施しても監査人が重要な不備を発見できないリスク

#### 固有リスク

業務の性質や本来有する特性から生じるリスク

#### 投機リスク

利益を生む可能性に内在する損失発生の可能性として存在するリスク

#### 残留リスク(保有リスク)

「リスク対応後に残るリスク」
注記1 残留リスクには、特定されていないリスクが含まれることがある。
注記2 残留リスクは、"保有リスク"としても知られている。

### 機密性 (Confidentiality)

許可された正規のユーザだけが情報にアクセスできる特性を示す。  
認可された利用者に対してだけ，情報を使用させる又は開示する。  

### 完全性 (Integrity)

情報が完全で、改ざん・破壊されていない特性を示す。  

### 可用性 (Availability)

システムが正常に稼働し続けることの度合い。ユーザが必要な時にシステムが利用可能である特性を示す。
認可された利用者が要求したときにアクセスが可能である。  

### 信頼性

利用者の行動と意図した結果とが一貫性をもつ。  

### NISC(内閣サイバーセキュリティセンター)

内閣官房に設置され、情報セキュリティ政策に係る基本戦略の立案、官民における統一的、横断的な情報セキュリティ政策の推進に係る企画などを行う機関です。  
サイバーセキュリティ基本法では、内閣への「サイバーセキュリティ戦略本部」の設置と行うべき事務を規定しており、その事務については内閣官房で処理することと定めています。  
この事務を行うために内閣官房に置かれている組織がNISCです。  

### IPA(情報処理推進機構)

経済産業省所管の独立行政法人です。産業サイバーセキュリティセンターが設置されています。  

### JIPDEC(一般財団法人日本情報経済社会推進協会)

プライバシーマーク制度などを運用する一般財団法人です。  

### JPCERT/CC

インターネットを介して発生する侵入やサービス妨害等のコンピュータセキュリティインシデントについて、  
日本国内のサイトに関する報告の受け付け、対応の支援、発生状況の把握、手口の分析、再発防止のための対策の検討や助言などを、技術的な立場から行う一般社団法人です。  

---

## セキュリティ技術評価

### ファジング(fuzzing)

検査対象のソフトウェア製品に「ファズ（英名：fuzz）」と呼ばれる問題を引き起こしそうなデータを大量に送り込み、  
その応答や挙動を監視することで(未知の)脆弱性を検出する検査手法です。  

ファジングは、ファズデータの生成、検査対象への送信、挙動の監視を自動で行うファジングツール(ファザー)と呼ばれるソフトウェアを使用して行います。  
開発ライフサイクルにファジングを導入することで「バグや脆弱性の低減」「テストの自動化・効率化によるコスト削減」が期待できるため、  
大手企業の一部で徐々に活用され始めています。  

---

## 情報セキュリティ対策

### TPM(Trusted Platform Module)

PCのマザーボード上に直付けされるセキュリティチップで、RSA暗号の暗号／復号や鍵ペアの生成、ハッシュ値の計算、デジタル署名の生成・検証などの機能を有します。  

TPMによって提供される機能には以下のようなものがあります。  
・OSやアプリケーションの改ざん検知  
・端末認証  
・ストレージ全体の暗号化  

### ディジタルフォレンジックス

不正アクセスや情報漏えいなどのセキュリティインシデントの発生時に、原因究明や法的証拠を明らかにするために対象となる電子的記録を収集・解析することです。  

IPAが公表している「インシデント対応へのフォレンジック技法の統合に関するガイド」によれば、  
フォレンジックプロセスは、収集・検査・分析・報告の4つのフェーズから成ります。  

**収集**  
データの潜在的なソースを識別し、それらのソースからデータを取得する  
**検査**  
収集したデータから関連する情報を評価して抽出する  
**分析**  
複数のソースのデータを相互に関連付けるなどして、結論を導き出すためにデータの調査と分析を行う  
**報告**  
分析フェーズによって得られた情報を準備して提示する  

### VDI(Virtual Desktop Infrastructure)

サーバ内にクライアントごとの仮想マシンを用意して仮想デスクトップ環境を構築する技術です。  
利用者はネットワークを通じてVDIサーバ上の仮想デスクトップ環境に接続し、クライアントPCにはVDIサーバからの操作結果画面のみが転送される仕組みになっています。  

この仕組みにより、クライアントがインターネット上のサイトと直接的な通信を行わなくなるので、クライアントPCをインターネットから分離できます。  
もし利用者の操作により不正なマルウェアをダウンロードしてしまったとしても、それが保存されるのはVDIサーバ上の仮想環境ですので、クライアントPCへの感染を防げます。  
汚染された仮想環境を削除してしまえば内部ネットワークへの影響もありません  

### システム運用管理者による機密ファイルの不正な持出しを牽制するための対策

・監視者の配置  
監視によって持ち出しを完全に防げるわけではありませんが、常駐する警備員や設置された監視カメラに常に見られているという意識を持たせ、  
不正行為を実行する気を失くさせることが効果的です。  
・平成26年秋期 問44  

### hostsファイル

TCP/IPを利用するコンピュータにおいてIPアドレスとホスト名の対応を記述するファイルです。  
hostsファイルでは「IPアドレス ホスト名」の形式で1つの行につき1つの対応を記述します。  

IPアドレス「127.0.0.1」は、現在使用している自分自身のコンピュータ(localhost)を指定する特別なアドレス(ローカル・ループバック・アドレス)です。  
Windows環境ではDNSの設定よりもhostsファイルの設定が優先されるので、攻撃者によりhostsファイルが改ざんされると不正なURLへ誘導されたり、  
攻撃の踏み台にされたりするなどの被害が発生する可能性があります。  

### フォールスネガティブ（False Negative）

本来は検知すべき悪意のある活動を、誤って害のないものとして分類すること。  
いわゆる検知漏れ。多くなるほどコンピュータに影響を与え得る攻撃を通過させてしまう可能性が高くなる。  
悪いものをいいと判断してしまう事。  

### フォールスポジティブ（False Positive）

本来は通過させるべき害のない活動を、誤って悪意のあるものとして分類すること。  
いわゆる過剰検知。  
多くなるほど正常な操作の阻害回数や管理者の負担が増える。  
いいものを悪いと判断してしまう事。  

### 耐タンパ性

ハードウェアやソフトウェアのセキュリティレベルを表す指標で、外部から重要データを取り出したり盗み出そうとする行為に対する耐性度合いのことをいいます。  
タンパー（tamper）には「変更する」「改ざんする」「弄る」などの意味があります。  

IoTデバイスの耐タンパ性は、機器内部の機密データの守秘性を高める、内部動作の解析を困難にする、分解すると壊れるようにすることで向上しますから、  
ケースを空けたときに秘密情報を消去する機構である「ウ」が適切となります。  

ちなみに、IoTセキュリティガイドライン(ver1.0)では、耐タンパ性を高める対策例として以下を挙げています。  

#### ハードウェアや構造設計による対策

・機器を分解すると配線が切断されたり、インタフェースが破壊されたりすることで解析を妨げる設計  
・不要な非正規I/Fや露出した配線の除去  
・専用認証デバイスを接続しないと内部にアクセスできない設計  
・漏えい電磁波から内部処理を推定させないための電磁シールド  
・チップや配線の内装化  

#### データやソフトウェア設計による対策

・盗難、紛失時に遠隔から端末をロックする機能の実装  
・ソフトウェアの難読化、暗号化  
・機密データの暗号化、使用時のメモリなど在中時間の短縮  
・実行時のメモリ上でのプログラムやデータの改ざんの防止  

### 盗まれたクレジットカードの不正利用を防ぐ仕組

### 3Dセキュア

盗まれたクレジットカードの不正利用を防ぐ仕組みのうち，オンラインショッピングサイトでの不正利用の防止に有効なもの  
オンライン決済時に本人のみが知る情報（パスワードや属性情報等）を入力させることで、利用者本人が取引を行っていることを確認する仕組みです。  
カードを盗まれたとしても、パスワードは本人しか知らないのでオンラインでの不正利用を防止できます。
令和3年秋期 問42  

### PIN(Personal Identification Number)

暗証番号
オフライン決済時にIC対応カードを決済端末に挿入し、ICチップからカード情報を読み込んで照合する方法です。  
ICチップ内の情報を読み出すことが前提となっているため、オンライン決済の認証には使えません。  

※パスワードとの明確な違い
パスワードはその内容がそのまま、もしくは暗号化されて、ネットワークを通じてサーバ側に届き、サーバ内で保存されているパスワード情報と合致しているかを判定します。  

一方、PINはネットワークには流れることを想定していません。  
PCやスマホの場合は、入力した端末内で、その端末内に保存されているPIN情報との照合を行います。  
ATMでキャッシュカードやクレジットカードを使う場合は、カードに内蔵されたICチップの中にあるPIN情報との照合を、ATM端末を通じて行います。  
![!](https://image.itmedia.co.jp/news/articles/1902/20/pinpass_01.png)  

---

## セキュリティ実装技術

### ブロックチェーン

仮想通貨(暗号通貨)の基盤技術であり、  
"ブロック"と呼ばれる幾つかの取引データをまとめた単位をハッシュ関数で鎖のように繋ぐことによって、台帳を形成し、P2Pネットワークで管理する技術です。  
分散型台帳技術とも呼ばれます。  

日本ブロックチェーン協会では、(広義の)ブロックチェーンを次のように定義しています。  
「電子署名とハッシュポインタを使用し改竄検出が容易なデータ構造を持ち、且つ、当該データをネットワーク上に分散する多数のノードに保持させることで、  
高可用性及びデータ同一性等を実現する技術を広義のブロックチェーンと呼ぶ。」  
![!](https://www.ap-siken.com/kakomon/30_aki/img/44.gif)  

### DNSSEC(DNS Security Extensions)

DNSにおける応答の正当性を保証するための拡張仕様です。  
DNSSECではドメイン応答にディジタル署名を付加することで、正当な管理者によって生成された応答レコードであること、  
また応答レコードが改ざんされていないことの検証が可能になります。  

DNSキャッシュポイズニング攻撃では、攻撃者が偽の応答パケットをキャッシュサーバに送り込み、  
それをキャッシュサーバが受理してしまうことによって攻撃が成立するので、DNSSECの使用が根本的な対策になります。  
しかし、各DNSサーバのDNSSEC対応、電子署名に必要な鍵の管理や配布方法の確立、ルートやTLDの署名が必要なことなど、  
さまざまな課題があり、普及に当たっては今しばらく時間が必要です。  

### IPマスカレード

1つのグローバルIPアドレスで複数のプライベートIPアドレスを持つノードを同時にインターネットに接続させることを可能とする機能です。  

ブロードバンドルータは、LAN内のコンピュータがインターネットに接続する際に、コンピュータのプライベートIPアドレスとポート番号をセットで記憶します。  
そしてインターネットからの応答パケットを受け取ると、ルータはパケットのポート番号と記憶しているポート番号のリストを比較して、  
適切なコンピュータに応答パケットを届けます。  
このとき応答パケットのポート番号が、ルータが記憶しているどのポート番号とも異なる場合には、適切な届け先が見つからず応答パケットは破棄されることになります。  

このようにIPマスカレード機能をもつブロードバンドルータは、不自然(不正)なパケットを内部LANに通すことがないので、ポートスキャンや不正侵入を試みる攻撃などを遮断するセキュリティ効果が期待できます。  

### PPPoE(PPP over Ethernet)

PPPをイーサネット上で利用できるようにしたものです。  
ブロードバンドルータからプロバイダの認証と接続を行うときに使用されていますが、通信経路の暗号化機能は持っていません。  

### WPA(Wi-Fi Protected Access)

無線LANの暗号化規格です。  
コンテンツフィルタリング機能やURLフィルタリング機能はありません。  

### WPS(Wi-Fi Protected Setup)

無線LANの親機と子機の接続設定やセキュリティ設定を容易に行うために策定された規格です。
ウイルス感染を防止する機能はありません。  

### WPAとWPA2のセキュリティプロトコル、暗号アルゴリズム、暗号鍵の鍵長

WPA2(CCMP) AES 128bit

![!](https://www.ap-siken.com/kakomon/30_aki/img/45a.gif)  

### パケットフィルタリング

通過するパケットのIPアドレス(送信元・送信先)やポート番号、通信の方向などの情報をもとに中継の可否を判断する方式です。  
ただし、パケットのペイロード(データ部分)に関してはチェックを行いません。  

パケットはIPアドレス、ポート番号、ペイロードを含んだ入れ物。  
ペイロード自身ではないので、FWではIPアドレスとポート番号によるブロックが有効。  

### SPF(Sender Policy Framework)

SMTP接続してきたメールサーバのIPアドレスを基に、正規のサーバから送られた電子メールかどうかを検証する技術です。  
受信メールサーバ側にて電子メールの送信元ドメインが詐称されていないかを検査できます。  

[1]送信側は、送信側ドメインのDNSサーバのSPFレコード(又はTXTレコード)に正当なメールサーバのIPアドレスやホスト名を登録し、公開しておく。  
[2]送信側から受信側へ、SMTPメールが送信される。  
[3]受信側メールサーバは、受信側ドメインのDNSサーバを通じて、MAIL FROMコマンドに記載された送信者メールアドレスのドメインを管理するDNSサーバに問い合わせ、SPF情報を取得する。  
[4]SPF情報との照合でSMTP接続してきたメールサーバのIPアドレスの確認に成功すれば、正当なドメインから送信されたと判断する。  
![a](https://www.ap-siken.com/kakomon/27_haru/img/44.gif)  

※DNSBL(DNS Blacklist)  
迷惑メールの温床になっているオープンリレーサーバのIPアドレスや、スパム行為の発信元IPアドレスを一覧を公表したもの  

### OP25B(Outbound Port 25 Blocking)

名前の通り、外向き(インターネット方向)のポート25番宛て(SMTP)パケットを遮断することでスパムメールを防ぐ仕組みです。  
ISP管理下の動的IPアドレスからの電子メール送信について、管理外ネットワークのメールサーバへSMTP通信を禁止することで、  
ISPのメールサーバを介さずに外部のオープンリレーサーバと直接コネクションを確立して送信されるスパムメールを防ぎます。  

OP25Bでは、1.動的IPアドレスからの送信である，2.ISPのメールサーバを経由しない という2つの条件を満たした場合のみTCP/25宛てのパケットを遮断します。  

またISPのメールサーバを経由しない場合であっても  
・固定IPからの送信  
・SMTP-AUTHで認証済ノードからの送信  
についてはOP25Bの影響を受けません。  

"25/TCP"を使う通信では正当な利用者でさえ外部のメールサーバと直接コネクションを確立することができなくなってしまいます。  
(例えば外出先で自分が契約しているISPのメールサーバから送信できないなど)  
この弊害を解消するためにサブミッションポート"587/TCP"が利用されるようになりました。  

#### サブミッションポート

ユーザーのメールソフト(メーラー)からメールサーバにメールを届けるときに使用する**送信専用のポート番号**  
メールサーバでは、サブミッションポートにアクセスしてきたユーザをSMTP-AUTHで認証し、認証できたユーザのみからの送信を受け付けることで、  
スパマーの悪用を防ぎつつ、外部のメールサーバを使用したメール送信を可能にします。  

### SMTP-AUTH(SMTP-Authentication)

メール投稿にあたってユーザ認証の仕組みがないSMTPにユーザ認証機能を追加した方式です。  
使用するにはメールサーバとクライアントの双方が対応していなければなりませんが、  
メール送信するときに「ユーザ名とパスワード」「チャレンジレスポンス」などで認証を行い、  
認証されたユーザのみからのメール送信を許可することで不正な送信要求を遮断することができます。  

### SMTP over SSL(TLS)によるサーバ/クライアントの相互認証

サーバは認証局のディジタル証明書をもち，クライアントから送信された認証局の署名付きクライアント証明書の妥当性を確認する。

### POP before SMTP

電子メールを受信した際にパスワード認証が成功したクライアントのIPアドレスは，一定時間だけSMTPサーバへの電子メールの送信が許可される。

### APOP(Authenticated POP)

メール受信前の認証におけるパスワード送信を暗号化(MD5ハッシュ化)することで安全性を高めたプロトコルです。  
パスワードを秘匿するために，パスワードからハッシュ値を計算して，その値で利用者が電子メールを受信する際の利用者認証を行う。  
暗号化されるのはパスワードだけなので、メール本文は暗号化されず平文のまま通信経路上を流れます。  

### IMAPS(IMAP over SSL/TLS)

メール受信プロトコルであるIMAP(Internet Message Access Protocol)にTLSを組み合わせ、TLSによって暗号化された通信コネクション上でメール受信を行うプロトコルです。  
バージョン番号を付けてIMAP4Sと表記されることもあります。  

既存のプロトコル名の後ろに"S"が付いているものは、TLSにより暗号化されたものであることが多いです。  
HTTPSもその1つです。POP3にもTLS版であるPOP3Sというプロトコルがあります。  

### SMTP Submission

SMTP Submissionは、ユーザ(メールソフト)からのメール送信を専門に受け付けるサブミッションポート(587/TCP)を用意し、  
SMTP-AUTH認証を経たユーザからのメールだけを送信する仕組みです。  
メール受信用途ではなく、OP25Bの影響を受けずに外部のメールサーバを使用したメール送信を可能にする仕組み。  

### クリックジャッキング

攻撃者が用意したWebページの前面に透明化した別のWebページを重ねることでユーザを視覚的にだまし、正常に視認できるWebページ上をクリックさせることで、  
透明化したWebページのコンテンツを操作させる攻撃です。  
ユーザのクリックを奪うという攻撃の特徴からクリック・ジャッキングと呼ばれます。  

対策:
HTTPレスポンスヘッダにX-Frame-Optionsを設定する。 ○  
→
"X-Frame-Options"は、フレーム要素（`<frame>`または`<iframe>`）を使用したコンテンツ表示を許可するかどうか指示するためのHTTPヘッダで、  
値として"DENY(拒否)"または"SAMEORIGIN"を指定することがクリックジャッキング攻撃への対策となります。  
クリックジャッキング攻撃は、別サイトのHTMLをフレーム要素で読込み、それを透明化して罠サイトの上に重ね合わせるため、  
フレーム要素を使用した他サイトの表示を禁止すれば防ぐことができます。  

HTTPレスポンスヘッダにX-Content-Type-Optionsを設定する。 ×  
→
"X-Content-Type-Options"は、ブラウザによるMIMEスニッフィングの有効・無効を指示するためのHTTPヘッダで、  
値として"nosniff"を指定することがクロスサイトスクリプティングへの対策になります。  
MIMEスニッフィングとは、WebサーバからMIMEタイプ（メディアの種類）が指定されないなどの理由でリソースのMIMEタイプが不明なとき、  
ブラウザがリソースのバイトストリームを調べ、MIMEタイプを推定する機能です。  
これが有効になっていると、攻撃者がJSONや画像内に埋め込んだスクリプトを不正に実行してしまうおそれがあります。  
これを防止するためのヘッダが"X-Content-Type-Options"です。  

### WAF(Web Application Firewall)

特徴的なパターンが含まれるかなどWebアプリケーションへの通信内容を検査して，不正な操作を遮断する。  
パケットのヘッダ部だけでなくペイロード部(データ部分)をチェックすることで、Webアプリケーションに対するこれらの攻撃を検知し、遮断することが可能です。  

### サンドボックス(Sandbox)

外部から受け取ったプログラムを保護された領域で動作させることによってシステムが不正に操作されるのを防ぎ、セキュリティを向上させる仕組みです。  
JavaアプレットやAdobeFlash、Webブラウザのプラグインなどでは外部プログラムの機能を制限することで脆弱性を低減させています。  
最近では、仮想環境として構築したサンドボックスが、未確認ファイルや不審ファイルの動作確認に使えることから標的型攻撃への対策としても注目を集めています。  
サンドボックスとは「砂場」のことであり、子供を安全が確保された場所内だけで遊ばせるイメージからこう呼ばれています。  

### SSH(Secure Shell)

公開鍵暗号や認証の技術を利用して、安全にリモートコンピュータと通信するためのプロトコルであり、  
SSLと同様にトランスポート層とアプリケーション層で通信を暗号化します。  

当初はrlogin，rshやTelnetを安全に利用する手段として用いられていましたが、現在ではポートフォワーディング機能を用いることで、  
POP3やFTPなどネットワーク上に平文のパスワードが流れてしまう既存のプロトコルを安全に利用する技術としても広く利用されています。  

#### ポートフォワーディング

ローカルホストの任意のポートに送信したデータを、リモートホストの特定ポートへ転送する機能  

---

## 1回目に間違えた問題
