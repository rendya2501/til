# 4章.システム構成要素.過去問

## 要点

- RAID  
- MTBF,MTTR  
- 信頼性特性  
- ターンアラウンドタイム  

---

## RAID

- 安価な複数台の磁気ディスクを組み合わせて全体として高い信頼性を得る方式。  
- RAID0～5の区別は本来のデータとエラー訂正用のデータ（ハミング符号・パリティビット）を、どのように書き込むかによって定義されている。  

- RAID 0  
  複数のディスクにデータを分散して書き込むストライピング  
- RAID 1  
  2台の磁気ディスクに同じ内容を書き込むミラーリング  
- RAID 2  
  ストライピング＋エラー訂正用のハミング符号をディスクに書き込む。最少でも5台構成となる。  
- RAID 3  
  ストライピング＋エラー修正用にパリティビットを1台のディスクに書き込む  
- RAID 4  
  RAID3のパリティビットの書き込みをブロック単位で行う。  
- RAID5  
  パリティビットもデータと同様に分散して書き込む。  

---

## システム信頼性特性

- **ホットスタンバイ方式**  
  主計と同じ業務システムを最初から待機系でも起動しておき、メインシステムに障害が発生したら直ちに待機系に切り替える方式。  
- **ウォームスタンバイ方式**  
  システム(OS)は起動しているが、業務システムは起動しないで待機させる方式。  
- **コールドスタンバイ方式**  
  通常、待機系では他の処理を行い、主系に障害が発生した時点で切り替える方式  
  電源を切って待機させておく状態もコールドスタンバイに該当する。  
- **ホットサイト**  
  災害が発生しないと思われる地域にバックアップセンタを配置して待機させておく方式。  
  定期的なデータの同期を行い、常に災害に備える。  
- **コールドサイト**  
  設備を整えた施設を用意しておき、災害が発生したら機材などを搬入してバックアップセンタとして機能させる方式。  

_

- **フォールトトレランス**  
  障害が発生した時に必要な機能を提供し続けること(耐故障:tolerance)を目指す設計手法。  
  故障が発生した場合でも機能を縮退させることなく稼動を継続する概念。  
- **フォールトアボイダンス**  
  システムを構成する機器に信頼性(稼働率)の高いものを使用することで、故障そのものを排除(アボイド)しようとする設計手法。  
- **フォールトマスキング**  
  故障が発生したときに，その影響が誤りとなって外部に出ないように訂正すること。  
- **フールプルーフ**  
  意図しない使われ方をしても、システムとして誤作動が起こりにくいように設計するという考え方。  
- **フェイルセーフ**  
  故障が発生したときに，あらかじめ指定された安全な状態にシステムを保つこと。  
- **フェイルソフト**  
  システムに障害が発生した時に、多少の性能の低下を許容し、システム全体の運転継続に必要な機能を維持させようとする考え方。  
  縮退運動(**フォールバック**)  
- **フェイルオーバー**  
  障害が発生したとき、他のシステムが処理やデータを自動的に引継ぎ、障害による影響(切り替え処理)を利用者に意識させないようにするという考え方。  
  障害が回復した後、元のシステムに処理を戻す(**フェールバック**)  

---

## MTBF,MTTR

- **MTBF(Mean Time Between Failures)** :  
  システムが修理され正常に稼働し始めてから、次回故障するまでの**平均故障間隔**  
- **MTTR(Mean Time To Repair)** :  
  システムの障害から回復するために要した**平均修復時間**  

- 稼働率を求める式は、MTBF／(MTBF＋MTTR)  
  0.5の時同じになる。  
  1.5倍にしても同じ  

  ```:math
  1.5MTBF／(1.5MTBF＋1.5MTTR)  
  ＝1.5MTBF／(1.5(MTBF＋MTTR))  
  ＝MTBF／(MTBF＋MTTR)  
  ```

稼働率Rの装置が2台並列接続されている場合、システム全体としての稼働率は以下の公式で表されます。  
`1－(1－R)^2`  

- MTBFを長くするよりも，MTTRを短くするのに役立つもの  
  エラーログの取得、命令トレース機能、遠隔保守、保守部門の分散配置など  
  →  
  エラーログには障害原因に関連する情報が記録されていることがあります。  
  障害発生時にエラーログを分析することは、障害原因を迅速に特定する手段として有効です。  このためエラーログ取得機能はMTTRを短くするのに役立ちます。  
  →  
  予防保守では異常がないかをチェックしたり経年劣化した部品を故障前に交換したりするので、障害発生を未然に防ぐ効果があります。  
  よって、MTBFを長くするのに役立ちます。  

_

### MIPS(Million Instructions Per Second)

CPUが1秒間に実行可能な命令回数を百万単位で表した指標  
100MIPSのコンピュータが1秒あたりに実行可能な命令数は10,000万回  

### TPS(Transaction Per Second)

1秒当たりのトランザクション数

---

## ターンアラウンドタイム

入力の開始時点からすべての出力を終えるまでに要する時間のこと。  
`TAT = 処理待ち時間 + CPU時間 + 入出力時間`  

ジョブの多重度が1で，到着順にジョブが実行されるシステムにおいて，表に示す状態のジョブA～Cを処理するとき，ジョブCが到着してから実行が終了するまでのターンアラウンドタイムは何秒か。ここで， OSのオーバヘッドは考慮しないものとする。  
→  
ジョブCが到着してからなので、Cが到着してから11秒経過したら終わる計算になる。

---

## OS

### ハイパバイザ

ハードウェア上で直接稼働し仮想マシンの土台となるミドルウェアです。  

- **カーネル**  
  OSプログラムの中核を担う部分のこと。  
- **モノリシックカーネル**  
  カーネル自体に多機能を持たせるアーキテクチャ。  

---

- **シンクライアント**  
ユーザが使用する端末にデータやアプリケーションを持たせず、  
サーバに接続するための必要最小限のネットワーク機能や入出力用のGUIだけを装備させ、  
サーバ側で必要なデータ処理をするものを指します。  
シン（Thin）とは「薄い、少ない」の意味です。  

- **分散システムにおけるアクセス透過性**  
地理的に離れた場所にあるシステムにアクセスするときに、  
そのシステムが遠隔地にあることを意識することなく同一の方法でアクセスできる性質です。  
この項目はDBの章にある話だけど、まぁいいか。  

- **アクセス透過性**  
遠隔地の資源にアクセスする際に、同一の方法でアクセスできること  
- **移動透過性**  
使用中の資源の位置を移動できること  
- **位置透過性**  
遠隔地の資源にアクセスする際に、データの位置を意識せずにアクセスできること  
- **規模透過性**  
OSやアプリケーションの構成に影響を与えずにシステムの規模を変更できること  
- **障害透過性**  
システムや資源の一部の障害によりシステム全体の機能が停止し，処理が中断されることがないこと  
- **複製透過性**  
資源が複数の位置に複製され配置される場合でも、利用者にはそれらが1つの資源として見えること  
- **並行透過性**  
複数のプロセスを並行処理できること  

_

### サーバコンソリデーション

仮想化技術を用いることで、複数の専用サーバに分散・非効率化していたアプリケーションや機能を1台(または少数)の物理サーバに整理統合することです。  
物理サーバの台数が減るので、保守費用、消費電力、設置スペースなどの維持管理コストの削減を図ることができます。  
コンソリデーション(consolidation)は、統合、統一、合併、整理などの意味を持つ言葉です。  
令和2年の新しい問題。道理で聞きなれない単語だと思った。  

_

### ストレージ技術におけるシンプロビジョニング

- 一言でいうと、使う分だけ割り当てましょうって話。  
- ハードディスク装置などの外部記憶装置(ストレージ)群を仮想化することで、物理的な記憶容量より多くの容量を利用者に割り当てることを可能にする仕組みです。  
- 利用者の要求する記憶容量を最初から物理ディスク容量として割り当てると、未使用の物理ディスク領域が多くなり無駄が生じます。  
- シンプロビジョニング機能が導入されたストレージでは、利用者の要求に応じて今後使用する予定の最大容量を割り当てておいて、実際の内部では使った分だけの物理容量を割り当てるということを行います。  
- プロビジョニング（Provisioning）: 供給・支給・提供・引き当て  

_

### ライブマイグレーション

- ある物理サーバ上で稼働している仮想マシンを、OSやソフトウェアを停止させることなく別の物理サーバに移し替え、処理を継続させる技術です。  
- 切り替えによるダウンタイムはほとんどゼロで、移動前の処理やセッションが全て引き継がれるため可用性を損なうことがありません。  
- Migration:移動,移住  

_

### CDN(Contents Delivery Network)

- 主にWebシステムにおけるコンテンツ配信の高速化・効率化を目指して最適化された配信インフラのこと。  
- 音楽や動画(ストリーミングを含む)などのマルチメディアコンテンツ、大容量データの配信を安定的に配信する手段として用いられている。  
- キャッシュサーバの活用やトラフィック分散、ルーティングの工夫でネットワーク負荷を低減し、ユーザにより速くコンテンツを届けられるように構築されている。  

_

### クライアントサーバシステムの3層アーキテクチャ

- サービスを要求する側であるクライアントと、サービスを提供するサーバにアプリケーションの機能を分離した垂直分散システムの一形態  
- ユーザの入出力を担当するプレゼンテーション層，業務処理に依存するデータ加工を行うファンクション層，データベース処理を行うデータ層の3層に機能を分離したシステムモデル  
- 各層のOSは異なってもよい。  

_

### グリッドコンピューティング

- インターネットなどのネットワーク上にある計算資源（CPUなどの計算能力や、ハードディスクなどの情報格納領域）を結びつけ、ひとつの複合したコンピュータシステムとしてサービスを提供する仕組みです。  
- 大規模分散といえばHadoop。実際これでよかったみたい。  

_

### 稼働率

稼働率R  
直列 : R * R  
並列 : 1 - (1 - R)^2  
並列接続、どちらかの装置が稼働していれば、システムは稼働する。  
言い換えれば、両方の装置が不稼働となったとき以外は稼働する。  
システム全体の稼働率 = 1 - システムが稼働しない確立  
R : 稼働率  
1 - R : 稼働していない率  
(1-R)(1-R)どちらも稼働していない率  
システムがすべて稼働している確立100％ - どちらも稼働していない率 = どちらかが稼働している率  

なんかの問題はこういう図式だった。  
1 - 両方が稼働している場合 - 両方が故障している場合  

_

### キャパシティプランニング

- 情報システムの設計段階で現状の最大負荷だけでなく、将来予測される最大負荷時にもサービスの水準を維持できるような設計を検討すること  
- 検討対象
  - CPU性能
  - メモリの大きさ
  - メモリのアクセス時間
  - チャネルの種類と転送速度
  - 入出力データの転送速度
  - 通信速度
- キャパシティプランニング実施手順  
  1. 現行システムをモニタリングし現状の処理能力を把握する
  2. 将来的に予測される端末の増加、利用者数の増加などを分析する
  3. 2の分析結果からシステム能力の限界時期を予測する
  4. 新たなシステム構成で実現すべき性能要件から必要なハードウェア増設を検討する

サーバーの性能向上策

- **スケールアップ** : サーバー単体の処理能力を向上させる  
- **スケールアウト** : サーバーの台数を増やし負荷分散させる  

_

### モニタリング

- 監視・計測用のプログラムを用いてシステムの稼働状態や資源の状況を測定し、システム構成や応答性能のデータを得る手法  
- 得られたデータをもとに性能評価やボトルネックの発見などを行い改善に繋げます。  
- モニタリングツールは、ソフトウェアモニタとハードウェアモニタに大別されます。  

_

### クラスタリングシステム

- クラスタシステムのうち、高可用性を実現するものを「HA(High Availability)クラスタ」といいます。  
- 通常、HAクラスタは正常時に稼働を行う主系と障害発生時に処理を引き継ぐ予備系の二重構成をとることで耐障害性を高めています。  
- **フェールオーバ**は、障害発生時に主系から予備系への引き継ぎを自動的、かつ継ぎ目なしに行う機能で、HAクラスタなどの高信頼性が要求されるシステムに実装されています。  
- このようなシステムでは主系と予備系の間で「ハートビート」と呼ばれる主系の状態を監視するためのパケットが定期的にやり取りされます。
- 予備系はハートビートの受信が途絶えると主系に障害が発生したと判断し、自律的に主系の処理や設定を引き継ぎ、新たな主系として稼働を始めます。
- このように障害が発生した場合にも利用者に気付かれることなく処理の継続ができることで信頼性が向上します。

Q:  
仮想サーバの冗長化設計における可用性評価に関する記述のうち，クラスタソフトウェアを用いた評価として，適切なものはどれか。  

A:  
OS，アプリケーション及びハードウェアの障害に対応し，障害時に障害が発生していないサーバに自動的に処理を引き継ぐので，切替え時間の短い安定した運用が求められる場合に有効である。  

_


計算問題あったでしょ。
俺、変数をnとmで定義したけど、成功率があるなら失敗率もあるわけで、
成功の反対が失敗なんだからnと1-nの関係が成り立つってクソ単純なことを見落としていた。  
俺が頭悪いのはそういうところだぞ。  



Q:  
Webサーバ，アプリケーション(AP)サーバ及びデータベース(DB)サーバが各1台で構成されるWebシステムにおいて，次の3種類のタイムアウトを設定した。タイムアウトに設定する時間の長い順に並べたものはどれか。ここで，トランザクションはWebリクエスト内で処理を完了するものとする。  
〔タイムアウトの種類〕  
APサーバのAPが，処理を開始してから終了するまで  
APサーバのAPにおいて，DBアクセスなどのトランザクションを開始してから終了するまで  
Webサーバが，APサーバにリクエストを送信してから返信を受けるまで  
平成31年春期　問12  
2問目／選択範囲の問題数45問  

これはね、業務でやってる話ですからね。 