# 平成27年春季

---

## 組み込みシステム 自動車用衝突被害軽減ブレーキシステム

うーん・・・半分か。  
これも計算問題が出てきた。  
距離の計算なのだが、それだけでも結構怪しかった。  
中学校からやり直さないといけない。  

ウォッチドッグタイマーの問題を外したのは痛かった。  
多分ほとんどの人間も15を選んだのではなかろうか。  
後は、条件式の問題だ。  
ありゃ？よく見れば思いっきり答えっぽいものがあるな・・・。  
マイナスの事も考えれば当然0以上でなければいけないわけで、なぜこの選択肢が目に入らなかったのか理解できない・・・。  

最初は簡単だと思っていたが、段々点数が取れなくなってきた。  
でも、書いてあること自体は理解できるので、俺の基礎的な知識不足が脚を引っ張っているだけか。  

・分周の意味  
・ウォッチドッグタイマー  
・距離の計算  

``` txt : 回答 30分 5/10
## メモ

衝突までの予測時間・・。
今の速度と相手までの距離
み　は
じ
やべ。簡単な計算が・・・。

10メートル離れている。
次は9メートル。
相対速度は 1m / 0.02s = 50m/秒
今回測定した距離と速度から時間を算出すると？
9m / 50m/s = 0.18s
= 9m * s / 50m
= 9s / 50
= 0.18s

18km/h
18km / 3600s = 0.005km/s = 5m/s

1.5 * 5 = 6.5
1.48 * 5 = 6.4
↑
よく見ると計算間違っているのだが？7.5じゃね？
なんだよ自分で答えの一歩手前まで計算できるてるじゃねーか!!

0.02 = x / 8 * 10^6
0.16 * 10^6
160000



## 1
[1]
a：0.02
b：d2
c：s

[2]
車間距離が開いている状態 ○
他 : 車間距離が広がっている(道場)

[3]
0.4 × 1.5


## 2
[1]
160000 × 20000

[2]
d エ × イ
e ア

[3]
常に警告が表示されてしまう ×
衝突を回避しても警告が止まらない


## 3
イ × ウ
```

``` txt 解説
## 1
きほん : 速度 = 距離 ÷ 時間

(2)
衝突までの予測時間とは、現在の相対速度が継続したときに前の車両と衝突するまでの時間のことで、以下の式で求めることができます。
予測時間 = 現在の車間距離 ÷ 相対速度
現在の車間距離は、前の車両との距離を今回測定した値である d2 です。相対速度には s が入ります。

ここ「み は じ」のあれで行けば時間は道のりと早さの掛け算だから、中々この思考にたどり着かなかった。
ホント、頭悪いなって思う。

(3)
問題文の〔自動ブレーキの構成と動作〕⑤より、緊急ブレーキが作動するのは予測時間が1.5秒未満になったときとわかります。
ブレーキが作動したときの前の車両との距離は以下の式で求めます。
速度(m/s)＝18×1,000m÷3,600秒＝5(m/s)
車間距離＝5(m/s)×1.5秒＝7.5m
これより、前の車両との距離が7.5mの時点でブレーキが作動します。
ブレーキが作動してから停止するまでの走行距離は6mであるため、停止した時の前方車両との距離は「7.5－6＝1.5m」になります。

∴1.5

え、あ、それだけか・・・。
こういう単純なロジックを組み上げるのも割と苦手かもなぁ・・・。
でも、言われてみればこれしかないんだよなぁ・・・。
解いているときは、ここで0.02秒のロジックの事を考えてしまった。
後は1.5秒未満ってところ。
小数点第2位を切り上げって表現も何かしら面倒くさい計算をするんだろうなーって思った。

「1.5未満」ということを厳密にとらえずに、1.5秒の時と考えればいいってitecは書いてあるな・・・。
いや、ならそういってくれよって思うけど・・・。



## 2
[1]
図３の制御部のMCUブロック図よりクロック入力は8MHzであることがわかります。また、分周器は8分周であると説明されています。
クロック入力を8分周した場合のクロック周波数は以下になります。
 8MHz÷8分周＝1MHz
周波数(Hz)とは、1秒間に存在する波の数で、1MHzは1秒間に1,000,000回の波が生じることを表しています。
1,000,000回／秒の波を使って20ミリ秒（1／50秒）をカウントしたいので、タイマのカウント値に設定すべき値は、
 1,000,000回×1／50＝20,000回
∴20,000

あー・・・やっちまったな。
分周は周波数を割るって認識でよかった。
でもって、問題文中に8MHzってかかれてますね。
これを8で割ったら1MHzになりますね。
1Mって100万ですよね？
1秒間に100万回カウントダウンするわけで、0.02になるためには20000をセットしないといけないというわけです。

[2]
問題文の〔制御部の構成とタイマ割込みソフトウェア〕に、タイマ割込みは20ミリ秒間隔で発生すると説明されています。
よって、図４のフローが20ミリ秒間隔で実行されることになります。
処理B「警告信号の出力を停止」を行わない場合、単純に警告信号が消えない不具合が発生します。
具体的には、警告信号が出力された後、予測時間が0秒未満または3秒以上（警告対象外）になっても警告信号が表示されたままになってしまいます。
警告信号は衝突しそうなときに出力されるので、「衝突を回避しても警告が止まらない」などの言葉が適切となります。
∴衝突を回避しても警告が止まらない

パッと見、通常状態でも警告が表示されるように見えたのでその通りに応えたが、考えてみれば、そうだよなって思う。
警告が表示されて、原則したとしても、確かにこの条件なら表示され続けてしまう。
もう一つ必要だったというわけか。
この考えに至るためにはユースケースを考えないといけない。
それも常識的な範囲でだ。



## 3
20msの中での話だと思い込んだ結果。
全体は20msで応答に10ms。
間をとって15msがもっともらしいと感じる。
まぁ、感じるだけで、25という選択肢がある地点で疑うべきではあった。
しっかり解説を読み込むことにする。

あー・・・。なんか色々勘違いしてたな。
問題文を読めば、割り込みを発生させる間隔とある。
20ms以内に発生させてしまったら意味ないじゃないか。
20ms超えてリセットされないってことは異常なわけだから、普通に考えて20ms以上の選択肢を選べばいいだけの話か・・・はぁ。


●解説
※ウォッチドッグタイマ
システムに異常が発生したことを検知し、それを通知する目的で設定されるタイマです。
ウォッチドッグタイマには適切な時間がセットされていて、システムが正常なときは一定時間ごとにカウントをリセットしています。
しかし、システムに異常が起こるとリセットが行われなくなり、ウォッチドッグタイマのカウントが増加し続けることになります。
リセットがされないまま所定の時間を経過した場合には、システムに何らかの異常が発生していると判断し、
ウォッチドッグタイマがノンマスカブル割込みによってシステムに異常を通知するという仕組みになっています。

タイマ割込みソフトウェアにおけるタイマ割込みは20ミリ秒周期で実行され、タイマ割込みのフロー中でウォッチドッグタイマの初期化が行われています。
タイマ割込みが20ミリ秒周期なので、ウォッチドッグタイマに20ミリ秒よりも短い時間を設定すると、（タイマ割込みが正常に動作していたとしても）次のタイマ割込みの前に異常通知が行われてしまいます。このため、ウォッチドッグタイマの割込み時間には20ミリ秒よりも長い時間を設定する必要があります。

選択肢の中で20ミリ秒よりも長い時間は「ウ」だけです。
```
