# H26A

## セキュリティ ネットワークやWebアプリケーションプログラムのセキュリティ

全体的な話はわかったのだが、FWやWAFは何が防げて何が防げないのかあいまいだったのでそこをまとめる。  
間違った問題も、そのあいまいな点を付いた問題だった。  
他は特に問題ない。  
この年はセキュリティが必須になった年の影響なのか、全体的に簡単というか、かなり基礎的な内容に押さえられている気がした。  

FW  
IPアドレスやポート番号を用いたパケットフィルタリング(通過の可否判定)を行う。  
これらの値が特定できないアクセスは通過させてしまう。  
極端な事を言えば、FWで全ての宛先IPアドレスについて拒否してしまえば、全ての攻撃を防ぐことが出来る。  
外部から受け付ける必要があるアクセスと同じ宛先IPアドレスと宛先ポート番号をもったものは通過させる必要がある。  
なので、これを偽装した攻撃をFWは防ぐ事が出来ない。  

``` txt : 回答 16分 6/7
## 1
ア、イ、オ × ア、イ


## 2
ウ、イ、エ


## 3
ウ、イ


## 4
あらかじめ定められた一連の手続きのHTTP通信

↑模範解答そのまま。なんせコピペだからな!!
そんなはずがないと小一時間悩んだが、結局それ以外の回答は考えられず、しかも普通に正解だったのは拍子抜けした。
```

``` txt : 解説
## 1
[a]
正しい。DNSサーバは、外部からのDNSリクエストを処理できるようにDMZに設置されています。FWで外部からDNSサーバへ通信を遮断してしまうと、X社ドメインに対する名前解決ができなくなってしまいます。このためFWでは、DNSサーバに対して行われるDNSの仕組みを悪用した攻撃を防げません。

[i]
正しい。Webサーバは、外部からのHTTPリクエストを処理できるようにDMZに設置されています。SQLインジェクションやXSS、ディレクトリトラバーサル等の攻撃は正規のHTTPリクエストに則って仕掛けられるため、FWでこれらの攻撃を遮断しようとすると、正規のHTTPリクエストまで遮断してしまうことになります。このためFWでは、HTTPを用いたWebサーバへの攻撃を防げません。

[u]
誤り。図2「X社のセキュリティ要件」で説明されているように内部ネットワークから外部の通信、および外部から内部ネットワークへの通信は、全てDMZのサーバを介して行われます。このため業務上必要とされる通信に外部と内部が直接コネクションを確立する類のものは存在しないと判断できます。
外部から内部に直接接続しようとする通信をFWで遮断してしまえば、内部Webサーバを狙った、外部からの不正アクセス攻撃を防げます。

[e]
誤り。「ウ」と同様に、内部ファイルサーバを狙った、外部からの不正アクセス攻撃はFWで防ぐことができます。

[o]
誤り。「X社のセキュリティ要件」の1.2「業務上必要がない通信は全て禁止すること」、
およびプロキシサーバの用途は「内部ネットワークからのHTTPアクセスを代理する」ことに限られているので、プロキシサーバへはHTTP以外の通信を許可する必要がありません。
さらにHTTP通信に関しても、内部ネットワークからのHTTPリクエストに対応するHTTPレスポンスだけをFWで通過させればよいため、
送信元IPアドレス、宛先ポート番号、通信の向きが合致するHTTPレスポンスだけを許可し、他のプロキシサーバ宛てのHTTP通信は全て遮断してしまっても問題は生じません。
以上より、プロキシサーバに対するポートスキャンのパケットは全てFWで防げると判断できます。

itec
ポートスキャンに関しては、公開しているサービスと一致しない宛先ポート番号を拒否することによって防ぐことが出来る。


## 2
〔aについて〕
IDS(Intrusion Detection System，侵入検知システム)
ネットワークやホストをリアルタイムで監視し、異常を検知した場合に管理者に通知するなどの処置を行うシステムです。
異常を検出し、通知することを主目的としたシステムのため通信の遮断などの防御機能は持たないことがほとんどです。

IDSは通過するパケットを監視し、異常を検出するシステムであるため「ウ」が適切な説明です。

∴ウ：IPパケットの中身を調べて不正な挙動を検出する

〔bについて〕
IPS(Intrusion Prevention System，侵入防止システム)
ネットワークの異常を検知し管理者に通知するNIDS(Network IDS)を発展させた形態で、
従来のNIDSが備えている機能に加えて不正アクセスの遮断などの防御機能が使用可能なシステムです。

IPSは通過するパケットを監視し、異常があれば管理者に通知するとともに当該パケットを遮断するシステムであるため「イ」が適切な説明です。

∴イ：IPパケットの中身を調べて不正な挙動を検出し遮断する

〔cについて〕
WAF(Web Application Firewall)
通過するパケットのIPアドレスやポート番号だけでなくペイロード部(データ部分)をチェックすることで、
Webアプリケーションに対する攻撃を検知し、遮断することが可能なファイアウォールです。
Webアプリケーションの防御に特化しているという記述、さらに暗号化・改ざん検知などを行う仕組みではないという点から「エ」が適切とわかります。


## 3
〔dについて〕
ルータとFWの間は、X社とインターネット上の外部ネットワーク間で行われる全通信の通過点です。ここにIPSを設置することで、X社内ネットワークに届く前にFWに遮断されてしまう通信も含め、外部からの攻撃／不正パケットをすべて監視し侵入防止をすることが可能になります。（ただし通信量によってはIPSの能力がボトルネックになってしまいます）

∴d＝ウ：外部からの不正アクセス攻撃の検出や防御をX社内ネットワーク全体に対して行うこと

〔eについて〕
WAFは、Webアプリケーションプログラムに特化した、攻撃パケットを監視・防御する仕組みです。WAFの防御対象はWebアプリケーション及びWebサーバであるため「イ」が適切な記述です。

∴e＝イ：WebサーバのWebアプリケーションプログラムの脆弱性を悪用した攻撃


## 4
セキュリティ要件2.3では、

「Webアプリケーションプログラムの脆弱性を悪用した攻撃を防ぐために，インターネットから，Webサーバにアクセスする通信は，
あらかじめ定められた一連の手続きのHTTP通信だけを許可すること」

と規定しています。

ホワイトリストは、パケットをすべて「拒否」する初期状態に、通信を「許可」する通信データパターンを定義したものです。
ホワイトリストの情報＝WAFを通過させるパケットであるため、
セキュリティ要件2.3で許可すべきとされているWebサーバに対する「あらかじめ定められた一連の手続きのHTTP通信」のパターンをWAFのホワイトリストに記述することで、
上記の要件を満たせます。

∴あらかじめ定められた一連の手続きのHTTP通信
```

---

## 組み込みシステム
