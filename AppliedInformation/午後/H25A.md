# H25A

## セキュリティ Webサイトのセキュリティ強化策

地味に難しかった。  
全部正解してもおかしく無かったので、あまりうれしくない。  
FQDNの復習とロードバランサに証明書を置かなければならない理由をしっかりやる。  
SSLサーバー証明書なのか、ルート証明書なのか若干迷ったのもよろしくない。  

FQDNは.co.jpとかそこら辺までか。そこから先はファイル名なので違う。  
ロードバランサで必要だったのは、クッキーの情報を読む必要があるから。  
HTTPSなら復号しないと中身が読めない。だからロードバランサに証明書を置いて、そこで復号できる必要がある。  
なるほどねって感じ。  

itec  
>セキュリティ対策の問題。この問題で扱われている4つの脅威については、名称と対策をきちんと理解しておきましょう。  
>また、設問2，3で問われているSSLについては、暗号化に関する知識があれば正解できる内容ですが、解説を通してSSLによる通信の流れを理解しておきましょう。  

``` txt : 回答 25分 10/12
## 1
1: ユーザーID ← 本当はユーザIDじゃないとだめ。本文にはそう書かれているから。
2: パスワード


## 2
[1] エ
[2] イ
[3] オ


## 3
[1]
a: イ
c: オ
d: カ

[2]
b: www.a.co.jp/member/ × www.a.co.jp

[3]
機器 : ロードバランサ
理由 : Webアプリケーションのセッションを維持する必要があるから 0%
→
Cookieの情報を参照する必要があるから


## 4
セキュリティ証明書を更新する 100%
→
SSLサーバー証明書を更新する
```

``` txt : 解説
## 2
[1]
認証情報をやり取りする場面では、必ずHTTPSの暗号化通信を使用するように仕向けているため盗聴対策と判断できます。
HTTPSは「通信の暗号化」「ノード認証」「改ざん検知」の機能を提供しますが、Webアプリケーションへの攻撃を防御する仕組みではないため、この策で対処できるのは盗聴のみです。

∴エ：認証情報の盗聴

[2]
WebサーバがDMZに設置されている場合は外部(インターネット上)の端末とWebサーバが直接コネクションを確立して通信を行います。
しかしWebサーバを内部LANに移設した場合は、外部からのアクセスはHTTPアクセスは、一旦リバースプロキシサーバに渡され、
リバースプロキシサーバが改めてWebサーバと通信を確立する形になります。
リバースプロキシサーバを使用することでWebサーバの情報が外部から隠蔽されるため、Webサーバの内部へ不正アクセスを試みる攻撃へのセキュリティが強化されます。

∴イ：Webサイトの改ざん

[3]
WAF(Web Application Firewall)は、通過するパケットのIPアドレスやポート番号だけでなく
ペイロード部(データ部分・アプリケーション層のヘッダ部)をチェックすることで攻撃を検知・遮断することが可能な、Webアプリケーションに特化したファイアウォールです。

WAFの特徴と本文中にWebアプリケーションに対する攻撃を防御するという旨の記述があることから、
この策はWebアプリケーションの脆弱性を突いて攻撃を行う「SQLインジェクション」および「クロスサイトスクリプティング」からWebサーバやDBサーバを守るものと判断できます。

∴オ：SQLインジェクションおよびクロスサイトスクリプティング



## 3
[1]
〔aについて〕
SSL/TLSでは、暗号化通信に用いる共通鍵を安全に送付・共有するためにサーバの公開鍵が使用されます。
またSSL/TLSでは、通信を開始するのに先立ってサーバが自身の公開鍵証明書をクライアントに送信し、
クライアントが公開鍵証明書に付されている認証局(CA)のディジタル署名を検証することで公開鍵、および通信相手の正当性を確認します(なりすましの防止)。

本文中の「HTTPSを使って通信をするために必要」「認証局に申請して取得する」「機器に導入する」などの記述から、aは、
A社のサーバにインストールするサーバ証明書(公開鍵証明書，ディジタル証明書)ということが分かります。

∴a＝イ：SSLサーバ証明書

ルート証明書はルート認証局の身元を証明する電子証明書。  
まぁ、普通に考えてルートなわけないので、スルーでおけ。


〔cについて〕
まず本文中の「cとペアを成すd」という記述より、cとdがSSL/TLSで使用する公開鍵／秘密鍵の組合せであろうと予想できます。
認証局に申請する証明書署名要求(CSR:Certificate Signing Request)とは、申請した情報(表1の識別名情報)と公開鍵をもとに認証局に対して公開鍵証明書の発行を依頼するメッセージです。要求が成功した場合、申請した情報に認証局のディジタル署名が付された公開鍵証明書が送り返され、証明書として有効状態になります。

本文中の「証明書識別要求には，識別名とcが含まれており…」という記述からcは公開鍵と断定できます。

∴c＝オ：公開鍵

〔dについて〕
公開鍵暗号方式で暗号化通信を行うためには、一対で生成される公開鍵と秘密鍵が必要です。公開鍵はSSLサーバ証明書に含まれクライアント端末上での暗号化に使用されます。サーバにはクライアントから暗号化されたデータが送られてきますが、これを復号するためには暗号化に用いた公開鍵に対応する秘密鍵がサーバに組み込まれていなければなりません。
したがってdは秘密鍵になります。

∴d＝カ：秘密鍵

[2]
〔bについて〕
コモンネーム(CN:Common Name)は、サーバ証明書に含まれる登録情報で、証明書が有効なFQDN、またはそのIPアドレスが格納される項目です。
クライアント側ではアクセスしたURLのドメイン名と証明書のコモンネームを比較することで証明書の正当性を検証します。
また本文中にも「コモンネーム(SSL接続するサイトのFQDN)」と説明が記載されています。
この設問ではSSL/TLS通信の対象URLが "https://www.a.co.jp/member" であるため、
このURLのFQDN(ホスト部＋ドメイン部)にあたる "www.a.co.jp" がコモンネームになります。

https : スキーム名
www : ホスト名
a.co.jp : ドメイン名 → ホスト名+ドメイン名 = FQDN
/member : ファイル名

■FQDN(Fully Qualified Domain Name)
ドメイン名・サブドメイン名・ホスト名の全てを指定する記述形式で「完全修飾ドメイン名」とも呼ばれる。
このサイトでいえばドメインが「ap-siken.com」や「.com」、FQDNは「www.ap-siken.com」になる。

∴b＝www.a.co.jp

[3]
本文中の

「ロードバランサは，ユーザからのHTTP/HTTPSリクエストをCookieの情報をもとにリバースプロキシサーバに振り分ける。」

という記述から、ロードバランサはHTTPヘッダのCookie情報を参照する必要があるとわかります。
クライアントとの通信はHTTP又はHTTPSで行われますが、通信内容がHTTPSで暗号化されているとロードバランサにてCookieの内容が読取れず、リバースプロキシへの振り分け処理が適切にできません。この問題を解決するにはロードバランサで通信内容の復号を行い、Cookie情報を参照できるようにする必要があります。

したがってサーバ証明書及び秘密鍵を導入する機器はロードバランサになります。


∴機器：ロードバランサ
　理由：Cookieの情報を参照する必要があるから



## 4
図2の警告ダイアログの3つのメッセージ中、問題があると考えられるのは2つ目の

「このサイトのセキュリティ証明書は，有効期間に問題があります。」

というメッセージです。これは、サーバ証明書の有効期限が切れているためにブラウザから発せられる警告であるため、サーバ証明書の有効期限を更新することで解消されます。本文中の名称を用いて記述すれば「SSLサーバ証明書を更新する」となります。

∴SSLサーバ証明書を更新する

因みに他の2つのメッセージは以下の場合に警告メッセージになります。
証明書の発行元に関する警告
ブラウザに組み込まれているルート証明書でSSLサーバ証明書の信頼性が確認できない場合
証明書内の名前とページURLが一致しないという警告
ページURLのドメイン名と証明書内のコモンネームが一致しない場合
```

---

## ネットワーク ネットワーク障害調査

難しい問題と聞いたのでやってみたが、特に難しいとは感じなかった。  
と、いいつつ、2つ全然わからない奴があったのでそれだけしっかり復習する。  
それ以外は全部わかったので、問題ない。  

``` txt : 30分 9/11
172.16.1.1
172.16.1.252
172.16.0.101
25

オ
エ
プロキシサーバ
DNSサーバー

ルーターが同じネットワークに属していない ×
→調達部FSのデフォルトゲートウェイ
調達部FSのIPアドレスが間違っている
→調達部FSのネットマスク

ブラウザからのアクセスはDMZ経由になるのでFWでブロックされる 0%
→プロキシサーバー経由でFSにアクセスしようとしたから

---

[3]
問題の切り分けについては以下の4点に着目します。
1. 調達部PCから調達部FSにアクセスできているため、調達部FSのIPアドレスは適切に設定されている
2. tracerouteの引数は調達部FS"172.16.1.253"を指している
3. tracerouteのパケットは調達部ルータまで届いている
4. ネットワーク機器は適切に設定されており、障害も発生していない

以上より、tracerouteのパケットは調達部ルータによって適切に配送され、調達部FSに到達していると考えるのが妥当です。
つまりタイムアウトの原因は調達部FSから送出される応答パケットにあると判断できます。
調達部FSに設定した項目のうち、この問題の原因として考えられるのは「ネットマスク」「デフォルトゲートウェイ」の設定です。
もしデフォルトゲートウェイが誤っていれば調達部ルータに応答パケットが届きません。
またネットマスクの誤りでは「送信元の総務部PCが同じネットワーク内の機器である」と誤認識して、応答パケットを調達部ネットワーク内に送出してしまっている可能性が考えられます。

[4]
図2のPCへの設定ガイドでは、プロキシの例外設定が「なし(全てのURLにプロキシサーバを利用)」となっています。
この設定があるため、PCのWebブラウザからFSにアクセスすると、そのリクエストはプロキシサーバに送られます。プロキシサーバは、FSに代理アクセスしようとしますが、P社では「インターネットやDMZから各部のFSにアクセスできないようにファイアウォールを設置している」ので、DMZ上のプロキシサーバからFSへの通信はファイアウォールで遮断されてしまいます。この状態ではPCにはレスポンスが返ってきません。

つまり、FSの利用状況確認ページが表示されなかったのでは、プロキシサーバ経由でのアクセスがファイアウォールで遮断されるからです。

∴プロキシサーバ経由でFSにアクセスしようとしていたから

```

---

## 組み込みシステム ネットワークを使用するインターホンの設計

本当は8問正解だが、言いたいことはほぼ合っているので実質9問正解でいいだろう。  
中々頭が混乱する問題だった。  
何とか制限時間内に解けたからいいけど、あっちいったりこっちいったりする類の問題をやっていると、応用情報だなって思う。  
計算問題はなかったけど、計算がないとこういうことになるんだなって思った。  
計算がない場合の傾向としては、とにかくパターンで攻めてくる感じかな。  
イベントの受信や通信の指示など1つの表に全部まとまって説明されるから頭が混乱してしまう。  
まぁ、組み込みはレギュラー入りなのは確実だが、簡単に点を取らせてくれるものではないのは確かだ。  
でも文系のあの項目を選択するよりはマシか。  

>文章で記述された内容を状態遷移図によって整理できるかという事がこの問題のポイント  
>情報システム設計分野の問題を含めて、状態遷移図などチャート類が出題の中心になっている問題では、このような形式がおおいので、  
>長い問題文を効率よく整理する練習をしてください。  

そう！俺が感じたのもまさにその事。  
残った時間で今日やった問題の解説を読み直すか。  

``` txt : 回答 30分 9/10
## メモ

A → B
青点滅


## 1
[1]
a：ACK応答受信
b：点滅しているボタンにタッチ △ ボタンにタッチ
c：ON通知受信

[2]
端末Cから接続要求を受信し、着呼、通話状態である時 ×
→
端末Bが他の端末と通話するために接続を試みているとき(道場)
他の端末からの応答を待っている場合(itec)


## 2
d：青
e：待受け


## 3
[1] 青
[2] 通話終了指示
[3]
①：OFF通知
②：READY通知
```

``` txt : 解説
## 1

itec解説
端末Bが端末Aからの接続要求を受付られないと判断するのはどのような場合か。

単純に考えると通話中等が思い浮かぶが、表1には通信不可の黄点灯として次のように記述されているから、
端末Bが通話中の時はボタンBが黄点灯で発呼出来ない。
>ボタンで示された端末が自端末以外の端末と発呼、着呼、又は通話状態であり、その端末に対して発呼できない状態
一方、タッチしたボタンは青点灯だが、表1によれば、青点灯となる接続状態には、「待ち受け」と「応答まと」の2つがある。
このうち「待ち受け」状態の場合には、特に問題なく要求を受け入れ、ACK応答を返すだろう。
これに対して「応答待ち」の場合には、端末Bは他の端末からの応答を待っているので、要求を受け付けることはできない。
なので、「他の端末から応用を待っている場合」などと回答する。

なるほど、Bから接続要求を出した場合と、他の端末から接続要求を受けている時の2パターンがあるのはみんな思うことなのか。
でも、Bから要求を出した限りでは、間違いなく他の端末にBUSYを送るので、接続不可になるって事なのかな。
相手からの応答街だと、同時押ししたときにどうなるかって問題に発展して確実性がなくなるのもあれなのかな。

道場解説
端末Bが端末Aからの"接続要求"を受け付けられず、"NAK応答"を返す場合を考えます。
端末Aが端末Bに"接続要求"を送信するのは、端末Aで青点灯のボタン"B"を押したときです。表1を見ると、ボタンが青点灯しているとき、そのボタンで示された端末の接続状態は"待受け"または"応答待ち"のいずれかであることがわかります。"待受け"は「発呼又は着呼が可能な状態」ですので端末Aからの接続要求を拒否する理由がありません。よって、"NAK応答"を返すのは端末Bが"応答待ち"のときと判断できます。

"応答待ち"は「呼び出した端末からの応答を待つ状態」です。つまり、端末Bが他の端末に"接続要求"を送信し、その応答を待っているときということになります。この場合、他の端末からの"接続要求"を受け付けられないので、端末Bは"NAK応答"を返すことになります。

∴端末Bが他の端末と通話するために接続を試みているとき

```
