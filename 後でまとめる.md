# 後でまとめたいやつら


## nginx

nginx再起動コマンド : sudo nginx -s reload
→
通常、Webサーバーの再起動を行った場合、瞬断が発生するが、-sオプションをつけることでそれがなくなるらしい。
-sオプションを指定すると、nginxのworkerプロセスが少しずつ新しいプロセスに置き換わっていくだとかなんだとか。
[[nginx]設定の反映](https://qiita.com/WisteriaWave/items/fa2e7f4442aee497fe46)


伊藤の開発ポートの設定ファイル
/etc/nginx/conf.d/2061.conf : bugfix
/etc/nginx/conf.d/2062.conf : hotfix

fastcgi_intercept_errors on;
をlocation ~ \.php$ {}の中に記述すると300以上のエラーがクライアントに伝わらなくなるので、正常にエラー表示ができなくなる。
2062ファイルにはこれが設定されていたので、hotfixでは意図的に500エラーを発生させても、bugfixのようなエラー表示にならなくて困っていた。
原因はサーバーの設定であって、Laravelの機能ではなかった。
[cakephp3 + CentOS8 + nginx + php-fpmでエラー表示がされないとき](https://blog.supersonico.info/archives/4277/)


[nginx 起動ポートの変更](https://qiita.com/Watercat3/items/38b2bac5fa70b232bee3)


## APIのメッセージを表示する方法(Response型のメッセージを取得する方法)

APIからのメッセージは_bodyプロパティの中にあるみたいが、素直にアクセスしようとすると存在しないというエラーになる。  
実行したときは存在するけど、コーディングの段階では存在しないみたいなパターン。  
これがJavascriptの仕様なのかTypescriptの仕様なのかは、わからないが、それはまた別でまとめたい。  
取り出すときはres.json()でなぜか取り出せる。  
そういうものなのだろうか。これも後でまとめる。  

``` ts
    // Service
    public maintenance(param: any): Promise<Response> {
        return this.apiService.put('system/web-cooperation/plan-cooperation/maintenance/', JSON.stringify(param));
    }
    
    // ViewModel
    this.goraMaintenanceService
        .maintenance(param)
        .then(
            res => {
                if (res.json() !== null && res.json() !== '') {
                    this.confirmComponent.dialogOk(res.json(), '確認', null)
                }
                this.notify.success('メンテナンスしました。');
                // 成功したら一覧を更新する
                this.getPlanList();
            },
            error => this.notify.error('失敗しました。\n : ' + error.json());
        )
        .then(() => this.isLoading = false);
```


どうでもいいけどこの人すごい。
1990年生まれ。京大卒。

RESTとGraphQLについて
<https://www.utakata.work/entry/2019/12/02/000000>


## DDLについて

[わかりそうデータ定義言語 (DDL)](https://wa3.i-3-i.info/word15639.html)


## NULLのLIKE検索

LIKE検索には引っかからない。

## NULLのORDERBY

[NULLと戯れる: ORDER BYとNULL](https://qiita.com/SVC34/items/c23341c79325a0a95979)  
どうにも、NULLを最小値とするか最大値とするかは、RDBMS毎に違ったり、設定で変更出来たりするみたい。  
Oracleは最大値扱いだが、SQLServerは最小値扱い見たい。  
まぁ、どちらにせよ、先頭か末尾であることに違いはないということですね。  

## COUNT(*)の意味とNULLのCOUNT

[COUNT(*)　が何を意味しているのかわからない](https://ja.stackoverflow.com/questions/42915/count-%E3%81%8C%E4%BD%95%E3%82%92%E6%84%8F%E5%91%B3%E3%81%97%E3%81%A6%E3%81%84%E3%82%8B%E3%81%AE%E3%81%8B%E3%82%8F%E3%81%8B%E3%82%89%E3%81%AA%E3%81%84)  
COUNT(*)は行数を数えてくれる。  

``` txt
OracleではCOUNT(*)とCOUNT(age)の結果は異なります。
ageにnullが入っているとCOUNT(age)では件数にカウントされません。
グループ化していても同様で、ageがnullのグループのみ0件となります。
COUNT(*)ではageにnullが入っていてもレコードの件数をカウントします。

COUNT(*)ではレコードの内容を取得するため、COUNT('X')やSUM(1)を使った方が高速化できると教わったことがあります。(10年ほど前に聞いたノウハウなので現在も適用されるのかは不明ですが…)
```

なるほど。COUNTはNULLはカウントしないのね。  
動作的にCOUNT(name)見たいにフィールド名を指定したほうが高速化できるっぽいけど、単純にレコード数を取得したいならCOUNT(*)でいいのか。  

## NULLをキャスト

(NULL AS CHAR)→NULLのまま
NULL -1 = NULL

## 名前付き引数 C#7.0



## Laravel 405

最後にスラッシュを入れるとリダイレクトになるらしいが、なぜ？
開発環境ではならないのに、61や本番で発生したのはなぜ？
WEBサーバーの違いに寄るものなのか？

## クロックの計算

<https://www.foresight.jp/blog/it/archives/964>  

計算は苦手。  
書けるのか割るのかその基準があいまいだから。  

1GHz = 10^9 = 10億  
1秒間に10億回のクロックが発生する。  

まずこれが基準。10億です。  
クロックが発生するという事は10億回計算出来る。  

・1命令が1クロックで実行可能な場合  
→10億命令実行可能ということ。  
この時MIPSは1,000になる。  
1MIPSは10^6,100万命令なので、10^9/10^6 = 10^3で1000MIPS。  

・1命令が0.8クロックで実行可能な場合  
→  
0.2分、余分に実行可能なので性能は上がっているわけだ。  
基本的に10億を0.8で割ればいい。掛けると逆に性能下がるのでダメね。  
すると12.5億になる。12.5億命令実行可能。  
単位を合わせればいいというわけ。  

1クロック何秒かも覚えておくか。  
1/10^9すればいいので1ナノ秒(10^-9)  

ミリ (milli)    ,10−3,0.001  
マイクロ (micro),10−6,0.000 001  
ナノ (nano)     ,10−9,0.000 000 001  
10^9は1の後ろに0が9個ついている。  
10^-9は1の前に整数部分も含めて0が9個ついている。  

問 2GHzのプロセッサにおいて、一つの命令が5クロックで実行できるとき、1命令の実行に必要な時間は何ナノ秒か？  

1クロックにかかる時間は
「1秒÷2,000,000,000クロック＝0.0000000005秒／クロック」0.5ナノ秒

1命令に5クロックかかるるのですから、  
1命令に必要なクロック数は＝0. 000 000 000 5秒／クロック×5クロック＝0.000 000 002 5秒  
2.5ナノ秒  

---

・8時に自然に目が覚めた。やっぱり7時は無謀だったな。
　許可なく遅番にしたけど、まぁこまけぇこたぁいいだろう。
・100円クーポンが出たので帰りに買い物しましょう。
・出社前に物を出品しますよ。
・玄米と薬が足りなくなりそう。
・定期便が来るのは10月4日らしいが、どうせ1日位早まるだろう。
　受け取るために車を使っても別に問題はない。時間節約のためならなんでもする。
・20日にワクチンの予約を取ったので、21日に有給申請しましょう。
・今日で28のどちらかを終わらせたい。

今の地点でSI単位系をやってるのやばいと思う。
