# 後でまとめたいやつら

---

## 継続的デリバリー復習

継続的デリバリー :  
手動。本番環境にデプロイ可能な状態を保証する。  
沢山デプロイするのは色々不都合がある場合もあるので、手動でデプロイする。  

継続的デプロイメント :  
自動。インテグレーションに問題が無かったら自動的にデプロイする。  
コミットするたびなので頻度がヤバい。  
なので継続的デリバリーという概念がある。  

継続的インテグレーション :  
コミットをトリガーとして、ビルドとテストを実行する。  

バージョン管理:  
言わずもがな。  

---

## wifiと接続されたら電気をつける

・Tasker  
・IFTTT  
・SwitchBot  
・MailTask  

Taskerでwifi接続イベントを検出する。  
接続イベントに対してTaskerからMailTaskにアクションを送信する。MailTaskで設定しているメールアドレスに特定の形式のメールを送信する。  
IFTTTで、設定したメールアドレスに対する特定のメールの受信を検知する。  
イベントを検知したら設定しているSwitchBotに点灯命令を送信する。  

---

・なぜwhere inは重いのか

sql where 仕組み
[SELECT文の処理の仕組みを説明してみた。](https://nattou-curry-2.hatenadiary.org/entry/20090315/1237089749)

・DB制約まとめ
・ロックのまとめ

LEFT OUTER JOIN A
RIGHT OUTER JOIN B
ON A.aa = B.aa
ON A.bb = oya.bb

この構文は

LEFT OUTER JOIN A ON B
A.aa = B.aa
LEFT OUTER JOIN B ON oya

でよいのでは説。


・重複レコードを削除する方法
　・Window関数を使った方法(rk where rk = 1)
　・JOINを使った方法(A EXCEPT A JOIN B)

あれ？単純にEXCEPTでいいのでは？
SELECT AFiled,BField FROM A
EXCEPT
SELECT DISTINCT AField,BField FROM B

あぁ、やらかしてるな。

``` sql
WITH TmpTable AS (
    SELECT 1 AS ID, 1 AS RowNum, 'and seventy nine' AS [Data]
    UNION
    SELECT 1, 2, 'five hundred'
    UNION
    SELECT 1, 3, 'two thousand'
)
select
    ID,
    [Data]
from
    (SELECT * FROM TmpTable ORDER BY RowNum DESC ) t1
group by
    t1.ID

-- メッセージ 1033、レベル 15、状態 1、行 12
-- TOP、OFFSET、または FOR XML が指定されていない場合、ビュー、インライン関数、派生テーブル、サブクエリ、および共通テーブル式では ORDER BY 句は無効です。
```

ソートはかなり重い処理に分類されるため、基本的に一番最後に行う。  
それだけで頻繁にやるべきでないことは分かるし、一番最後に出力する時にだけ行うべきってことが自然と分かるだろう。  

---

## ER図 Git管理

er図をmermaidで記述してgit管理でも行けるはず。  
管理するだけなので、A5M2によるDDLの出力などはできない。  
スキーマを変更したらそのままDDL出力してそれをGit管理でもいいのではなかろうか？  

[tblsを使えば，ER図をgitで管理しやすい](https://zenn.dev/lightkun/articles/6caf17872b6521)  

## er diagram github

[tblsとGitHub Actionsを使ってDBマイグレーションを含むPRには自動更新したER図を追加する](https://devblog.thebase.in/entry/auto_generated_er_graph_by_tbls_and_github_actions)  

---

## git.bashでexeを実行する方法

`./ <exe_name>`  

例:カレントディレクトリのefbundle.exeを実行する  
`./ efbundle`  

- 気を付けること  
  - exe名の直接指定では実行できない  
  - `.\`ではなく`./`  

[Windows git-bash.exeでバッチファイルを実行](https://teratail.com/questions/100039)  

---

``` txt
OPERATION | SQL    | HTTP/REST
----------+--------+-----------
CREATE    | INSERT | POST
READ      | SELECT | GET
UPDATE    | UPDATE | PUT
DELETE    | DELETE | DELETE
```

[Repository Pattern](https://www.youtube.com/watch?v=x6C20zhZHw8)  

---

## テストコード

[意識が高くないVisualStudioを使用した単体テストの自動化](https://qiita.com/mima_ita/items/05ce44c3eb1fd6e9dd46)  

---

## レビューに関して

>レビューはエンジニアの好き嫌いとか最近興味がある技術とかなどの思いの丈を語る為に提供されたしゃべり場ではなく、成果物の品質が基準に達しているかを確認する場という事が分かっていない人がホント多いなというが最近の感想。  
<https://twitter.com/komitsubo/status/1516544935423770624>  

---

## Linuxで.Netコンソールアプリを実行する方法

1. コンソールアプリを作成する  
`dotnet new console`  

2. 自己完結モードで発行  
`dotnet publish -c Release -r linux-x64 --self-contained true`  

3. Linuxにファイルを移動

4. 権限の変更 & 実行
`chmod 755 ./console`  
`./console`  

[Windowsで開発した .Net Coreを、frameworkがインストールされていないLinuxで実行](https://techlive.tokyo/archives/10145)  

---

## 親クラスを実装した子クラスを親クラスの引数で渡しても全てのプロパティが入ってくる

``` cs
using System.Reflection;

var parent = new Child()
{
    Id = 1,
    Name = "name",
    ChildProp = "child1prop"
};

var exconmega = new ExtendChildMega(parent);
_ = exconmega.parent.Id;
_ = exconmega.DateTime;

var excon = new ExtendChild(parent);
_ = 1;

public class Parent
{
    public int Id { get; set; }
    public string Name { get; set; } = null!;
}

public class Child : Parent
{
    public string ChildProp { get; set; }
}

public class ExtendChild : Parent
{
    public string DateTime { get; set; }

    public ExtendChild(Parent parent)
    {
        // 親クラスのプロパティ情報を一気に取得して使用する。
        List<PropertyInfo> props = parent
            .GetType()
            .GetProperties(BindingFlags.Instance | BindingFlags.Public)
            .ToList();
        foreach (var prop in props)
        {
            var propValue = prop.GetValue(parent);
            typeof(ExtendChild).GetProperty(prop.Name)?.SetValue(this, propValue);
        }
        var aa = this.GetType().GetProperty(nameof(this.Id));
        var a22a = this.GetType().GetProperty("test");
    }
}

public class ExtendChildMega
{
    public Parent parent { get; set; }
    public string DateTime { get; set; }

    public ExtendChildMega(Parent parent)
    {
        this.parent = parent;
    }
}
```

---

## SELECT a.NULL FROM (SELECT NULL FROM テーブル名) a

>SELECT NULL FROM テーブル名;  
>はできるのに  
>SELECT a.NULL FROM (SELECT NULL FROM テーブル名) a;  
>はエラーになるんだね(´・ω・｀)  
>a.NULLを列名扱いに出来ないらしい  
><https://twitter.com/cc02041110/status/1605500362634715137>    

SQLServer2022での検証。  

とりあえずこういうデータがあるテーブルで実験  

``` sql
SELECT * FROM [SchemaVersions]

-- Id | Name
-- ---+---------------------------------------
-- 1  | 001_Create_Table_TeacherMaster.sql
-- 2  | 002_Create_Table_DesignationMaster.sql
-- 3  | 003_Fill_DesignationMaster.sql
```

NULLにしたらレコード分が全部NULLになる。  

``` sql
SELECT NULL FROM [SchemaVersions]

-- Id | Name
-- ---+---------------------------------------
-- 1  | NULL
-- 2  | NULL
-- 3  | NULL
```

Twitterの構文ではそもそもエラーとなり実行できない。

``` sql
-- NULL付近に不適切な構文があります。
-- 'SQ'の列1に列が指定されませんでした。
SELECT SQ.NULL FROM (SELECT NULL FROM [SchemaVersions]) AS [SQ]

-- NULL付近に不適切な構文があります。
SELECT SQ.NULL FROM (SELECT NULL AS TEST FROM [SchemaVersions]) AS [SQ]
```

列名を定義して、列名でアクセスすればもちろんいける。  

``` sql
SELECT SQ.TEST FROM (SELECT NULL AS TEST FROM [SchemaVersions]) AS [SQ]

-- Id | Name
-- ---+---------------------------------------
-- 1  | NULL
-- 2  | NULL
-- 3  | NULL
```

---

## setting・configuration・preference

>これはUI/UXの観点から真面目になんとかしないといけない問題  
>
>• setting: 個別の設定、1つ1つを指す(ことがある)  
>• configuration→システムの基礎をなす一部なので変更は慎重に  
>• preference→エンドユーザーの好みだから気軽に変更して  
>
><https://twitter.com/acevif/status/1605356997897236481>  

<!--  -->
>settingは「設定」、preferencesは「（好みの）設定」、configurationは「構成」、optionは「（選択肢としての）設定」、initializationは「初期設定」みたいな意味の違いはあるけど、まとめて「設定」に訳されちゃうの、すげー分かる。  
<https://twitter.com/rioriost/status/1605361577632624640>  

---

``` cs
    [HttpGet("GetInt/{id}")]
    public ActionResult<int?> GetInt(int? id)
    {
        return Ok(id);
    }
```

>オブジェクトの生存期間を外部からコントロールする必要があるクラスを『状態を持つクラス』と言い、基本的に DI コンテナへ登録する対象には向いていません。  
>
>とは言っても『状態を持つクラス』を DI したい場合もあるため、状態を持たない Factory クラスをインジェクションして Factory からインスタンスを受け取るようにしています。  
>[ようこそ Dapper 至上主義の DataAccess へ【#5 WPF MVVM L@bo】](https://elf-mission.net/programming/wpf/mvvm-labo/phase05/#DataAccess_Repository)  

[superの呼び出し](https://bliki-ja.github.io/CallSuper/)  

- `asp.net` パイプライン  
プロセス間通信  
x86Extension  

WPFとWEBAPIを同じソリューションに含めて実行する  
[Consume ASP.Net Core Web API Using HttpClient in WPF](https://www.youtube.com/watch?v=qb3o_PIwVUk)  

Calenderのカスタマイズ  
[WPFのCalendarコントロールをカスタマイズ](https://iyemon018.hatenablog.com/?page=1484034348)  
