# 102メモ

## sが付くか迷う物

●/etc/group :: グループに関する情報が格納されているファイル  
groupsと迷う。

●groupsコマンド  
groupにしてしまった。  
→上の2つがあるからややこしく感じるのでは？

●aliasコマンド  
●newasliasesコマンド  
aliasesコマンドはない。ノリでそう答えてしまいそうになる。  
●/etc/aliases

■dnsのhost系  
・/etc/hosts          :: IPアドレスとホスト名の対応付けファイル。
・/etc/hostname       :: ホスト名のみを設定するファイル(Debian系,RHEL7以降)
・hostコマンド        :: DNSサーバーを使ってホストやドメインに関する情報を表示する。最も基本となるコマンド。最小出力。
・hostnamectl         :: systemdが動作するシステムにおける、ホスト名や関連する情報の表示、ホスト名の設定を行うコマンド。
※「nmcli general hostname ホスト名」でも表示可能。
・hostnameコマンド    :: 自ホストのホスト名やドメインを参照したり、ホスト名を一時的に変更するコマンド。

●timedatectl list-timezones  
list-timezoneと迷う。  

●xintedの設定ファイルでサーバープログラムを起動するユーザー  
user  
選択肢にusersがあると迷う。  

## journalctlの気を付けるオプション

-a,--all見たいにずれていなければいいのだが、ずれてる奴が毎回迷う。

ログ出力10行  
・--lines 10  
・-n  

表示可能なログをすべて表示  
--full  
-l  

ログをリアルタイムに表示  
-follow  
-f  

## +が設定、-が解除。+が解除、-が設定

setコマンド :: 「+ : 解除」 , 「- : 設定」

xhost :: 「+ : 設定」 , 「- : 解除」

find :: 「+ : or」,「- : and」

## dが付くファイル、付かないファイル

ntpdの設定ファイルを間違えてしまった。  
/etc/ntpd.confなるものは存在しない。  
ざっと見返してみたが、デーモンで○○dってついて、そのまま○○d.confって形式のファイルはxinetd.confしかないみたい。  
なので、それ以外は○○.confでよい。  

と、思ったが、CUPSもd.confタイプだったか。  
これはデーモンの設定ファイルか。デーモンに対する設定なのか、サービスそのものに対する設定ファイルなのか、色々あるな・・・。
これは中々きつい。

■NTP  
・ntpd  
・/etc/ntp.conf  

■chrony  
・chronyd          :: ntpdに代わるNTPサーバ/クライアントであるChronyのデーモン。
・/etc/chrony.conf :: Chronyの設定ファイル。

■systemd-journald  
・/etc/systemd/journald.conf  

■xinet  
・xinetd           :: スーパーサーバデーモン。ネットワークからのリクエストを受け付けるデーモン。  
・/etc/xinetd.conf :: xintedの全体的な設定を行うファイル。  
・/etc/xinted.d/   :: xinetdのサービスごとの設定ファイルを格納するディレクトリ。  

■CUPS(Common Unix Printing System) :: これまで使われてきた「lpd」に代わる新しいWebブラウザベースの印刷システム。
・cupsd      :: UNIXの印刷サービスCUPSのデーモン。
・/etc/cups/cupsd.conf    :: cupsdの設定ファイル。

■SSH  
sshクライアントの設定ファイル :: /etc/ssh/ssh_config  
sshサーバーの設定ファイル :: /etc/ssh/sshd_config  

## 時間書式まとめ

date MMDDhhmmCCYY.ss

chage YY-MM-DD

crontab書式 [分] [時] [日] [月] [曜日] [実行ユーザー名(システム用設定ファイルでのみ指定)] [コマンド]

at [YY] [MM]

## よく出るアレ

``` txt : NetworkManageの接続性
full    :: インターネットにアクセス可能なネットワークに接続している。
portal  :: インターネットにアクセスする前のcaptive portalの状態である。
limited :: ネットワークに接続しているが、インターネットにアクセスできない。
none    :: どのネットワークにも接続していない。
unknown :: 接続状態が見つからない。
```

``` txt : ロケールの主なカテゴリ
LC_CTYPE     :: 文字の種類やその比較・分類の規定  
LC_NUMERIC   :: 数値の書式に関する規定  
LC_TIME      :: 日付や時刻の書式に関する規定  
LC_MESSAGES  :: メッセージ表示に使用する言語  
LC_MONETARY  :: 通貨に関する規定  
LC_NAME      :: 名前の書式
LC_ADDRESS   :: アドレス、ロケーションの書式
LC_TELEPHONE :: 電話番号の書式
LC_COLLATE   :: 文字の照合や整列に関する規定  
LC_ALL       :: ロケールの環境変数すべて  
                指定した値が全てのカテゴリを上書きし、カテゴリごとの設定が出来ない。
LANG         :: 全てのカテゴリで必ずその値が使われるが、個々のカテゴリ毎に個別の設定が可能。
                (LC_ALL)が設定されていない場合、指定した値がデフォルトとして使用される。

※LC_ALLは全てのカテゴリを上書きするので「/etc/locale.conf」に設定することは推奨されません。
```

``` txt : /etc/ntp.conf
restrict  :: ntpdへのアクセス制御を行う。
server    :: 時刻を取得するサーバーを指定する項目。
             ネットワーク内部に設置したNTPサーバや、世界中にある公開NTPサーバ、プロバイダが提供するNTPサーバを指定します。 
driftfile :: 自身の時刻のズレ具合を記録するファイルを指定。
```

``` txt : chrony.confの設定項目
server ::  時刻元として使用するNTPサーバーを指定する。  
pool   ::  時刻元として使用する複数のNTPサーバーのプールを指定する。  
makestep :: 時刻のずれが閾値(単位:秒)より大きかった場合は指定した問い合わせ回数まではステップで同期する。  
rtcsync :: 定期的にハードウェアクロックの同期を取る。
rtcfile :: ドリフトファイルにより時刻を補正する。  
```

``` txt : ファシリティ
auth,authpriv :: 認証システム(loginなど)による出力
cron          :: cronによる出力
deamon        :: 各種デーモンによる出力
kern          :: カーネルによる出力
lpr           :: 印刷システムによる出力
mail          :: メールサービス関連による出力
user          :: ユーザーアプリケーションによる出力
syslog        :: syslog機能
local0~local7 :: ローカルシステムの設定
```

``` txt : プライオリティ
emerg   :: 緊急事態
alert   :: 早急に対処が必要な事態
crit    :: システムの処理は継続できるものの深刻な事態
err     :: 一般的なエラー
warning :: 一般的な警告
notice  :: 一般的な通知
info    :: 一般的な情報
debug   :: デバッグ情報
none    :: ログを記録しない
```

``` txt : アクションフィールド
ファイル名   :: ファイルへの出力
ユーザー名   :: ユーザーの端末への出力
@ホスト名    :: リモートホストのsyslogへUDPで出力
@@ホスト名   :: リモートホストのsyslogへTCPで出力
/dev/tty1    :: コンソール(rrt1)に出力
/dev/console :: コンソールへの出力
*            :: ログイン中のすべてのユーザーの端末に出力
/var/log/messages :: ログファイルに出力
```

``` txt : xorg.confの主なセクション
Files        :: フォントやカラーデータベースファイルのパス名
Module       :: ダイナミックモジュールの設定。
                組み込むモジュールの指定。
                モジュールとは、Xサーバ本体には無い機能を新たに追加するためのファイルのこと。
InputDevice  :: キーボードやマウス等の入力装置の設定
InputClass   :: 入力装置の「クラス」に適用される設定
Device       :: ビデオカードの設定
Monitor      :: モニターの設定
Modes        :: ビデオモードの設定
Screen       :: ディスプレイの色深度(表示色数)や画面サイズの設定
ServerLayout :: 入出力デバイスとスクリーンの指定
```

``` txt : 「/etc/X11/xdm」にある関連ファイル
xdm-config :: XDMの設定ファイル。
Xresources :: XDMログイン画面のデザイン設定。
Xaccess    :: ホストからXDMへアクセス許可の設定。
Xsetup_0   :: XDMログイン画面表示前に実行されるスクリプト。
              XDMのカラー設定や背景（壁紙）の指定を行う。
              ファイル名の末尾にある「_0」はディスプレイを識別するための番号（ディスプレイ番号）。
Xsession   :: XDMのログイン後に実行されるスクリプト。
```

``` txt : xinetdの主な設定項目
bind or interface :: サービスを提供するインターフェースのIPアドレス
disable           :: サービスの有効/無効 (yes:無効化 no:有効化)
instances         :: サーバープログラムの最大起動プロセス数
log_type          :: ログの記録先指定。サービスが出力するログをsyslogや指定したファイルに出力する。出力先ファイルは絶対パスで指定する。
no_acccess        :: サービスへの接続を拒否する接続元
only_from         :: サービスへの接続を許可する接続元
server            :: サーバープログラム(デーモン)へのフルパス
server_args       :: サーバープログラム(デーモン)に渡す引数
socket_type       :: 通信のタイプ(TCP:stream , UDP:dgram)。サービスの接続タイプ。
user              :: サーバープログラムを起動するユーザー
wait              :: サーバープログラムへの接続処理を待ち合わせるかの設定。
                     サーバープログラムがマルチスレッドであり、1プロセスで同時に複数処理できる場合はno。
                     シングルスレッドで処理が完了し、サーバープログラムが終了するまで接続処理を待ち合わせる必要がある場合はyesとする。
log_on_failure    :: 接続を拒否した時にログに記録する内容
nice              :: 実行優先度
access_time       :: アクセスを許可する時間帯
```

``` txt : /etc/ssh/sshd_config
Port                   :: 待機ポート番号
Protocol               :: プロトコルバージョン
PermitRootLogin        :: rootログインを許可するかどうか(デフォルトはyes:許可。no:不許可が推奨)
                          セキュリティ上の理由から、rootユーザでのSSHログインは禁止する事が一般的に推奨されます。
PubkeyAuthentication   :: 公開鍵認証(プロトコルバージョン2)
AuthorizedKeysFile     :: ユーザー認証の公開鍵格納ファイル名
PasswordAuthentication :: パスワード認証
X11Forwarding          :: X11ポートフォワーディングを許可するかどうか
```

``` txt : ~/.ssh/config
Host         :: sshコマンド等で指定するホスト名。
HostName     :: 実際の接続ホストのアドレス。IPアドレスや/etc/hostsに指定したホスト名等を指定する。  
                これがあるとホスト名を省略できる。  
User         :: ユーザー名。これがあるとユーザー名を省略できる。  
Port         :: ポート番号。これがあると 「-p ポート番号」 って書かなくてよくなる。  
IdentityFile :: 秘密鍵ファイル。これがあると 「ssh -i 秘密鍵ファイルのパス」 って書かなくてよくなる。  
```

## 設定ファイルの有無

■cron  
・/etc/cron.allow :: cronの利用を許可するユーザーを記述する。  
・/etc/cron.deny  :: cronの利用を拒否するユーザーを記述する。  
① /etc/cron.allowファイルがあれば、そこに記述されたユーザーのみがcronを利用できる。/etc/cron.denyファイルは無視される。  
② /etc/cron.allowファイルが無ければ、/etc/cron.denyを参照し、/etc/cron.denyに記述されていないすべてのユーザーがcronを利用できる。  
③ /etc/cron.allowファイル、/etc/cron.denyファイルのどちらもない場合、rootユーザーのみが利用可能。  
全員OK。

■at  
・/etc/at.allow :: atの利用を許可するユーザーを記述する。  
・/etc/at.deny  :: atの利用を拒否するユーザーを記述する。  
① /etc/at.allowがあれば、そこに記述されたユーザーのみがatを利用できる。/etc/at.denyファイルは無視される。  
② /etc/at.allowが無ければ、/etc/at.denyを参照し、/etc/at.denyに記述されていないすべてのユーザーがatを利用できる。  
③ どちらのファイルも無ければ、rootユーザーだけがatを利用できる。  

■xinetdによるアクセス制御  
・only_fromもno_accessも設定されていない場合、サービスへのアクセスは全て許可  
・only_fromだけが設定されている場合、指定されたアクセス元しかサービスへアクセス出来ない  
・no_accessだけが設定されている場合、指定されたアクセス元はサービスへアクセス出来ない  
・only_fromとno_accessが同時に指定された場合、より厳密にマッチするほうに従う  

■TCPラッパー（tcpd)の制御ファイルは以下の順で評価されます。  
1.「/etc/hosts.allow」に記載されているホストは許可。  
2.「/etc/hosts.allow」に記載されていなければ、「/etc/hosts.deny」を参照し、記載されているホストは拒否。  
3.両方のファイルに記載の無いホストは全て許可。  

両方のファイルに記載が無いホストは全て許可されてしまうため、通常は「/etc/hosts.deny」に「ALL:ALL」と記載（全てのサービスとホストを拒否）しておき、  
許可したいサービスとホストだけ、「/etc/hosts.allow」に記載しておくという運用を行います。  

---

## 間違えた問題

### 7.シェルとシェルスクリプト

``` txt : きをつけ
・コマンドを「$()」で囲んで、その結果をシェル変数に代入する。  
・コマンドをバッククオート「`」で囲んでその結果をシェル変数に代入する。  
```

#### env

指定した環境変数の値を一時的に削除してコマンド実行するのは次のうちどれか。
設定されている環境変数の値を一時的に指定された値に変更してコマンド実行するのは次のうちどれか。

→

env全般確認する。
envはenvededなので、環境変数に関する事全般と覚えていいかもしれない。  
それこそ、環境変数を一時的に無効にするとか、なかったことにするとか、そういうのばかりだからね。  

シェルのオプションの設定状態を確認したい。下図の( )に入る適切なコマンドは次のうちどれか。  
→  
set -o  
何もオプションを指定しないと何かあるってのを思い出したけど、そうじゃなかったら間違えてる。  
要注意。  

#### 4734

bashのログイン時、環境設定ファイルを読み込む順番で正しいものを答えなさい。

→

「/etc/profile」2.「~/.bash_profile」3.「~/.bashrc」4.「/etc/bashrc」  
これを見るに、とりまprifileを先に読めばおけ。  

あと、profile系の順番も確認しておく。  
~/.bash_profile , ~/.bash_login , ~/.profile  

最初にプロファイルはいい。次にログインで最後にまたプロファイルという訳の分からない並びである事。  

#### 5144

ログインシェルとしてbashが起動した際に、読み込む設定がない場合は読み込まれないファイルはどれか。

→

一番読まれそうなファイルが読まれないのが意外。  
Linuxわからん。  

~/.bashrc

#### 4936

対話型シェルを起動した際に読み込まれるファイルはどれか（2つ選択）  

→

対話型シェルは起動スクリプトは実行されているので、起動したときに走るrcだけで十分。  

/etc/bashrc  
~/.bashrc  

#### 4659

Debian系のシステムで全ユーザーのbash起動時に共通の処理を実行させたい。編集すべきファイルはどれか。

→  

bash.bashrcとかいうふざけた奴。  

#### 5068

以下のコマンドを実行すると、コマンドを実行したユーザ名が表示されるようにしたい。空欄(　)に入るものはどれか。  
echo "My name is (　　　　　)."  

→

意外なのを間違えた。  
phpの要領で$まではよかったけど、NAME何てねーよって話。  
答えはUSERです。

#### 4560

エイリアス機能を利用し、コマンドラインから「rm」と入力した場合に「rm -i」コマンド（対話式の削除）が実行されるようにしたい。適切なコマンドは次のうちどれか。

→

ここにきて超基本的な問題を間違えるようになってしまった。  
バッククォートは関数実行するときの話であって、普通に設定するだけならシングルでいいですよ。  
alias rm='rm -i'  

#### 5035

カレントディレクトリでのlsコマンドの結果は以下である。

$ls
dir1 dir2 test1.txt test2.txt

上記と同様に、下記の実行結果にするためには、事前にどれを入力すれば良いか。（2つ選択）

$echo $RESULT
dir1 dir2 test1.txt test2.txt

→

4560のバッククォートが活躍するのはこっち。

``` txt
RESULT=`ls`  
RESULT=$(ls)
```

#### noglob , noclobber , ignoreeof

パス名のワイルドカードによる展開（*や?）を無効に設定したい。 → noglob  
リダイレクト「>」によるファイルの上書きを禁止にしたい。 → noclobber  
キーボード操作を誤って、「Ctrl + D」を押してしまった際のログアウト処理を一時的に無効にしたい。 → noignore  

■グロブ  
グロブ（英: glob）とは主にUnix系環境において、ワイルドカードでファイル名のセットを指定するパターンのことである。  
例えば、UNIXのコマンド「mv *.xlsx 営業実績/」はカレントディレクトリから営業実績/ディレクトリへと.xlsxで終わる全てのファイルを移動する。  
ここで、\*は「任意の文字列」を表すワイルドカードであり、\*.xlsxはグロブである。\*以外に一般的なワイルドカードは疑問符 (?) であり、これは任意の1文字を表す。  

片方がわかってしまえば問題ない。

---

### 8.ユーザーインターフェースとデスクトップ

``` txt : 8
## ServerLayout
入出力デバイスとスクリーンの指定

## XクライアントとXサーバーの設定の順番と起動順
xhost → xclient → xeyes

xhostの+と-はそのままの意味。
+と-が逆の意味になっているのはsetコマンド。

## xdmの設定ファイル系
※仮想マシンへのリモートデスクトップ接続について正しいもの
SPICEでは仮想マシンの画面出力を直接扱える
VNCサーバは仮想マシンのゲストOSにインストールする
→
VNCは仮想マシンのゲストOS（仮想マシン上で動作するOS）にインストールしたVNCサーバがゲストOSの画面出力をキャプチャしてクライアントに送信するのに対して、
SPICEでは仮想マシンのホスト（仮想環境の土台）にインストールしたSPICEサーバが仮想マシンの画面出力をクライアントに送信して直接操作することができます。

## 同じキー入力を一定時間無視するアクセシビリティ
バウンスキー
→
同じキー入力→手が震えて何回も同じキーを入力してしまう→バウンドしている。→バウンスキー
```

#### 4619 Xのエラーファイルってちょいちょい忘れる

X Window Systemのエラーが出力されるファイルは次のうちどれか。  
~/xorg.error  
~/.bash_history  
/etc/X11/xorg.conf  
~/.xsession-errors  
/etc/X11/xorg.conf.d  

・ホームディレクトリである事  
・ハイフンでつながっている事  
→  
~/.xsession-errors  

#### 4636 XDMの設定ファイルもなんだっけかね

ディスプレイマネージャ「XDM」の設定ファイルを選びなさい。  
Xsetup_0  
Xsession  
Xaccess  
xdm-config  
Xresources  

これもハイフンでつながっていた気がするが？  
合ってた。  
→  
xdm-config  

#### 4637 スクリプトなんてあったっけ？

XDMのカラー設定や背景（壁紙）の指定を行うスクリプトを選びなさい。  
Xresources  
xdm-config  
Xsetup_0  
Xsession  
Xaccess  

設定するからSet。  
なんかインデックスで番号変わるとかなんとか言ってたから数字があるやつ。  
→
Xsetup_0  

#### 4630 startxで起動したときの設定ファイル

下図はstartxコマンド実行時の流れを示したものです。(　)に当てはまる適切な言葉は次のうちどれか。

xinitrc
Xresources
Xinitrc
xsession
Xaccess

起動したときに実行されるんだからrc。  
全部小文字。  
xinitってついてればなおよし。  
xinitrc  

---

### 9.管理タスク

#### locateコマンドなるものは存在しない

ロケールの確認はlocaleコマンドで行う。locateではない。
まぁ、ロケールって単語しか出てこないからlocaleしかないんだけど、なんでlocate何て選んだのだろうか。

#### 4838

既に存在するグループアカウント「ProjectA」のグループ名を「ProjectB」へ変更したい。適切なコマンドは次のうちどれか。

→

-gを選択したが、これはgidを変更するオプション。
名前だけなので-n  

#### 4918

システムで使用するタイムゾーンを指定するテキストファイルはどれか。

→  

タイムゾーンに関する設定ファイルだけを並べる。  
・/etc/timezone  :: システムで使用するタイムゾーンを指定するテキストファイル。  
・/etc/localtime :: システムクロックの時刻からローカルタイムへ変換するための時差情報が格納されている。  
・/usr/share/zoneinfo/ :: タイムゾーンの情報がバイナリファイルとして格納されているディレクトリ。  

#### 5038

「hogescript」スクリプトを日曜の毎時間30分に実行したい。crontabファイルの適切な設定は次のうちどれか。（2つ選択）

``` txt
hogescript 30 * * * 0
hogescript 30 0-23 * * 6
30 0-23 * * 6 hogescript
30 0-0 * * 0 hogescript
30 0-23 * * 7 hogescript
30 * * * 0 hogescript
```

→

日曜なので0か7。  
30はいいとして、時間は0-23 or [*]だ。  
そもそも指定しないという選択肢。  
0-0は0時ピッタリにしかやらないからダメ。  

#### 4727

下記の表示を得たい。適切なコマンドは次のうちどれか。

→

catで開けるやつとそうでない奴をまとめる。  
それがわかっていないから、`crontab -l`に逃げる。  

・/var/spool/cron/ユーザ名  :: ユーザ用のcrontabファイル。エディタで編集不可(cat不可)。crontabからのみ可能。
・/etc/crontab       :: システムに定期的に実行させたいジョブを設定するファイル。主に以下4つのディレクトリに置かれたスクリプトを実行する。
・crontabコマンド :: ユーザ用のcronの設定を行うコマンド。コマンドの定時実行のスケジュール管理コマンド。  

``` txt
crontab [オプション]

オプション
-e(edit)      :: エディタを使ってcrontabファイルを編集する
-l(list)      :: crontabファイルの内容を表示する
-r(remove)    :: crontabファイルを削除する
-i            :: crontabファイル削除時に確認する
-u ユーザー名 :: ユーザーを指定してcrontabファイルを編集する。(rootユーザーのみ可)
```

なるほど。
システムのクーロン設定は編集可能だが、ユーザーのクーロン設定は編集不可。
なのでcrontabコマンドを挟んで実行するというわけか。

まずcatで開ける事。  
中身に実行ユーザーの記述がある事で、システム用のcron設定`/etc/crontab`だとわかる。

---

### 10.必須システムサービス

#### 4805 ntpdだからといってntpd.confではない

ntpdの設定ファイルを選択しなさい。  
/etc/hosts  
/etc/syslog.conf  
/etc/resolv.conf  
/etc/ntpd.conf  
/etc/ntp.conf  

dが付かないタイプ。  
ntpdだからといってntpd.confではない。  
/etc/ntp.confだ。

#### 5080 timedatectlのNTP設定、直近で間違えましたよね？

timedatectlコマンドで、NTPによる時刻同期を有効・無効にするサブコマンドは次のうちどれか。  
set-time  
ntp  
enable ntp  
set-ntp  
sync  

有効無効だからenableで間違えた気がする。  
でもntpの項目に関してはset-ntpしかないんですよね。  

#### 4688 datetimectlなんて間違えましたよね？

現在のシステム時刻や状態を表示するsystemdのコマンドは次のうちどれか。(2つ選択)  
timedatectl status  
hwclock  
systemdtime  
timedatectl  
datetimectl  

C#の型はdatetimeだからそのノリで応えたけど、ダメでした。  
timedateですからね。  

#### 4801 システムクロックは後ろから判別したほうが早い

システムクロックを2010年7月20日19時30分20秒に設定したい。適切なコマンドは次のうちどれか。  
date 201007201930.20  
date 07201930202010  
date 20100720193020  
date 2010072019.3020  
date 072019302010.20  

後ろは絶対に「年.秒」というこれ以上ないほどのあれだから。  
真ん中はしらね。  

#### 4958 ntpq なんか付けて置けばいいって言ってた気がする

ntpデーモンの時刻同期状況を表示するコマンドはどれか  
ntpq -i  
ntpq -p  
ntpq  
date  
ntpdate  

-p(peer)なのはいいんですけど、なぜなんか付ければいいって話になっているのかは下でまとめてますので。  

#### 4960 ntpq これを見てなんかつけておけばいいって思った

以下の出力を得られるコマンドはどれか  

remote , refid , st , t , when , poll , reach , delay , offset , jitter とか表示される奴。  

hwclock  
ntpq -p  
date  
ntpq  
ntpq -i  

ntpqってデフォルトで実行すると対話モードになって表示は出来ない。  
-iも対話モードだが、これがデフォルトで実行される。  
で、表示に関するオプションは1つしかないから、ntpqはオプションを付けておけば問題ないって思ったんだ。  

#### 5003 ntpq の-iってなんだっけね？

ntpqコマンドの-iオプションについて正しく説明しているのはどれか  
入力ファイルを指定する  
ネットワーク接続を有効にする  
インターネットからのアクセスを許可する  
対話モードで起動する  
時刻同期の状況を一覧表示する  

上でまとめてる。  

#### 4612 送信待ちディレクトリはしっかり復習

sendmailの送信待ちのメールを保存するディレクトリを選択しなさい。  
/var/sendmail/spool/  
/var/sendmail/  
/var/spool/mqueue/  
/spool/mail/  
/var/spool/mail/  

送信待ちはキューに溜まるので「/var/spool/queue/」  
来たメールが溜まるのはキューではないのでもう一つのほうの「/var/spool/mail/」  

#### 4807 地味に忘れるntpdate

NTPサーバ「pool.ntp.org」から現在時刻を取得するコマンドを選択しなさい。  
date -s pool.ntp.org  
ntpdate pool.ntp.org  
ntpget pool.ntp.org  
date pool.ntp.org  
ntpd pool.ntp.org  

#### 4937 内外部と言われたら大抵server

内外部に存在する信頼できるNTPサーバから時刻を取得し、自身のマシンの時刻を同期させたい。編集すべき「/etc/ntp.conf」の設定項目は次のうちどれか。  
timeserver  
master  
server  
ntp  
slave  

#### 4970 純粋になんだっけ？

systemdの動作するシステムで、sshd.service ユニットからのログのみを出力させたい。正しいコマンドはどれか（2つ選択）  
journalctl _SYSTEMD_UNIT=sshd.service  
journalctl -u sshd.service  
journalctl _systemd_unit=sshd.service  
journalctl unit=sshd.service  
journalctl sshd.service  
journalctl -s sshd.service  

ユニットなので「-u」で問題ない。  
後はクソ長検索キーの奴。  

#### 4967 journalctl 10行だけって省略形とフルで全然違う

journalctlコマンドでのログ出力において、10行だけ表示させたい。正しいコマンドはどれか（2つ選択）  
journalctl -l 10  
journalctl --num 10  
journalctl 10  
journalctl -n  
journalctl -r 10  
journalctl --lines 10  

「--lines」ここはいい。  
「-n」は多分ナンバーで覚えたほうが都合がいいかな。  
デフォルトが10なので-nだけで十分。

#### 4968 journalctl 表示可能なログ全てはそのままなんだが、昔間違えたのでやっておく→大敗北

systemdの動作するシステムで、各Unitが出力する表示可能なログをすべて表示させたい。指定すべきオプションはどれか（2つ選択）  
-l  
--display-all  
--list-all  
--printable  
-a  
-f  
--full  

表示可能 = 全て = --full -fと思っていたが、--fullはいいとして、-lだった。  
こっちこそ間違えていた。  
--full listで対処するしかないよな。  

#### 4965 journalctl 最新のログをリアルタイム表示も省略形で違う・・・っけ？

journalctlコマンドでのログ出力において、新規に追加されたログをリアルタイムに表示させたい。指定すべきオプションはどれか（2つ選択）  
-n  
-f  
--tail  
--real  
-r  
オプション未指定  
--newest  
--follow  

journalctlのfと・・・あれ。  
こっちが同じ奴だ。--followと-f。  
--fullは-fではなく、-l。  

#### 4802 話は変わるが、noneを設定されているのに別のファシリティが設定されている場合の動作ってなんだっけ？

「/etc/rsyslog.conf」ファイルの書式として正しいものは次のうちどれか（4つ選択）

``` txt
auth.* /var/log/secure  
*.info;mail.none;syslog.none /var/log/messages  
mail.err /var/log/maillog  
kern=notice /dev/tty10  
info.mail /var/log/maillog  
/var/log/messages lpr.debug  
*.* /dev/console  
```

白本の模試で出てきたはず。忘れてしまったので、本番前には絶対に確認する。  

#### 5081 chronyの設定ファイルはdが付く？つかない？

Chronyの設定ファイルは次のうちどれか。  
/etc/hosts  
/etc/chrony.conf  
/etc/chronyd.conf  
/etc/syslog.conf  
/etc/ntp.conf  

A. 付きません。  

これを書いている時に思いっきり間違えました。  
dが付くかファイルのほうでしっかりまとめるので許してください。  

---

### 11.ネットワークの基礎

#### 5129 ipコマンドの送受信バイト数の統計情報出すのって何だっけ？

`-s` で合ってた。  
直観的には `-v` だと思っていた。  

#### 5114 nmcli device 接続、切断ってそのままでよかったっけ？

connect?disconnect?
よかった。  

#### 5111 nmcli connection の接続の有効、無効ってそのままでよかったっけ？

enable?disable?
up?down?
up,downだった。  

接続、切断はそのままだが、有効無効はup,downらしい。  

#### 4579 routeコマンドでデフォルトゲートウェイ削除ってどうだっけ？

`route del default gw 192.168.1.254` でよかったっけ？
IPアドレス指定するならgw付けるっけか。つながらないのは確かだったよな。

そうだった。  

デフォルトゲートウェイを削除するには「route del」の後に「default gw」というオプションを使用します。  
よって正解は「route del default gw 192.168.1.254」となります。  
なお、IPアドレスを指定せずに「route del default」でもデフォルトゲートウェイの削除は可能です。その場合「gw」は付けてはいけません。  

#### 4755 どのコマンドを実行したときの結果なのかわからない

``` txt
;; QUESTION SECTION:
;yahoo.co.jp IN A

;; ANSER SECTION:
yahoo.co.jp. 86 IN A 124.83.139.192
yahoo.co.jp. 86 IN A 203.216.227.176
```

普通にdigだった。

routeと迷った。だって2つもIPアドレス示されたから経路情報かと思ったから。  
でも、よく見てみれば、QUESTIONで IN Aって事は digのa(デフォルト)なわけで、つまりdigによる名前解決の問い合わせって意味になる。  
そうでなくても、QUESとANSERのクソデカキーワードのおかげで、これはdigって忘れないだろう。  

#### 4674 /etc/hostsの正しいエントリーは何だったか

「ipアドレス ホスト名」の順番でいいよな。  
でもって、スペースで別名を定義できるよな。  

合ってました。  
「IPアドレス ホスト名 ホスト名（別名） …」  

「/etc/hosts」は名前解決に用いられるシンプルなテキストファイルで、1行に1つのIPアドレスがあり、そのIPアドレスと続くホスト名とを関連づけています。  
IPアドレスはIPv4、IPv6どちらでも指定できます。  

#### 4981  ipコマンドを使ったアドレスの追加方法

小豆本の模試でも出てきて間違えた。  
`add -net`の組み合わせだったか。  
もう一度復習だな。  

ip コマンドを使って、lo インタフェースに以下のアドレスを追加したい。  
アドレス：127.0.0.100  
サブネットマスク：255.255.0.0  
→
addとCIDRの場合は `ip addr add 127.0.0.100/16 dev lo` かな。  

「ip addr add 宛先ネットワークアドレス/サブネットマスク長 dev インタフェース」  
まずaddに-は付かない。 付くのは-net。  
devの後はインターフェース名を指定する。  

#### 4978 ipコマンドを使った経路の追加方法

ipコマンドを使って、以下の条件でルーティングテーブルに新しい経路を追加したい。正しいコマンドはどれか  
宛先ネットワークアドレス：192.168.3.0  
サブネットマスク：255.255.255.0  
ゲートウェイ：192.168.1.1  

ipアドレスでゲートウェイを設定するときでも`via`だった気もするが。  

「ip route add 宛先ネットワークアドレス/サブネットマスク長 via ゲートウェイアドレス [ dev 出力インタフェース ]」

てかそもそも「via」って何なのさね。  

[【Linux】ip routeで表示されるdev,via,src,protoの意味と見方](https://www.mtioutput.com/entry/iproute-cmd-howtosee)  
>devはパケットを流すデバイス名を指定する。  
>viaはパケットを流すIPアドレスを指定する。  

なるほど。  
そのルートのパケットを流す先にゲートウェイのアドレスを追加するってわけか。  

via : 経由  
まじかよ・・・。viaって単語だったのか・・・。  
しかも経由ってそのまんまじゃねーか。  
もっと早く知っておけばよかった。  

#### 4976 ipコマンドでインターフェースの情報表示で何回も間違えます

ipコマンドを使って、インタフェースの状況のみを確認したい。正しいコマンドはどれか  

ip addr show  
ip ln sh  
ip link show  
ip iface show  
ip eth show  

ipコマンドは短縮系があるので「ip ln sh」を選んだんですが、ダメでした。  
普通に「ip link show」でよかったらしいです。  
というか、短縮系があるやつとないやつも把握しておきたいところではありますね。  

●IPアドレスの設定状況を確認したい。(短縮バージョン)  
ip addr showの短縮バージョン  
ip a sh  

オブジェクト
link      :: データリンク層、ネットワークデバイス、インターフェース
addr      :: IPv4,IPv6アドレス(短縮版は「a」)
route     :: ルーティングテーブル
neighbour :: IPv4のARPキャッシュ、IPv6のNDキャッシュ(アメリカ英語である「neighbor」でも動作する。「neighbour」はイギリス英語)

サブコマンド
show :: 現在の状態の表示(省略したときのデフォルト)(短縮版は「sh」)
add  :: 値の追加
del  :: 値の削除

なるほど。
あるやつの組み合わせじゃないとダメなのか。
linkはlnと思いきやないからダメ。showはshであるけど、linkが対応してないからダメ。クソ。  
102の勉強も飽きてきた。  
早く終わらせたい。  

#### 5110 nmcliでインターフェースの設定する時のサブコマンドって何だったか

nmcliコマンドで、enp0s3インタフェースのIPアドレスを192.168.0.100/24に設定したい。  
以下2つの方法の下線部に入る共通のコマンドはどれか。なお、接続名もenp0s3とする。  

nmcli connection ________ enp0s3 ipv4.addresses 192.168.0.100/24  
nmcli device ________ enp0s3 ipv4.addresses 192.168.0.100/24  

modifyで間違えた記憶もあるが、セットするだけなら普通setだよな。  
→  
合ってた。  
逆にsetはない。  
modifyは書き換えるコマンド。  
まぁ、セットするだけじゃなく、書き換えるならそれで済むんだし、modifyで十分なんだろうなぁ。  

#### 4648 やばい。resolv.confの書式を確認したい

「/etc/resolv.conf」でDNSサーバ（192.168.1.1）を指定する際の書式として正しいのはどれか。  

server 192.168.1.1 ?  
nameserver 192.168.1.1 ?  

→  
`nameserver 192.168.1.1`です。  

頭文字がdnsになるのは覚えたけど、じゃあ何が？ってのは覚えていない。  
d : domain : 自サーバーの所属するドメイン  
n : nameserver : 名前解決に使用するDNSサーバーを指定する。  
s : search : 名前解決の際に省略されうるドメイン名のリスト。ドメイン名検索リスト。  

serverなるものはない。それに相当するのはnameserver。  

domainとsearchはどちらか1つしか有効にならない。  
searchを設定したらsearchが優先される。  

#### 4563 Recv-Q,Send-Qとかたくさん出てくるコマンド

様々な情報なので`netstat`だと思うがどうだろうか。  

当たってた。  
まぁ、これもクソデカキーワードあるのでQUESTION,ANSERのdigとセットで覚えましょう。  

#### 4581 ホスト名を書き換えるファイル。RedHatとDebian

/etc/hostname
/etc/sysconfig/network?  
なんか無駄に長かった気がするけど。  

合ってた。  

RedHat系 → /etc/sysconfig/network  
Debianm系 → /etc/hostname  

#### 4565 netstatでできることって何だっけ？

○・ルーティングテーブルを表示する  
→`netstat -r`で表示可能  

×・ネットワークインターフェースにIPアドレスを設定する  
→表示だけできるコマンドなので設定全般は無理。  

○・開いているソケットの情報を表示する  
→様々な情報の1つに入っているのでは？要確認。  
→できるっぽい。  

×・ブロードキャストを利用するサービスについて表示する  
→ブロードキャストは表示出来たっけ？  
→出来ないのでこれが答え。できるのは-rでルート。-iでインターフェース。  
インターフェースにブロードキャストはないし、ブロードキャストを表示するオプションもない。  

○・インターフェースの統計情報を表示する  
→インターフェースならifconfigだけど、netstatは出来たっけか？  
→-iオプションで余裕でできる。  

○・有効なネットワーク接続を表示する  
→余裕でできると思う。  

#### 4700 逆にブロードキャストアドレスがわかるやつ ifconfig

ifconfigで表示される情報はどれか。(2つ選択)  

・送受信バイト数  
・ブロードキャストアドレス  

ifconfigはインターフェースに関する情報の表示や設定はいいけど、内容がnetstatと被る。  
インターフェースはもちろんブロードキャストがあるわけで、専用のコマンドなんだから見れてよい。  
ただ、netstatは様々な情報はわかるけど、その限りではない。  
ここら辺がクソややこしい。  

#### 5062 インタフェースeth0を有効化したい

正直、setだのupだのわからない。  

ip link up eth0  
ip link show  
ip addr eth0 up  
ip link set eth0 up  
ip route add eth0 up  

「ip link set インタフェース up|down」  

あれ。connectionはmodifyでsetはないって覚えたけど、別のところでsetは出てくるのかクソ。

#### 5118 host？hosts？ケリをつけようや

ホスト名を表示したり、ホスト名を設定できるコマンドは次のうちどれか。(2つ選択)

全然違った!!!  

・host :: DNSに問い合わせを行うコマンドなので、誤りです。  
・hosts :: このようなコマンドはありませんので、誤りです。  

「nmcli general hostname」コマンドでホスト名を表示します。  
「nmcli general hostname ホスト名」コマンドで指定したホスト名に変更します。  
また、systemdが動作するシステムでは、hostnamectlコマンドでもホスト名や関連する情報の表示、ホスト名の設定を行えます。  

なんかよくipと間違えるけどipって何するコマンドだっけ？  
・ip :: IPアドレスやルーティングを設定するコマンドなので、誤りです。  

■hostって付くやつ全部  
・/etc/hosts              :: IPアドレスとホスト名の対応付けファイル。  
・/etc/hostname           :: ホスト名のみを設定するファイル(Debian系,RHEL7以降)  
・hostname    :: 自ホストのホスト名やドメインを参照したり、ホスト名を一時的に変更するコマンド。  
・hostnamectl :: systemdが動作するシステムにおける、ホスト名や関連する情報の表示、ホスト名の設定を行うコマンド。  
・host     :: DNSサーバーを使ってホストやドメインに関する情報を表示する。最も基本となるコマンド。最小出力。  

#### 5109 nmcliで接続情報表示を間違えました  

nmcliコマンドで、接続状況を表示したい時に指定するオブジェクトとコマンドはどれか。  
radio show  
networking show  
general show  
connection show  

→  
最初は「networking show」を選びましたが、違いました。  
正解は「connection show」です。  
問題文見れば当たり前と言えば当たり前ですけどね。  

#### 5007 ncコマンドで-lと-pの違いって何？

安易サーバーとして、他からの通信を待ち受けるなら「-l(listen)」なのはわかるけど、じゃあ-pでポートを指定するのってどういう意味があるの？

-pは送信元ポートを指定するらしい。  
つまり、-pはfromToの関係だ。こっちからあっちに接続する時に指定するポート番号。  

-lはあっちからこっちに来る時に指定するポート番号だ。  

#### なんか

``` txt : よく間違える問題・気を付ける事
■ipコマンド
・ルートを表示した場合「via」の表示がある。
・詳細表示オプションは「-s」
●ARPキャッシュの内容を確認
[ip neighbor sh] or [ip neighbor show]
neighborはIPv4のARPキャッシュを表示するコマンド。
コマンドadd,del,show。省略形はa,d,sh
●インタフェースを有効化・無効化するには、linkオブジェクトにsetコマンドを発行します。
ip link set { up | down } dev インタフェース
ip link set インタフェース up|down

■netstatコマンド
●出来ない事
・ブロードキャストを利用するサービスについて表示する
・ネットワークインターフェースにIPアドレスを設定する
表示はできるが、設定は一切出来ない。
インターフェースの情報やソケットの情報はわかるが、ブロードキャストサービスを表示するオプションはない。

●表示される項目
Active Internet connections
Proto , Recv-Q , Send-Q , LocalAddress , ForeignAddress , State , 
Active UNIX domain sockets
Proto , RefCnt , Flags , Type , State , I-Node , Path

■ifconfigコマンド
●使用時の影響範囲
・ifconfigコマンドを実行しても何も影響がない場合もある。
・インターフェースのアップ・ダウン状態が変更される。
●表示される情報
・送受信バイト数
・ブロードキャストアドレス
・IPアドレス
・サブネットマスク
・MTU

■送受信バイト数を表示できるコマンド
・ifconfig デバイス名
・ip -s link show dev デバイス名

■ルーティングテーブルを表示できるコマンド
・route
・netstat -r
・ip route show

■DNSを利用し、ホスト名をIPアドレスに変換することができるコマンド  
・host
・nslookup
・getent
・dig
この中で出力する情報が最も少ないのはhostコマンド
```

---

### 12.セキュリティ

#### 4928 サーバーに置くユーザーの公開鍵は/etcだったか、~/.だったか

~/.だった。鍵の置き場所はどちらもホームディレクトリ。  
~/.ssh/authorized_keys  

#### 4643 4644 findコマンドの+と-の意味

+がor。つまり「いずれか」  
-がand。つまり「すべて」  

セキュリティ上、SUIDとSGIDの両方が設定されたファイルをすべて把握しておきたい。  
→  
`find / -perm -6000`  

セキュリティ上、SUIDとSGIDのいずれかが設定されたファイルやディレクトリをすべて把握しておきたい。
→
`find / -perm +6000`  

``` txt : findコマンドの書式
find [検索場所] -perm -[モード]
[モード]で指定されている許可属性ビットのすべてが、ファイルでも立っていたら真

find [検索場所] -perm +[モード]
[モード]で指定されている許可属性ビットのどれか一つが、ファイルでも立っていたら真
```

#### 4555 cron,atの先勝ち。tcpラッパーはどっち？

1.「/etc/hosts.allow」に記載されているホストは許可。  
2.「/etc/hosts.allow」に記載されていなければ、「/etc/hosts.deny」を参照し、記載されているホストは拒否。  
3.両方のファイルに記載の無いホストは全て許可。  

両方のファイルに記載が無いホストは全て許可されてしまうため、通常は「/etc/hosts.deny」に「ALL:ALL」と記載（全てのサービスとホストを拒否）しておき、  
許可したいサービスとホストだけ、「/etc/hosts.allow」に記載しておくという運用を行います。  

先勝ちではあるが、denyが無かったら全部OKになる。
cronとatはrootのみOKってところが違う。  

#### 4835 sshサーバーの設定ファイルはsshd.conf？ssh.conf？

そもそも.confではない。  
クライアント側が/etc/ssh/ssh_config  
サーバー側が/etc/ssh/sshd_config  

てか、やベーくらい初歩的なところ間違えた。  
こういうのがあるから難解やっても怖い。  

#### 4646 wとwhoコマンドが見るファイルってどれ？

これはナチュラルに間違えた。  

wtmpが見覚えあったから「/var/wtmp」にしたが不正解。  
正解は「/var/log/utmp」だった。  

wtmpはlastコマンドで参照するファイルだった。  
しかも「/var/wtmp」ではなく「/var/log/wtmp」  

#### 4626,4627,4593  ulimitの-vと-aと-uが何かわからなくなった

-fはファイルサイズってのはわかる。  
-aは制限値を一覧表示。  
-vは詳細表示に見えるが、仮想メモリ(virtual)。  
-uはユーザーのリソースを制限する。
ユーザーが使用できるプロセス数を1024に制限したい。  
→  
`ulimit -u 1024`  

#### 4999 xinetdのサーバープログラムを起動するユーザーを指定する項目はuser？users？

sが付くか付かないか問題。  
単数なのでuserでおｋ。  

#### 4586 昔SUについて度忘れしたっぽいのでまとめる

・引数に「-」をつけると、切り替わる先のユーザの環境変数を使用する  
→つまり今の環境変数は引き継がないって事。  
・ユーザー名を指定しない場合、rootユーザへ切り替わる  
・ユーザを切り替える時に求められるパスワードは、切り替わる先のユーザのパスワード  
・但し、rootユーザから別のユーザに切り替わる時はパスワードは要求されない  

#### 何か

■ユーザ「user1」のパスワードをいつでも変更できるようにしたい
chage -m 0 user1

■パスワードの有効期限に関する設定が可能なコマンドは、「chage」、「passwd」、「usermod」コマンドです。
「passwd」コマンドでパスワードの最長有効日数を10日にする場合は「passwd -x 10 user1」
「usermod」コマンドにはこれを実現するオプションは存在しませんが、
アカウントの有効期限やパスワードの使用期限が切れてからアカウントを永久に使用不能になるまでの日数を設定できる。
→[usermod -e]
