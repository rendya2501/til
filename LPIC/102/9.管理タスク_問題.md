# 管理タスク問題

---

## 1 ○

ユーザーを新規に登録するために使用するコマンドはどれか？1つ。  

→  
c. useradd  

1問目からある意味ぶっ飛ばしてくるなぁ。  

---

## 2 △

/etc/passwd ファイルのパスワード欄がxを表示され、/etc/shadowファイルのパスワード欄が!!と表示された新規登録ユーザーがいる。  
このユーザーに対して次に行わなければならないことはなにか？1つ。  

→  
知らんが、知っている範囲から言えば、パスワードがないからじゃない？って思うので。[A.passwdコマンドでパスワードを設定する。]で。  
当たった。知らないで当たったので△。  

→  
アカウントは作成したが、パスワードは設定していない場合、`/etc/shadow`の2番目のフィールドは「!!」となる。  
なのでpasswdコマンドでパスワードを設定する必要がある。  

---

## 3 ○

`useradd -m`コマンドによるユーザー登録時に自動的にユーザーのホームディレクトリの下にbinディレクトリを作りたい場合、どうすれば良いか？1つ。  

→  
B. /etc/skelディレクトリの下にbinディレクトリを作っておく。  

これは問題ない。  

---

## 4 ○

/etc/shadowファイルのパーミッションが/etc/passwdとは異なった設定になっている利用はどれか？1つ。  

→  
C.権限のないユーザーによる暗号化パスワードの解読を防ぐため。  

---

## 5 ○

/etc/passwdと/etc/shadowの正しいパーミッションはどれか？1つ。  

→  
B. /etc/passwd rw- r-- r--, /etc/shadow r-- --- ---  

管理者は読み書き可能。他は閲覧のみ。
shadowで管理者が読み込みだけなのが気になったが、正解らしい。  

rootはパーミッションの如何に関わらずアクセスできるので、rw-や---など、どのように設定されていても機能する。  

---

## 6 ×

/etc/passwdの第2フィールドには、ほとんどのユーザーの場合はxが入っている。  
しかし数人のユーザーだけは13文字に暗号化されたパスワードが入っている。  
システムが正しく機能するためにはどのようにすればよいか？1つ。  

→  
まぁ、普通に考えてBでは？  
B. 暗号化パスワードの入っているユーザーだけ、passwdコマンドでパスワードを再設定する。  

→  
そういえば少し上の方でそんな記述があったっけ。  
セキュリティ的には少し問題があるが、システム的には問題がないって。  

/etc/passwdの第2フィールドにxが入っている場合は、/etc/shadowを参照する。  
xが入っていないエントリが混在していても、特に何も設定しなくてもシステムは正常に動作する。  

---

## 7 △

/etc/pad.dディレクトリ以下にあるファイルの設定を変更し、パスワード暗号化のアルゴリズムをMD5に変更しました。  
システム管理者はこの後どうすれば良いか？  

→  
暗号化の話であって、復号の話ではない。  
なので、何もしなくていいのでは？  

---

## 8 ×

ユーザーの所属グループを表示するコマンドを記述せよ。  

→  
あれ・・・。何だっけ・・・。  

答えは`groups`コマンドらしいが、やっていないのでわかるわけがない。  
似たようなのにidコマンドがある。  
逆にこっちは正解じゃないのか？  
色々謎である。  

---

## 9 ○

システムへのグループの登録と削除のコマンドについての説明で正しいものはどれか？2つ  

→  
B. groupaddでグループを登録する。  
D. groupdelでグループを削除する。  

---

## 10 ○

グループからユーザーを削除するコマンドはどれか？1つ。  

→  
B. usermod

問題文的にgroup系のコマンドに見えるが、それは罠。  
グループに所属するのはユーザーなので、グループから除隊させたかったらユーザーを操作すべきでは。  

`usermod -G`コマンドで2次グループに指定しなかったグループからユーザーは削除される。  

---

## 11 ○

ユーザーアカウントyukoと、yukoのホームディレクトリを削除するコマンドはどれか？2つ。  

→  
C. userdel -r yuko  
D. userdel --force --remove yuko  

Cは確実。  
--removeってあるからDもじゃないか？  

合ってた。  
-mオプションはない。  

---

## 12

getent passwd コマンドを実行するとどのようになるか？1つ。  

→  
なんだっけgetent。  
A. システムの全ユーザーの暗号化パスワードが表示される。  

getentコマンドは、ネームサービススイッチ(/etc/nsswitch.conf)の設定に従い、引数で指定したデータベースの内容を表示する。  
passwdを指定したということは、/etc/passwdの全内容が表示されるのと同じなので、システムの全ユーザーのパスワードが表示される。  

---

## 13 ○

特定のユーザーのアカウント失効日を変更するための適切なコマンドはどれか？2つ。  

→  
A. usermode  
B. change  

changeってどこでやった内容だっけか。  
セキュリティだ。覚えてるものだねぇ。  
changeって意味が広いのにパスワード変更するだけかよって突っ込みがあったから印象に残ってたような気がする。  

---

## 14 ×

特定のユーザーのアカウント失効日を変更するための専用のコマンド名は何ですか？  
コマンド名のみ記述背よ。  

→  
なんだよ・・・。普通にchangeかよ・・・。  

---

## 15 ×

/etc/passwdファイルに登録されているユーザーのパスワード有効期限を調べるために使用するコマンドはどれか？1つ。  

→  
×C. usermod  
○E. change  

なんか、ここ直近3問は全部changeに持っていかれるな。  
パスワード系は全部changeね。  

change -l ユーザー名 でアカウント情報一覧を表示。  

---

## 16 ○

ユーザーのパスワードの有効期限あるいはパスワード失効までの猶予期間を変更できるコマンドを3つ選択。  

→  
A,B,D usermod,passwd,change  

まぁ、ここまでさんざんっぱらやってきたからこれしかないわな。  

→  

パスワードが変更梨で有効な最長日数(maxdays)  
・change -M  
・passwd -x  

パスワード失効までの猶予日数(inactive)  
・usermod -f  
・change -l  
・passwd -i  

アカウントの失効日(expiredate)  
・usermode -e  
・change -E  

---

## 17 ×

ユーザーyukoのアカウント自体は有効なままにして、対話的なログインをできないようにしたい場合、適切な方法を2つ。  

→  
userdelは論外。  
chshコマンドって知らんのだが？  
uid変更してなんかあるのか？  
知らないコマンドが正解ならどうしようもないので、知ってるコマンド2つを選ぶ事にする。  

B.usermod -u uid yuko  
C.usermod -s /sbin/nologin yuko  

C,Dだって。じゃあどうしようもないかな。  

→  

ログインシェルに/bin/falseを指定することにより、対話的なログインを禁止できる。  
falseコマンドは何もせず単に1(false)を返すコマンド。  
ログインするとfalseコマンドが実行されるためログアウトさせられる。  

usermod -s :: デフォルトシェルを設定する。  
ログインシェルを/sbin/nologinに設定する。  
/sbin/nologinはつまりnologinコマンドを実行するということ。  
nologinコマンドはアカウントが現在使えない旨のメッセージを表示するコマンド。  
「this account is currentrly not available.」のメッセージが表示された後、ログアウトさせられる。  

デフォルトシェルを変更するコマンド  
usermod -s ログインシェル ユーザー名  
chsh -s ログインシェル ユーザー名  

### chshコマンド  

change shell  
ユーザーのログインシェルを変更するための専用コマンド。  

``` chsh
chsh -s ログインシェル ユーザー名
```

---

## 18 ×

ユーザーのアカウントは削除せず、ログインできないようにロックする手順を1つ。  

→  
×B. /etc/shadowファイルの最後のフィールドを削除する。  
○C. /etc/passwdの最初の : の後に * を挿入する。  

これは、パスワードファイルの書式をメモしたほうがいいな。  

Cが言っているのは第2フィールドの事だな。  
シャドウパスワードを使っている場合、「x」が入るけど、ここに「*」をいれた場合はロックという意味になるのだろう。  

→  
/etc/shadowファイルを使っているか否かに関わらず、/etc/passwdの第2フィールドに`*`あるいは`!`を指定すると、  
PAMの認証モジュールpam_unix.50は/etc/shadowの参照や暗号化パスワードとしての処理をせず、その時点でログインを拒否する。  
ログイン時に表示されるメッセージはパスワードを間違えた時と同じになる。  

---

## 19 ×

特定ユーザーのアカウントを特区することができるコマンドラインはどれか？2つ。  

→  
Lockなので-L。  
-Uは知らない。ちゃんと復習する。  

C. usermode -L  
D. usermode -U  

E. passwd -l ユーザー名  

passwdでもロックできたのか。パスワード関係はちょっと再度復習する必要があるな。  

→  
usermodが大文字。  
passwdが小文字。  
lがロック。uがアンロック。  

この組み合わせでしかない。  

usermod -L :: 暗号化されたパスワードの先頭に"!"を追加してロックする。  
usermod -U :: 暗号化されたパスワードの先頭の"!"を削除してアンロックする。  
passwd -l :: 暗号化されたパスワードの先頭に"!!"を追加してロックする。  
passwd -u :: 暗号化されたパスワードの先頭から連続した"!"を削除してアンロックする。  

---

## 20 ×

root以外のuid500未満のアカウントはどのような目的で用意されているか？1つ。  

→  
AかB。デーモンやディレクトリの所有者として利用するシステムアカウント or root以外のシステム管理者のアカウント。  
じゃあBで。  

はい。A見たいです。  

→  
root以外のuid500未満のアカウントはデーモンやディレクトリの所有者として利用するシステムアカウントとして用意されている。  
/etc/passwdファイルに登録されているシステムアカウントを例にする。
bin,daemon,adm,lpはログインアカウントではないので、最終フィールドに/sbin/nologinが設定されている。  
デーモンやシステムディレクトリの所有者として利用されている。  
