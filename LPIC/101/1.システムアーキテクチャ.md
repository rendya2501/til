# システムアーキテクチャ(主題101)

## ハードウェア設定の決定と設定

pciデバイスの格納ファイル
/proc/bus/pci/devices


接続されたUSBデバイスの情報を表示するコマンドは?
  また、接続されたUSBデバイスの情報が格納されたファイルは?
/proc/bus/usb/devices


udevがデバイスファイル作成時に使用する設定ファイルが
  配置されるディレクトリは?（フルパスで）
/etc/udev/rules.d


 デバイスが使用中のDMAチャネルに関する情報が格納されたファイルは?
/proc/dma


モデム、TA(ターミナルアダプタ)などが属しているUSBのデバイスクラスは?
  （先頭3文字のみとする）
ACM


modprobeの設定ファイルに記述する設定で
  ロードしたくないカーネルモジュールを指定するキーワードは?
blacklist


modprobeの設定ファイルが保存されるディレクトリは?
/etc/modprobe.d/


ロードされているカーネルモジュールの情報を表示するコマンドは?
また、ロードされているカーネルモジュールの情報が格納されたファイルは?
→
lsmod
/proc/modules

さすがに午前中にやっただけあって、それなりに正解してくれる。
ただ、それでも間違う問題は間違うので、頭に叩き込まないといけない。
何かわかりやす目印を作りたいところだが、どうしようか。

---

## システムの起動

**a**
systemdの動作するシステムにおいて、プロセスのリソースを管理する
Linuxカーネルの機能は？
→
cgroups


systemdの管理単位であるUnitの名称を以下の順に答えよ（英字で回答）
・各種デバイスを管理するUnit
・ファイルシステムのマウントを管理するUnit
・サービスを制御するUnit
・スワップ領域を管理するUnit
・複数のサービスをひとつのグループにするためのUnit
device
mount
service
swap
target


**a**
systemdが利用できるユニットの一覧を取得するための
systemctlのサブコマンドは？
list-unit-files


 systemdの動作するシステムにおいて、サービスに設定ファイルを再読込させる
systemctlのサブコマンドは？
reload


システム起動時にブートローダからカーネルに渡されたパラメータが
格納されたファイルは?
/proc/cmdline


 systemdが管理するジャーナル（システムログ）を参照するためのコマンドは？
journalctl


カーネルのログが記録されるなど、Linuxでメインで使用されるログファイルは?
/var/log/messages


systemdの動作するシステムにおいて、各サービスが出力するログを扱うデーモンプロセスは？
systemd-journald

---

## ランレベル/ブートターゲットの変更

systemdのデフォルトのターゲットが格納されているディレクトリは？
/etc/systemd/system


 systemdの動作するシステムで、システム起動時に最初に実行されるUnitファイルは？
（絶対パスで回答）
/etc/systemd/system/default.target


マルチユーザモードで、NFS無し、テキストログインのランレベルは?　（Redhat系）
2


マルチユーザモードで、NFS有り、テキストログインのランレベルは?　（Redhat系）
3


systemctlのサブコマンドでシステムを停止させることができるものは？（アルファベット順に）
halt
poweroff


マルチユーザモードを意味するランレベルは?　（Redhat系）
(小さい方から3つ)
2
3
5


 SysVinit採用システムで、ランレベル3で実行されるスクリプトが入っているディレクトリは?
（絶対パスで回答）
/etc/rc3.d


systemctlコマンドで次回起動時にシングルユーザーモードで起動するよう設定したい。
設定コマンドを入力せよ（拡張子もつけること）
systemctl set-default rescue.target


systemdが動作するシステムで次回起動時のターゲットを確認できるコマンドは？
systemctl get-default


**a**
 systemctlコマンドで次回起動時にマルチユーザモードで起動するよう設定したい。
設定コマンドを入力せよ（拡張子もつけること）
systemctl set-default multi-user.target


**a**
 「Rebooting soon」というメッセージを表示して、23:00にサーバを再起動するコマンドは?
shutdown -r 23:00 "Rebooting soon"


 SysVinit採用システムで、「/etc/rc[0-6].d」に入っている
各ランレベルに応じたスクリプトの頭文字は?
（サービスを起動、サービスを停止 の順に2つ）
S
K


現在のランレベルを変更することでシステムを再起動したい。適切なコマンドは?
(アルファベット順に2つ)
init 6
telinit 6


電源管理に関するACPIイベントを監視・処理するデーモンは?
acpid

---

## 2週目に間違った問題

udevがデバイスファイル作成時に使用する設定ファイルが
配置されるディレクトリは?（フルパスで）
/dev/udev.rules.d
→
/etc/udev/rules.d/


 systemdのデフォルトのターゲットが格納されているディレクトリは？
/etc/systemd/sysmem
→
/etc/systemd/system


 systemctlコマンドで次回起動時にシングルユーザーモードで起動するよう設定したい。
設定コマンドを入力せよ（拡張子もつけること）
systemctl.unit = rescue.target
→
systemctl


systemdの動作するシステムにおいて、プロセスのリソースを管理する
Linuxカーネルの機能は？
device
→
cgroups


 modprobeの設定ファイルが保存されるディレクトリは?
/etc/modprobe
→
/etc/modprobe.d/


 デフォルトのランレベルを設定できるファイルは?
(SysVinit採用システムの場合)
/etc/default/target
→
/etc/inittab


接続されたUSBデバイスの情報を表示するコマンドは?
また、接続されたUSBデバイスの情報が格納されたファイルは?
lsusb
/proc/devices/use
→
/proc/bus/usb/devices


 システム起動時にブートローダからカーネルに渡されたパラメータが
格納されたファイルは?
/etc/cmdline
→
/proc/cmdline


電源管理に関するACPIイベントを監視・処理するデーモンは?
ACPID
→
acpid


systemdの動作するシステムで、システム起動時に最初に実行されるUnitファイルは？
（絶対パスで回答）
/etc/systemd/default
→
/etc/systemd/system/default.target


 systemdが利用できるユニットの一覧を取得するための
systemctlのサブコマンドは？
--list
→
list-unit-files


 PCIデバイスの情報を表示するコマンドは？
また、PCIデバイスの情報が格納されたファイルは？
→
lspci
/proc/devices/pci
→
/proc/bus/pci/devices


systemctlコマンドで次回起動時にマルチユーザモードで起動するよう設定したい。
設定コマンドを入力せよ（拡張子もつけること）
systemctl set-default multiuser.target
→
systemctl set-default multi-user.target
→
方向性はあってた。ハイフンが入ることに注意。


モデム、TA(ターミナルアダプタ)などが属しているUSBのデバイスクラスは?
（先頭3文字のみとする）
MOD
→
ACM


「Rebooting soon」というメッセージを表示して、23:00にサーバを再起動するコマンドは?
shutdown -r 23:00 -k Rebooting soon
→
shutdown -r 23:00 "Rebooting soon"
→
シャットダウンと同時にメッセージを送信する場合、-kオプションは不要。
最後にダブルコーテーションで囲ってメッセージを書けばいい。


数分後にシステムを停止するようshutdownコマンドを実行したが、
キャンセルしたい。適切なコマンドは?
-c
→
shutdown -c


 カーネルが出力するメッセージが格納されるリングバッファの内容を表示するコマンドは?
（単独のコマンドで）
dmesg clear
→
dmesg


カーネルのリングバッファの内容をクリアするコマンドは？（オプションは長い形式で）
journalctl clear
→
dmesg --clear
